<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">                          
<!--<![endif]-->
					<head>
				    <meta charset="UTF-8" />
				    <meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE" />
            				    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
				    <link rel="profile" href="http://gmpg.org/xfn/11" />
				    <link rel="pingback" href="http://sametmax.com/xmlrpc.php" />

				   <!-- Icons font support for IE6-7  -->
				    <!--[if lt IE 8]>
				      <script src="http://sametmax.com/wp-content/themes/customizr/inc/assets/css/fonts/lte-ie7.js"></script>
				    <![endif]-->
				    <style type="text/css" id="customizr-inline-fonts">@font-face{font-family:genericons;src:url('../wp-content/themes/customizr/inc/assets/css/fonts/fonts/genericons-regular-webfont.eot');src:url('../wp-content/themes/customizr/inc/assets/css/fonts/fonts/genericons-regular-webfont.eot%3F') format('embedded-opentype'),url('../wp-content/themes/customizr/inc/assets/css/fonts/fonts/genericons-regular-webfont.woff') format('woff'),url('../wp-content/themes/customizr/inc/assets/css/fonts/fonts/genericons-regular-webfont.ttf') format('truetype'),url('../wp-content/themes/customizr/inc/assets/css/fonts/fonts/genericons-regular-webfont.svg') format('svg')}@font-face{font-family:entypo;src:url('http://sametmax.com/wp-content/themes/customizr/inc/assets/css/fonts/fonts/entypo.eot);src:url(http://sametmax.com/wp-content/themes/customizr/inc/assets/css/fonts/fonts/entypo.eot?#iefix') format('embedded-opentype'),url('../wp-content/themes/customizr/inc/assets/css/fonts/fonts/entypo.woff') format('woff'),url('../wp-content/themes/customizr/inc/assets/css/fonts/fonts/entypo.ttf') format('truetype'),url('../wp-content/themes/customizr/inc/assets/css/fonts/fonts/entypo.svg') format('svg')}</style><title>Petite démo pragmatique d&#8217;un usage de WAMP en Python &#8211; Sam &amp; Max</title>
<link rel='dns-prefetch' href='http://s0.wp.com/' />
<link rel='dns-prefetch' href='http://secure.gravatar.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Sam &amp; Max &raquo; Feed" href="../feed.1" />
<link rel="alternate" type="application/rss+xml" title="Sam &amp; Max &raquo; Comments Feed" href="../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Sam &amp; Max &raquo; Petite démo pragmatique d&#8217;un usage de WAMP en Python Comments Feed" href="feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/sametmax.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.7"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='contact-form-7-css'  href='../wp-content/plugins/contact-form-7/includes/css/styles.css%3Fver=5.0.2.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-polls-css'  href='../wp-content/plugins/wp-polls/polls-css.css%3Fver=2.73.8.css' type='text/css' media='all' />
<style id='wp-polls-inline-css' type='text/css'>
.wp-polls .pollbar {
	margin: 1px;
	font-size: 6px;
	line-height: 8px;
	height: 8px;
	background-image: url('../wp-content/plugins/wp-polls/images/default/pollbg.gif');
	border: 1px solid #c8c8c8;
}

</style>
<link rel='stylesheet' id='wp-syntax-css-css'  href='../wp-content/plugins/wp-syntax/css/wp-syntax.css%3Fver=1.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='../wp-includes/css/dashicons.min.css%3Fver=4.9.7.css' type='text/css' media='all' />
<link rel='stylesheet' id='customizr-skin-css'  href='../wp-content/themes/customizr/inc/assets/css/black2.min.css%3Fver=3.2.10.css' type='text/css' media='all' />
<style id='customizr-skin-inline-css' type='text/css'>

.sticky-enabled .tc-shrink-on .site-logo img {
						height:30px!important;width:auto!important
					}

					.sticky-enabled .tc-shrink-on .brand .site-title {
						font-size:0.6em;opacity:0.8;line-height:1.2em
					}

.tc-rectangular-thumb {
            max-height: 250px;
            height :250px
          }

          .single .tc-rectangular-thumb {
            max-height: 250px;
            height :250px
          }


</style>
<link rel='stylesheet' id='customizr-style-css'  href='../wp-content/themes/customizr/style.css%3Fver=3.2.10.css' type='text/css' media='all' />
<link rel='stylesheet' id='fancyboxcss-css'  href='../wp-content/themes/customizr/inc/assets/js/fancybox/jquery.fancybox-1.3.4.min.css%3Fver=4.9.7.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widget-social-icons-styles-css'  href='../wp-content/plugins/jetpack/modules/widgets/social-icons/social-icons.css%3Fver=20170506.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css'  href='../wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css%3Fver=1.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='../wp-content/plugins/jetpack/css/jetpack.css%3Fver=6.3.2.css' type='text/css' media='all' />
<script type='text/javascript' src='../wp-includes/js/jquery/jquery.js%3Fver=1.12.4'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/jquery-migrate.min.js%3Fver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var TCParams = {"FancyBoxState":"1","FancyBoxAutoscale":"1","SliderName":"","SliderDelay":"","SliderHover":"1","SmoothScroll":"linear","ReorderBlocks":"1","CenterSlides":"1","HasComments":"","LeftSidebarClass":".span3.left.tc-sidebar","RightSidebarClass":".span3.right.tc-sidebar","LoadModernizr":"1","stickyCustomOffset":"0","stickyHeader":"1","dropdowntoViewport":"0","timerOnScrollAllBrowsers":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/themes/customizr/inc/assets/js/tc-scripts.min.js%3Fver=3.2.10'></script>
<link rel='https://api.w.org/' href='../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://sametmax.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='D&#8217;une base à l&#8217;autre en Python' href='../dune-base-a-lautre-en-python/index.html' />
<link rel='next' title='La fin de l&#8217;ère du spam de sites pornos' href='../la-fin-de-lere-du-spam-de-sites-pornos/index.html' />
<meta name="generator" content="WordPress 4.9.7" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='https://wp.me/p2ckfk-2TM' />
<link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embed%3Furl=http:%252F%252Fsametmax.com%252Fintroduction-a-wamp-en-python%252F" />
<link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed%3Furl=http:%252F%252Fsametmax.com%252Fintroduction-a-wamp-en-python%252F&amp;format=xml" />

<link rel='dns-prefetch' href='http://v0.wordpress.com/'/>
<style type="text/css" media="all">
/* <![CDATA[ */
@import url("../wp-content/plugins/wp-table-reloaded/css/plugin.css%3Fver=1.9.4.css");
@import url("../wp-content/plugins/wp-table-reloaded/css/datatables.css%3Fver=1.9.4.css");
/* ]]> */
</style><link rel="shortcut icon" href="../wp-content/uploads/2015/06/favicon.png" type="image/png">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Petite démo pragmatique d&#8217;un usage de WAMP en Python" />
<meta property="og:url" content="http://sametmax.com/introduction-a-wamp-en-python/" />
<meta property="og:description" content="Vu que dernièrement je vous ai bien gavé avec WAMP, ça mérite un tuto non ?" />
<meta property="article:published_time" content="2014-06-26T07:27:03+00:00" />
<meta property="article:modified_time" content="2015-09-16T20:51:28+00:00" />
<meta property="og:site_name" content="Sam &amp; Max" />
<meta property="og:image" content="http://sametmax.com/wp-content/uploads/2014/06/FqebLW21.png" />
<meta property="og:image:width" content="680" />
<meta property="og:image:height" content="382" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Petite démo pragmatique d&#8217;un usage de WAMP en Python" />
<meta name="twitter:image" content="http://sametmax.com/wp-content/uploads/2014/06/FqebLW21.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
			<link rel="stylesheet" type="text/css" id="wp-custom-css" href="../index.html%3Fcustom-css=3b3670f11a.css" />
						    <!--Icons size hack for IE8 and less -->
				    <!--[if lt IE 9]>
				      <link href="http://sametmax.com/wp-content/themes/customizr/inc/assets/css/fonts/ie8-hacks.css" rel="stylesheet" type="text/css"/>
				    <![endif]-->
				</head>
				
	<body class="post-template-default single single-post postid-11146 single-format-standard tc-fade-hover-links tc-sticky-header tc-transparent-on-scroll" itemscope itemtype="http://schema.org/WebPage">
		
		
	   	<header class="tc-header clearfix row-fluid tc-tagline-off tc-title-logo-on  tc-shrink-on tc-menu-on logo-left" role="banner">
			      <div class="brand span3 pull-left ">

        <h1><a class="site-title" href="../index.html" title="Sam &amp; Max | Du code, du cul">Sam &amp; Max</a></h1>
      </div> <!-- brand span3 pull-left -->
      <div class="container outside"><h2 class="site-description">Du code, du cul</h2></div>      	<div class="navbar-wrapper clearfix span9 tc-submenu-fade tc-submenu-move tc-open-on-hover left">
        	<div class="navbar resp">
          		<div class="navbar-inner" role="navigation">
            		<div class="row-fluid">
              		<div class="social-block span5" ><a class="social-icon icon-feed" href="../feed/rss/index.html" title="Subscribe to my rss feed"  ></a></div><h2 class="span7 inside site-description">Du code, du cul</h2><button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div class="nav-collapse collapse tc-hover-menu-wrapper"><div class="menu-top-menu-container"><ul id="menu-top-menu-2" class="nav tc-hover-menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1702"><a href="../category/programmation/index.html">Prog</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1703"><a href="../category/administration-system/index.html">Admin Sys</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1704"><a href="../category/philo-et-culture/index.html">Philo &#038; culture</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1706"><a href="../category/cul/index.html">Cul</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3340"><a href="../cours-et-tutos/index.html">Cours &#038; tutos</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1707"><a title="Les meilleurs blogs du Web" href="http://multiboards.net/">Multiboards</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12415"><a href="../planet-python-fr/index.html">Veille Python Fr</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15634"><a href="http://indexerror.net">Questions Python</a></li>
</ul></div></div>          			</div>
          		</div><!-- /.navbar-inner -->
        	</div><!-- /.navbar resp -->
      	</div><!-- /.navbar-wrapper -->
    			</header>
		<div id="tc-reset-margin-top" class="container-fluid" style="margin-top:103px"></div><div id="main-wrapper" class="container">

        
    <div class="container" role="main">
        <div class="row column-content-wrapper">

                            
                <div id="content" class="span9 article-container">
                    
                    
                        
                                                                                    
                                                                    <article id="post-11146" class="row-fluid post-11146 post type-post status-publish format-standard has-post-thumbnail hentry category-programmation tag-autobahn tag-crossbar tag-javascript tag-python tag-wamp">
                                                <header class="entry-header">
          <h1 class="entry-title format-icon">Petite démo pragmatique d&#8217;un usage de WAMP en Python</h1>            <div class="entry-meta">
                This entry was posted in <a class="btn btn-mini" href="../category/programmation/index.html" title="View all posts in Programmation"> Programmation </a> and tagged <a class="btn btn-mini btn-tag" href="../tag/autobahn/index.html" title="View all posts in autobahn"> autobahn </a><a class="btn btn-mini btn-tag" href="../tag/crossbar/index.html" title="View all posts in crossbar"> crossbar </a><a class="btn btn-mini btn-tag" href="../tag/javascript/index.html" title="View all posts in javascript"> javascript </a><a class="btn btn-mini btn-tag" href="../tag/python/index.html" title="View all posts in python"> python </a><a class="btn btn-mini btn-tag" href="../tag/wamp/index.html" title="View all posts in wamp"> wamp </a> on <a href="../2014/06/26/index.html" title="07:27" rel="bookmark"><time class="entry-date updated" datetime="2014-06-26T07:27:03+00:00">26/06/2014</time></a> <span class="by-author">by <span class="author vcard"><a class="url fn n" href="../author/sam/index.html" title="View all posts by Sam" rel="author">Sam</a></span></span>             </div><!-- .entry-meta -->
            <hr class="featurette-divider __before_content">        </header>
            

          <section class="entry-content ">
              <p><em>L&#8217;API a changé depuis, j&#8217;ai donc mis à jour l&#8217;article pour refléter ces changements</em></p>
<p>Vu que dernièrement je vous ai bien gavé avec <a href="../crossbar-le-futur-des-applications-web-python/index.html">WAMP</a>, ça mérite un tuto non ?</p>
<p>Il se trouve que l&#8217;équipe derrière WAMP a publié plus tôt que prévu une version de leurs libs contenant l&#8217;API flaskesque sur laquelle on bosse. L&#8217;idée est que même si on n&#8217;a pas encore les tests unitaires, on peut déjà jouer avec.</p>
<p>Maintenant il me fallait un projet sexy, histoire de donner envie. Donc j&#8217;ai fouillé dans ce qui se faisait côté temps réel (essentiellement du NodeJS et du Tornado, mais pas que) pour trouver l&#8217;inspiration.</p>
<p>Et j&#8217;ai trouvé un truc très sympa : <a href="http://news.softpedia.com/news/YouTube-Will-Turn-Your-Phone-into-a-Smart-TV-Remote-318286.shtml">un player vidéo piloté à distance.</a></p>
<p>En effet, n&#8217;est-il pas chiant de regarder une vidéo en ligne sur son ordi posé sur la commode pendant qu&#8217;on est enfoncé dans le canap ? Si on veut faire pause ou changer le son, il faut se lever, arg.</p>
<p>Les problèmes du tiers monde, c&#8217;est du pipi de chat à côté. Ils ont de la chance, eux, ils ne connaissent pas le streaming.</p>
<p><strong>Voici donc le projet : </strong></p>
<p>Une page avec un player HTML 5 et un QR code.</p>
<div id="attachment_11151" style="width: 335px" class="wp-caption aligncenter"><a href="../wp-content/uploads/2014/06/video.png" class="grouped_elements" rel="tc-fancybox-group11146"><img class="size-full wp-image-11151" title="Pour simplifier la démo, on peut cliquer sur le QR code est avoir la télécommande dans un autre tab pour ceux qui n'ont pas de smartphone ou d'app de scan de QRCode." src="../wp-content/uploads/2014/06/video.png" alt="Capture d'écran de la démo, côté player" width="325" height="186" /></a><p class="wp-caption-text">Pour simplifier la démo, on peut cliquer sur le QR code et avoir la télécommande dans un autre tab pour ceux qui n&#8217;ont pas de smartphone ou d&#8217;app de scan de QRCode.</p></div>
<p>Si on scanne le QR code avec son téléphone, il vous envoie sur une page avec une télécommande pour contrôler le player sans bouger votre cul :</p>
<div id="attachment_11152" style="width: 306px" class="wp-caption aligncenter"><a href="../wp-content/uploads/2014/06/controles.png" class="grouped_elements" rel="tc-fancybox-group11146"><img class="size-full wp-image-11152" title="Évidement, c'est basique. Je vais pas m'amuser à faire un produit complet juste pour un truc dont le code source ne sera même pas regardé par la plupart d'entre vous. Je vous connais, bandes de feignasses !" src="../wp-content/uploads/2014/06/controles.png" alt="Capture d'écrand de la démo, côté contrôles" width="296" height="370" /></a><p class="wp-caption-text">Évidement, c&#8217;est basique. Je vais pas m&#8217;amuser à faire un produit complet juste pour un truc dont le code source ne sera même pas regardé par la plupart d&#8217;entre vous. Je vous connais, bandes de feignasses !</p></div>
<p>Et vous allez voir, c&#8217;est même pas dur à faire.</p>
<p>Démo en ligne:</p>
<p style="margin: 1em; text-align: center;"><a style="font-size: 2em;" href="https://demo.crossbar.io/videocontrol/">La démo</a></p>
<p><a href="https://github.com/sametmax/codes-des-articles/tree/master/2014/juin/video_remote">Vous pouvez télécharger le code ici</a>.</p>
<p>Pour comprendre ce qui va suivre, il va vous falloir les bases en prog Javascript et Python, ainsi que bien comprendre la notion de <a href="../quest-ce-quun-callback/index.html">callback</a>. Être à l&#8217;aise avec <a href="../deferred-future-et-promise-le-pourquoi-le-comment-et-quand-est-ce-quon-mange.1.html">promises</a> peut aider.</p>
<p>Et pour bien digérer ce paté, rien ne vaut un peu de son :</p>
<p><span class="embed-youtube" style="text-align:center; display: block;"><iframe class='youtube-player' type='text/html' width='1170' height='689' src='http://www.youtube.com/embed/FU4cnelEdi4?version=3&#038;rel=1&#038;fs=1&#038;autohide=2&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;wmode=transparent' allowfullscreen='true' style='border:0;'></iframe></span></p>
<h2>Le Chteumeuleu</h2>
<p>Il va nous falloir deux pages Web, une pour le player vidéo, et une pour la télécommande.</p>
<p>Le player :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="html" style="font-family:monospace;">&nbsp;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
   &lt;title&gt;Video&lt;/title&gt;
   &lt;meta charset='utf-8'&gt;
   &lt;!-- Chargement des dépendances : autobahn pour WAMP
   et qrcode pour générer le QR code. Bien entendu, je
   vous invite à ne pas les hotlinker dans vos projets,
   mais pour la démo c'est plus simple. --&gt;
   &lt;script src=&quot;https://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz&quot;
           type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
   &lt;script src=&quot;http://davidshimjs.github.com/qrcodejs/qrcode.min.js&quot;
           type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&nbsp;
   &lt;style type=&quot;text/css&quot;&gt;
      #vid {
         /* Taille de la video */
         width:427px;
         height:240px;
      }
      /* Centrage avec la méthode Rache */
      #container {
          width:427px;
          margin:auto;
      }
      #ctrllink {
          display:block;
          width:256px;
          margin:auto;
      }
   &lt;/style&gt;
&nbsp;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;container&quot;&gt;
  &lt;p&gt;
&nbsp;
   &lt;!-- Pareil, je hotlink la video, mais ne faites pas ça
   à la maison les enfants. Surtout que les perfs du
   serveur du W3C sont merdiques et ça bufferise à mort. --&gt;
    &lt;video id=&quot;vid&quot;
           class=&quot;video-js vjs-default-skin&quot;
           controls preload=&quot;auto&quot;
           poster=&quot;http://media.w3.org/2010/05/sintel/poster.png&quot; &gt;
    &lt;source id='ogv'
      src=&quot;http://media.w3.org/2010/05/sintel/trailer.ogv&quot;
      type='video/ogg'&gt;
    &lt;source id='mp4'
      src=&quot;http://media.w3.org/2010/05/sintel/trailer.mp4&quot;
      type='video/mp4'&gt;
    &lt;source id='webm'
      src=&quot;http://media.w3.org/2010/05/sintel/trailer.webm&quot;
      type='video/webm'&gt;
    &lt;/video&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;a id=&quot;ctrllink&quot; href=&quot;#&quot; target=&quot;_blank&quot;&gt;
      &lt;span id=&quot;qrcode&quot;&gt;&lt;/span&gt;
    &lt;/a&gt;
  &lt;/p&gt;
 &lt;/div&gt;
&nbsp;
&lt;/body&gt;</pre></td></tr></table><p class="theCode" style="display:none;">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
   &lt;title&gt;Video&lt;/title&gt;
   &lt;meta charset='utf-8'&gt;
   &lt;!-- Chargement des dépendances : autobahn pour WAMP
   et qrcode pour générer le QR code. Bien entendu, je
   vous invite à ne pas les hotlinker dans vos projets,
   mais pour la démo c'est plus simple. --&gt;
   &lt;script src=&quot;https://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz&quot;
           type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
   &lt;script src=&quot;http://davidshimjs.github.com/qrcodejs/qrcode.min.js&quot;
           type=&quot;text/javascript&quot;&gt;&lt;/script&gt;

   &lt;style type=&quot;text/css&quot;&gt;
      #vid {
         /* Taille de la video */
         width:427px;
         height:240px;
      }
      /* Centrage avec la méthode Rache */
      #container {
          width:427px;
          margin:auto;
      }
      #ctrllink {
          display:block;
          width:256px;
          margin:auto;
      }
   &lt;/style&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;container&quot;&gt;
  &lt;p&gt;

   &lt;!-- Pareil, je hotlink la video, mais ne faites pas ça
   à la maison les enfants. Surtout que les perfs du
   serveur du W3C sont merdiques et ça bufferise à mort. --&gt;
    &lt;video id=&quot;vid&quot;
           class=&quot;video-js vjs-default-skin&quot;
           controls preload=&quot;auto&quot;
           poster=&quot;http://media.w3.org/2010/05/sintel/poster.png&quot; &gt;
    &lt;source id='ogv'
      src=&quot;http://media.w3.org/2010/05/sintel/trailer.ogv&quot;
      type='video/ogg'&gt;
    &lt;source id='mp4'
      src=&quot;http://media.w3.org/2010/05/sintel/trailer.mp4&quot;
      type='video/mp4'&gt;
    &lt;source id='webm'
      src=&quot;http://media.w3.org/2010/05/sintel/trailer.webm&quot;
      type='video/webm'&gt;
    &lt;/video&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;a id=&quot;ctrllink&quot; href=&quot;#&quot; target=&quot;_blank&quot;&gt;
      &lt;span id=&quot;qrcode&quot;&gt;&lt;/span&gt;
    &lt;/a&gt;
  &lt;/p&gt;
 &lt;/div&gt;

&lt;/body&gt;</p></div>

<p>Et la télécommande :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="html" style="font-family:monospace;">&nbsp;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Télécommande&lt;/title&gt;
  &lt;meta charset='utf-8'&gt;
  &lt;script src=&quot;https://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz&quot;
         type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
  &lt;!-- Zoom du viewport sur mobile pour éviter d'avoir
       à le faire à la main. --&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
  &lt;style type=&quot;text/css&quot;&gt;
    #controls {
      width:350px;
      margin:auto;
    }
    #controls button {
      font-size: 1em;
    }
    #controls input {
      vertical-align:middle;
       width: 200px;
       height:20px;
   }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;p id=&quot;controls&quot;&gt;
    &lt;!-- Marrant de se dire qu'en 2000, le JS inline était
         considéré comme démoniaque, et maintenant avec
         angularjs et cie, c'est exactement ce que tout
         le monde fait...
         Bref, on attache le clic sur nos contrôles à des
         méthodes de notre objet qui va se charger de la
         logique. --&gt;
&nbsp;
    &lt;button id=&quot;play&quot; onclick=&quot;control.togglePlay()&quot;&gt;Play&lt;/button&gt;
    &lt;input id=&quot;volume&quot;
                    onchange=&quot;control.volume(this.value)&quot;
                    type=&quot;range&quot;&gt;
  &lt;/p&gt;
&lt;/body&gt;</pre></td></tr></table><p class="theCode" style="display:none;">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Télécommande&lt;/title&gt;
  &lt;meta charset='utf-8'&gt;
  &lt;script src=&quot;https://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz&quot;
         type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
  &lt;!-- Zoom du viewport sur mobile pour éviter d'avoir
       à le faire à la main. --&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
  &lt;style type=&quot;text/css&quot;&gt;
    #controls {
      width:350px;
      margin:auto;
    }
    #controls button {
      font-size: 1em;
    }
    #controls input {
      vertical-align:middle;
       width: 200px;
       height:20px;
   }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;p id=&quot;controls&quot;&gt;
    &lt;!-- Marrant de se dire qu'en 2000, le JS inline était
         considéré comme démoniaque, et maintenant avec
         angularjs et cie, c'est exactement ce que tout
         le monde fait...
         Bref, on attache le clic sur nos contrôles à des
         méthodes de notre objet qui va se charger de la
         logique. --&gt;

    &lt;button id=&quot;play&quot; onclick=&quot;control.togglePlay()&quot;&gt;Play&lt;/button&gt;
    &lt;input id=&quot;volume&quot;
                    onchange=&quot;control.volume(this.value)&quot;
                    type=&quot;range&quot;&gt;
  &lt;/p&gt;
&lt;/body&gt;</p></div>

<p>Rien d&#8217;incroyable. C&#8217;est du HTML, un peu de CSS, on charge les dépendances en JS. Classique.</p>
<p>Vu qu&#8217;on utilise des ressources hotlinkées par souci de simplicité, <strong>il vous faudra être connecté à Internet.</strong></p>
<h2>Setup du routeur</h2>
<p>On va travailler avec Python 2.7 puisque Crossbar.io est uniquement en 2.7 et que je n&#8217;ai pas envie de vous faire installer deux versions de Python juste pour le tuto.</p>
<p>Il nous faut avant tout un serveur HTTP pour servir les fichiers HTML et un routeur WAMP. On installe donc Crossbar.io :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">pip <span style="color: #c20cb9; font-weight: bold;">install</span> crossbar</pre></td></tr></table><p class="theCode" style="display:none;">pip install crossbar</p></div>

<p>Ca va aussi installer autobahn, twisted et tout le bordel.</p>
<p>On va ensuite dans le dossier qui contient ses fichiers HTML, et on créé le fichier de config de Crossbar.io avec un petit :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">crossbar init</pre></td></tr></table><p class="theCode" style="display:none;">crossbar init</p></div>

<p>Vous noterez la création d&#8217;un dossier <code>.crossbar</code> qui contient un fichier <code>config.json</code>. C&#8217;est la config de crossbar. <strong>Videz moi ce fichier</strong>, on va le remplir avec notre config :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#123;</span>
   <span style="color: #3366CC;">&quot;workers&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
      <span style="color: #009900;">&#123;</span>
         <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;router&quot;</span><span style="color: #339933;">,</span>
         <span style="color: #3366CC;">&quot;realms&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
            <span style="color: #009900;">&#123;</span>
               <span style="color: #3366CC;">&quot;name&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;realm1&quot;</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;roles&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
                  <span style="color: #009900;">&#123;</span>
                     <span style="color: #3366CC;">&quot;name&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;anonymous&quot;</span><span style="color: #339933;">,</span>
                     <span style="color: #3366CC;">&quot;permissions&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
                        <span style="color: #009900;">&#123;</span>
                           <span style="color: #3366CC;">&quot;uri&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;*&quot;</span><span style="color: #339933;">,</span>
                           <span style="color: #3366CC;">&quot;publish&quot;</span><span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">,</span>
                           <span style="color: #3366CC;">&quot;subscribe&quot;</span><span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">,</span>
                           <span style="color: #3366CC;">&quot;call&quot;</span><span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">,</span>
                           <span style="color: #3366CC;">&quot;register&quot;</span><span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">true</span>
                        <span style="color: #009900;">&#125;</span>
                     <span style="color: #009900;">&#93;</span>
                  <span style="color: #009900;">&#125;</span>
               <span style="color: #009900;">&#93;</span>
            <span style="color: #009900;">&#125;</span>
         <span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>
         <span style="color: #3366CC;">&quot;transports&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
            <span style="color: #009900;">&#123;</span>
               <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;web&quot;</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;endpoint&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
                  <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;tcp&quot;</span><span style="color: #339933;">,</span>
                  <span style="color: #3366CC;">&quot;port&quot;</span><span style="color: #339933;">:</span> <span style="color: #CC0000;">8080</span><span style="color: #339933;">,</span>
                  <span style="color: #3366CC;">&quot;interface&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;0.0.0.0&quot;</span>
               <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;paths&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
                  <span style="color: #3366CC;">&quot;/&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
                     <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;static&quot;</span><span style="color: #339933;">,</span>
                     <span style="color: #3366CC;">&quot;directory&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;..&quot;</span>
                  <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span>
                  <span style="color: #3366CC;">&quot;ws&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
                     <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;websocket&quot;</span><span style="color: #339933;">,</span>
                  <span style="color: #009900;">&#125;</span>
               <span style="color: #009900;">&#125;</span>
            <span style="color: #009900;">&#125;</span>
         <span style="color: #009900;">&#93;</span>
      <span style="color: #009900;">&#125;</span>
   <span style="color: #009900;">&#93;</span>
<span style="color: #009900;">&#125;</span></pre></td></tr></table><p class="theCode" style="display:none;">{
   &quot;workers&quot;: [
      {
         &quot;type&quot;: &quot;router&quot;,
         &quot;realms&quot;: [
            {
               &quot;name&quot;: &quot;realm1&quot;,
               &quot;roles&quot;: [
                  {
                     &quot;name&quot;: &quot;anonymous&quot;,
                     &quot;permissions&quot;: [
                        {
                           &quot;uri&quot;: &quot;*&quot;,
                           &quot;publish&quot;: true,
                           &quot;subscribe&quot;: true,
                           &quot;call&quot;: true,
                           &quot;register&quot;: true
                        }
                     ]
                  }
               ]
            }
         ],
         &quot;transports&quot;: [
            {
               &quot;type&quot;: &quot;web&quot;,
               &quot;endpoint&quot;: {
                  &quot;type&quot;: &quot;tcp&quot;,
                  &quot;port&quot;: 8080,
                  &quot;interface&quot;: &quot;0.0.0.0&quot;
               },
               &quot;paths&quot;: {
                  &quot;/&quot;: {
                     &quot;type&quot;: &quot;static&quot;,
                     &quot;directory&quot;: &quot;..&quot;
                  },
                  &quot;ws&quot;: {
                     &quot;type&quot;: &quot;websocket&quot;,
                  }
               }
            }
         ]
      }
   ]
}</p></div>

<p>Crossbar est en effet un gestionnaire de processus : il ne gère vraiment rien lui même. Il démarre d&#8217;autres processus, appelés workers, à qui il délègue le travail. </p>
<p>On définit dans ce fichier de config quels processus (les workers) lancer quand Crossbar.io démarre. Les valeurs qu&#8217;on utilise disent de créer un seul worker de type &#8220;router&#8221;, c&#8217;est à dire un worker capable de gérer les entrées et les sorties WAMP. Hey oui, le routeur n&#8217;est qu&#8217;un worker comme les autres :)</p>
<p>Il y a d&#8217;autres sortes de workers, mais aujourd&#8217;hui on s&#8217;en branle.</p>
<p>Dans notre config du worker router, on crée d&#8217;abord un realm, qui est juste un namespace avec des permissions. Si un client WAMP se connecte à ce routeur, il doit choisir un realm (qui est juste un nom), et il ne peut parler qu&#8217;avec les clients du même realm. C&#8217;est une cloture quoi.</p>
<p>Dans un realm, on définit des roles qui déclarent quelles opérations PUB/SUB et RPC on a le droit de faire. Ici on dit que tout le monde (anonymous) a le droit de tout faire sur toutes les urls (&#8220;uri&#8221;:  &#8216;*&#8221;) histoire de pas se faire chier. Si on met en prod, évidement on va se pencher sur la sécurité et faire ça plus proprement.</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #3366CC;">&quot;realms&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
<span style="color: #009900;">&#123;</span>
   <span style="color: #3366CC;">&quot;name&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;realm1&quot;</span><span style="color: #339933;">,</span>
   <span style="color: #3366CC;">&quot;roles&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
      <span style="color: #009900;">&#123;</span>
         <span style="color: #3366CC;">&quot;name&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;anonymous&quot;</span><span style="color: #339933;">,</span>
         <span style="color: #3366CC;">&quot;permissions&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
            <span style="color: #009900;">&#123;</span>
               <span style="color: #3366CC;">&quot;uri&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;*&quot;</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;publish&quot;</span><span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;subscribe&quot;</span><span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;call&quot;</span><span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;register&quot;</span><span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">true</span>
            <span style="color: #009900;">&#125;</span>
         <span style="color: #009900;">&#93;</span>
      <span style="color: #009900;">&#125;</span>
   <span style="color: #009900;">&#93;</span>
<span style="color: #009900;">&#125;</span>
<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span></pre></td></tr></table><p class="theCode" style="display:none;">&quot;realms&quot;: [
{
   &quot;name&quot;: &quot;realm1&quot;,
   &quot;roles&quot;: [
      {
         &quot;name&quot;: &quot;anonymous&quot;,
         &quot;permissions&quot;: [
            {
               &quot;uri&quot;: &quot;*&quot;,
               &quot;publish&quot;: true,
               &quot;subscribe&quot;: true,
               &quot;call&quot;: true,
               &quot;register&quot;: true
            }
         ]
      }
   ]
}
],</p></div>

<p>Puis on définit les transports, c&#8217;est à dire sur quoi notre worker va ouvrir ses oreilles pour écouter les messages entrant :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #3366CC;">&quot;transports&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#91;</span>
            <span style="color: #009900;">&#123;</span>
               <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;web&quot;</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;endpoint&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
                  <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;tcp&quot;</span><span style="color: #339933;">,</span>
                  <span style="color: #3366CC;">&quot;port&quot;</span><span style="color: #339933;">:</span> <span style="color: #CC0000;">8080</span><span style="color: #339933;">,</span>
                  <span style="color: #3366CC;">&quot;interface&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;0.0.0.0&quot;</span>
               <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span>
               <span style="color: #3366CC;">&quot;paths&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
                  <span style="color: #3366CC;">&quot;/&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
                     <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;static&quot;</span><span style="color: #339933;">,</span>
                     <span style="color: #3366CC;">&quot;directory&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;..&quot;</span>
                  <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span>
                  <span style="color: #3366CC;">&quot;ws&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
                     <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;websocket&quot;</span><span style="color: #339933;">,</span>
                  <span style="color: #009900;">&#125;</span>
               <span style="color: #009900;">&#125;</span>
            <span style="color: #009900;">&#125;</span>
        <span style="color: #009900;">&#93;</span></pre></td></tr></table><p class="theCode" style="display:none;">&quot;transports&quot;: [
            {
               &quot;type&quot;: &quot;web&quot;,
               &quot;endpoint&quot;: {
                  &quot;type&quot;: &quot;tcp&quot;,
                  &quot;port&quot;: 8080,
                  &quot;interface&quot;: &quot;0.0.0.0&quot;
               },
               &quot;paths&quot;: {
                  &quot;/&quot;: {
                     &quot;type&quot;: &quot;static&quot;,
                     &quot;directory&quot;: &quot;..&quot;
                  },
                  &quot;ws&quot;: {
                     &quot;type&quot;: &quot;websocket&quot;,
                  }
               }
            }
        ]</p></div>

<p>Encore une fois on en déclare un seul, de type &#8220;web&#8221;. Ce transport peut écouter HTTP et Websocket sur le même port. On lui dit d&#8217;écouter sur &#8220;0.0.0.0:8080&#8221; :</p>
<p><lang="javascript"><br />
&#8220;endpoint&#8221;: {<br />
  &#8220;type&#8221;: &#8220;tcp&#8221;,<br />
  &#8220;port&#8221;: 8080,<br />
  &#8220;interface&#8221;: &#8220;0.0.0.0&#8221;<br />
},</lang></p>
<p>Ensuite on dit que si quelqu&#8217;un arrive sur &#8220;/&#8221;, on sert en HTTP les fichiers statiques histoire que nos pages Web soient servies :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #3366CC;">&quot;/&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
 <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;static&quot;</span><span style="color: #339933;">,</span>
 <span style="color: #3366CC;">&quot;directory&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;..&quot;</span>
<span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span></pre></td></tr></table><p class="theCode" style="display:none;">&quot;/&quot;: {
 &quot;type&quot;: &quot;static&quot;,
 &quot;directory&quot;: &quot;..&quot;
},</p></div>

<p>Si on arrive sur &#8220;/ws&#8221;, on route les requêtes WAMP via Websocket :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #3366CC;">&quot;ws&quot;</span><span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>
 <span style="color: #3366CC;">&quot;type&quot;</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">&quot;websocket&quot;</span><span style="color: #339933;">,</span>
<span style="color: #009900;">&#125;</span></pre></td></tr></table><p class="theCode" style="display:none;">&quot;ws&quot;: {
 &quot;type&quot;: &quot;websocket&quot;,
}</p></div>

<p>Le routeur est prêt, on lance Crossbar.io :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">$ crossbar start
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Log opened.
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> ============================== Crossbar.io ==============================
&nbsp;
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Crossbar.io 0.9.12-<span style="color: #000000;">2</span> starting
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Running on CPython using EPollReactor reactor
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Starting from node directory <span style="color: #000000; font-weight: bold;">/</span>home<span style="color: #000000; font-weight: bold;">/</span>sam<span style="color: #000000; font-weight: bold;">/</span>Work<span style="color: #000000; font-weight: bold;">/</span>sametmax<span style="color: #000000; font-weight: bold;">/</span>code_des_articles<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">2014</span><span style="color: #000000; font-weight: bold;">/</span>juin<span style="color: #000000; font-weight: bold;">/</span>video_remote<span style="color: #000000; font-weight: bold;">/</span>.crossbar
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Starting from <span style="color: #7a0874; font-weight: bold;">local</span> configuration <span style="color: #ff0000;">'/home/sam/Work/sametmax/code_des_articles/2014/juin/video_remote/.crossbar/config.json'</span>
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Warning, could not <span style="color: #000000; font-weight: bold;">set</span> process title <span style="color: #7a0874; font-weight: bold;">&#40;</span>setproctitle not installed<span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Warning: process utilities not available
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> No WAMPlets detected <span style="color: #000000; font-weight: bold;">in</span> enviroment.
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Starting Router with ID <span style="color: #ff0000;">'worker1'</span> ..
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Entering reactor event loop ...
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Router      <span style="color: #000000;">26917</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Log opened.
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Router      <span style="color: #000000;">26917</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Warning: could not <span style="color: #000000; font-weight: bold;">set</span> worker process title <span style="color: #7a0874; font-weight: bold;">&#40;</span>setproctitle not installed<span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">55</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Router      <span style="color: #000000;">26917</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Running under CPython using EPollReactor reactor
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">56</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Router      <span style="color: #000000;">26917</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Entering event loop ..
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">56</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Router      <span style="color: #000000;">26917</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Warning: process utilities not available
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">56</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Router with ID <span style="color: #ff0000;">'worker1'</span> and PID <span style="color: #000000;">26917</span> started
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">56</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Router <span style="color: #ff0000;">'worker1'</span>: realm <span style="color: #ff0000;">'realm1'</span> started
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">56</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Router <span style="color: #ff0000;">'worker1'</span>: role <span style="color: #ff0000;">'role1'</span> started on realm <span style="color: #ff0000;">'realm1'</span>
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">56</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Router      <span style="color: #000000;">26917</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Site starting on <span style="color: #000000;">8080</span>
<span style="color: #000000;">2015</span>-01-07 <span style="color: #000000;">20</span>:02:<span style="color: #000000;">56</span>+0700 <span style="color: #7a0874; font-weight: bold;">&#91;</span>Controller  <span style="color: #000000;">26914</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> Router <span style="color: #ff0000;">'worker1'</span>: transport <span style="color: #ff0000;">'transport1'</span> started</pre></td></tr></table><p class="theCode" style="display:none;">$ crossbar start
2015-01-07 20:02:55+0700 [Controller  26914] Log opened.
2015-01-07 20:02:55+0700 [Controller  26914] ============================== Crossbar.io ==============================
    
2015-01-07 20:02:55+0700 [Controller  26914] Crossbar.io 0.9.12-2 starting
2015-01-07 20:02:55+0700 [Controller  26914] Running on CPython using EPollReactor reactor
2015-01-07 20:02:55+0700 [Controller  26914] Starting from node directory /home/sam/Work/sametmax/code_des_articles/2014/juin/video_remote/.crossbar
2015-01-07 20:02:55+0700 [Controller  26914] Starting from local configuration '/home/sam/Work/sametmax/code_des_articles/2014/juin/video_remote/.crossbar/config.json'
2015-01-07 20:02:55+0700 [Controller  26914] Warning, could not set process title (setproctitle not installed)
2015-01-07 20:02:55+0700 [Controller  26914] Warning: process utilities not available
2015-01-07 20:02:55+0700 [Controller  26914] No WAMPlets detected in enviroment.
2015-01-07 20:02:55+0700 [Controller  26914] Starting Router with ID 'worker1' ..
2015-01-07 20:02:55+0700 [Controller  26914] Entering reactor event loop ...
2015-01-07 20:02:55+0700 [Router      26917] Log opened.
2015-01-07 20:02:55+0700 [Router      26917] Warning: could not set worker process title (setproctitle not installed)
2015-01-07 20:02:55+0700 [Router      26917] Running under CPython using EPollReactor reactor
2015-01-07 20:02:56+0700 [Router      26917] Entering event loop ..
2015-01-07 20:02:56+0700 [Router      26917] Warning: process utilities not available
2015-01-07 20:02:56+0700 [Controller  26914] Router with ID 'worker1' and PID 26917 started
2015-01-07 20:02:56+0700 [Controller  26914] Router 'worker1': realm 'realm1' started
2015-01-07 20:02:56+0700 [Controller  26914] Router 'worker1': role 'role1' started on realm 'realm1'
2015-01-07 20:02:56+0700 [Router      26917] Site starting on 8080
2015-01-07 20:02:56+0700 [Controller  26914] Router 'worker1': transport 'transport1' started</p></div>

<h2>Setup du client</h2>
<p>Pour cette démo, le serveur n&#8217;a pas grand chose à faire. On pourrait en fait la faire sans aucun code Python, mais ça va nous simplifier la vie et donner un peut de grain à moudre pour le tuto.</p>
<p>En effet, on a deux problématiques que le serveur va résoudre facilement pour nous : <strong>créer un ID unique pour le player et récupérer l&#8217;IP sur le réseau local.</strong></p>
<p>L&#8217;ID, c&#8217;est simplement que si plusieurs personnes lancent en même temps un player, on ne veut pas que les télécommandes puissent lancer un ordre à un autre player que le sien. On pourrait utiliser un timestamp, mais ils sont contigus, n&#8217;importe quel script kiddies pourrait faire un script pour foutre la merde. On va donc créer un ID unique qui ne soit pas facilement prévisible. Javascript n&#8217;a rien pour faire ça en natif, et c&#8217;est un peu con de charger une lib de plus pour ça alors que Python peut le faire pour nous.</p>
<p>L&#8217;IP, c&#8217;est parce qu&#8217;il faut donner l&#8217;adresse de notre machine contient notre routeur. Et le téléphone qui sert de télécommande doit se connecter à ce routeur. Il faut donc qu&#8217;il connaisse l&#8217;adresse de celui-ci, donc on va la mettre dans notre QR code.</p>
<p>Cela veut dire aussi que le téléphone doit être sur le même réseau local pour que ça fonctionne. <strong>Donc mettez votre téléphone en Wifi, pas en 3G.</strong></p>
<p>Voilà ce que donne notre code WAMP côté serveur :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># -*- coding: utf-8 -*-</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">from</span> autobahn.<span style="color: black;">twisted</span>.<span style="color: black;">wamp</span> <span style="color: #ff7700;font-weight:bold;">import</span> Application
&nbsp;
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">socket</span>
<span style="color: #ff7700;font-weight:bold;">import</span> uuid
&nbsp;
<span style="color: #808080; font-style: italic;"># Comme pour flask, l'objet app</span>
<span style="color: #808080; font-style: italic;"># est ce qui lie tous les éléments</span>
<span style="color: #808080; font-style: italic;"># de notre code ensemble. On lui donne</span>
<span style="color: #808080; font-style: italic;"># un nom, ici &quot;demo&quot;</span>
app <span style="color: #66cc66;">=</span> Application<span style="color: black;">&#40;</span><span style="color: #483d8b;">'demo'</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;"># Bien que l'app va démarrer un serveur</span>
<span style="color: #808080; font-style: italic;"># pour nous, l'app est bien un CLIENT</span>
<span style="color: #808080; font-style: italic;"># du serveur WAMP. Le serveur démarré</span>
<span style="color: #808080; font-style: italic;"># automatiquement n'est qu'une facilité</span>
<span style="color: #808080; font-style: italic;"># pour le dev. En prod on utiliserait</span>
<span style="color: #808080; font-style: italic;"># crossbar.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Juste un conteneur pour y mettre notre IP</span>
app._data <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># On déclare que cette fonction sera appelée</span>
<span style="color: #808080; font-style: italic;"># quand l'app se sera connectée au serveur WAMP.</span>
<span style="color: #808080; font-style: italic;"># Ceci permet de lancer du code juste après</span>
<span style="color: #808080; font-style: italic;"># le app.run() que l'on voit en bas du fichier.</span>
<span style="color: #808080; font-style: italic;"># '_' est une convention en Python pour dire</span>
<span style="color: #808080; font-style: italic;"># &quot;ce nom n'a aucune importance, c'est du code</span>
<span style="color: #808080; font-style: italic;"># jetable qu'on utilisera une seule fois&quot;.</span>
<span style="color: #66cc66;">@</span>app.<span style="color: #dc143c;">signal</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'onjoined'</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> _<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
   <span style="color: #808080; font-style: italic;"># On récupère notre adresse IP sur le réseau local</span>
   <span style="color: #808080; font-style: italic;"># C'est une astuce qui demande de se connecter et donc</span>
   <span style="color: #808080; font-style: italic;">#  à une IP externe, on a besoin d'une connexion internet.</span>
   s <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">socket</span>.<span style="color: #dc143c;">socket</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">socket</span>.<span style="color: black;">AF_INET</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">socket</span>.<span style="color: black;">SOCK_DGRAM</span><span style="color: black;">&#41;</span>
   s.<span style="color: black;">connect</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;8.8.8.8&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">80</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
   <span style="color: #808080; font-style: italic;"># On stocke l'adresse IP locale dans un conteneur</span>
   <span style="color: #808080; font-style: italic;"># qui sera accessible partout ailleur.</span>
   app._data<span style="color: black;">&#91;</span><span style="color: #483d8b;">'LOCAL_IP'</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> s.<span style="color: black;">getsockname</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>
   s.<span style="color: black;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># On déclare que la fonction &quot;ip()&quot; est appelable</span>
<span style="color: #808080; font-style: italic;"># via RCP. Ce qui veut dire que tout autre client</span>
<span style="color: #808080; font-style: italic;"># WAMP peut obtenir le résultat de cette fonction.</span>
<span style="color: #808080; font-style: italic;"># Donc on va pouvoir l'appeler depuis notre navigateur.</span>
<span style="color: #808080; font-style: italic;"># Comme notre app s'appelle &quot;demo&quot; et notre fonction</span>
<span style="color: #808080; font-style: italic;"># s'appelle &quot;ip&quot;, un client pourra l'appeler en faisant</span>
<span style="color: #808080; font-style: italic;"># &quot;demo.ip&quot;.</span>
<span style="color: #66cc66;">@</span>app.<span style="color: black;">register</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> ip<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
   <span style="color: #808080; font-style: italic;"># On ne fait que retourner l'IP locale. Rien de fou.</span>
   <span style="color: #ff7700;font-weight:bold;">return</span> app._data<span style="color: black;">&#91;</span><span style="color: #483d8b;">'LOCAL_IP'</span><span style="color: black;">&#93;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Je voulais appeler cette fonction distante &quot;uuid&quot;, mais ça</span>
<span style="color: #808080; font-style: italic;"># override le module Python uuid. Ce n'est pas une bonne</span>
<span style="color: #808080; font-style: italic;"># idée. Je l'appelle donc 'get_uuid' mais je déclare le</span>
<span style="color: #808080; font-style: italic;"># namespace complet dans register(). Un client WAMP pourra donc</span>
<span style="color: #808080; font-style: italic;"># bien l'appeler via &quot;demo.uuid&quot;.</span>
<span style="color: #808080; font-style: italic;"># Notez que ce namespace doit toujours s'écrire</span>
<span style="color: #808080; font-style: italic;"># truc.machine.bidule. Pas truc/machin ou truc:machin.</span>
<span style="color: #808080; font-style: italic;"># ou truc et bidule.MACHIN.</span>
<span style="color: #66cc66;">@</span>app.<span style="color: black;">register</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'demo.uuid'</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> get_uuid<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
   <span style="color: #808080; font-style: italic;"># Retourne un UUID, sans les tirets.</span>
   <span style="color: #808080; font-style: italic;"># ex: b27f7e9360c04efabfae5ac21a8f4e3c</span>
   <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">str</span><span style="color: black;">&#40;</span>uuid.<span style="color: black;">uuid4</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>.<span style="color: black;">replace</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'-'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">''</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># On lance notre client qui va se connecter au</span>
<span style="color: #808080; font-style: italic;"># routeur.</span>
<span style="color: #ff7700;font-weight:bold;">if</span> __name__ <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'__main__'</span>:
    app.<span style="color: black;">run</span><span style="color: black;">&#40;</span>url<span style="color: #66cc66;">=</span><span style="color: #483d8b;">&quot;ws://127.0.0.1:8080/ws&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;"># On ne peut rien mettre comme code ici, il faut le</span>
<span style="color: #808080; font-style: italic;"># mettre dans @app.signal('onjoined') si on veut</span>
<span style="color: #808080; font-style: italic;"># entrer du code après que l'app soit lancée.</span></pre></td></tr></table><p class="theCode" style="display:none;"># -*- coding: utf-8 -*-

from autobahn.twisted.wamp import Application

import socket
import uuid

# Comme pour flask, l'objet app
# est ce qui lie tous les éléments
# de notre code ensemble. On lui donne
# un nom, ici &quot;demo&quot;
app = Application('demo')
# Bien que l'app va démarrer un serveur
# pour nous, l'app est bien un CLIENT
# du serveur WAMP. Le serveur démarré
# automatiquement n'est qu'une facilité
# pour le dev. En prod on utiliserait
# crossbar.

# Juste un conteneur pour y mettre notre IP
app._data = {}

# On déclare que cette fonction sera appelée
# quand l'app se sera connectée au serveur WAMP.
# Ceci permet de lancer du code juste après
# le app.run() que l'on voit en bas du fichier.
# '_' est une convention en Python pour dire
# &quot;ce nom n'a aucune importance, c'est du code
# jetable qu'on utilisera une seule fois&quot;.
@app.signal('onjoined')
def _():
   # On récupère notre adresse IP sur le réseau local
   # C'est une astuce qui demande de se connecter et donc
   #  à une IP externe, on a besoin d'une connexion internet.
   s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
   s.connect((&quot;8.8.8.8&quot;, 80))
   # On stocke l'adresse IP locale dans un conteneur
   # qui sera accessible partout ailleur.
   app._data['LOCAL_IP'] = s.getsockname()[0]
   s.close()

# On déclare que la fonction &quot;ip()&quot; est appelable
# via RCP. Ce qui veut dire que tout autre client
# WAMP peut obtenir le résultat de cette fonction.
# Donc on va pouvoir l'appeler depuis notre navigateur.
# Comme notre app s'appelle &quot;demo&quot; et notre fonction
# s'appelle &quot;ip&quot;, un client pourra l'appeler en faisant
# &quot;demo.ip&quot;.
@app.register()
def ip():
   # On ne fait que retourner l'IP locale. Rien de fou.
   return app._data['LOCAL_IP']

# Je voulais appeler cette fonction distante &quot;uuid&quot;, mais ça
# override le module Python uuid. Ce n'est pas une bonne
# idée. Je l'appelle donc 'get_uuid' mais je déclare le
# namespace complet dans register(). Un client WAMP pourra donc
# bien l'appeler via &quot;demo.uuid&quot;.
# Notez que ce namespace doit toujours s'écrire
# truc.machine.bidule. Pas truc/machin ou truc:machin.
# ou truc et bidule.MACHIN.
@app.register('demo.uuid')
def get_uuid():
   # Retourne un UUID, sans les tirets.
   # ex: b27f7e9360c04efabfae5ac21a8f4e3c
   return str(uuid.uuid4()).replace('-', '')

# On lance notre client qui va se connecter au
# routeur.
if __name__ == '__main__':
    app.run(url=&quot;ws://127.0.0.1:8080/ws&quot;)
# On ne peut rien mettre comme code ici, il faut le
# mettre dans @app.signal('onjoined') si on veut
# entrer du code après que l'app soit lancée.</p></div>

<p>Et on lance notre app dans un autre terminal:</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">python app.py</pre></td></tr></table><p class="theCode" style="display:none;">python app.py</p></div>

<p>Nous avons maintenant Crossbar.io qui tourne d&#8217;une console, et le client Python qui tourne dans une seconde console, connecté au routeur.</p>
<h2>Le lecteur vidéo</h2>
<p>Il nous faut maintenant définir le comportement de notre lecteur vidéo, un client WAMP Javascript. Il s&#8217;agit essentiellement de se connecter au serveur WAMP, et d&#8217;échanger des messages via RPC ou PUB/SUB :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;">  <span style="color: #000066; font-weight: bold;">var</span> player <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span><span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
  <span style="color: #000066; font-weight: bold;">var</span> url<span style="color: #339933;">;</span>
  <span style="color: #006600; font-style: italic;">/* On va utiliser du pur JS histoire de pas mélanger
    des notions de jQuery dans le tas. Je ne vais
    PAS utiliser les best practices sinon vous allez
    être noyés dans des détails */</span>
&nbsp;
  <span style="color: #006600; font-style: italic;">/* Lancer le code une fois que la page est chargée */</span>
  window.<span style="color: #660066;">addEventListener</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;load&quot;</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
&nbsp;
    <span style="color: #006600; font-style: italic;">/* Connexion au serveur WAMP. J'utilise
       les valeurs par défaut du serveur de
       dev. On ouvre explicitement la connection
       à la fin du script. */</span>
    <span style="color: #000066; font-weight: bold;">var</span> connection <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> autobahn.<span style="color: #660066;">Connection</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span>
       url<span style="color: #339933;">:</span> <span style="color: #3366CC;">'ws://'</span> <span style="color: #339933;">+</span> window.<span style="color: #660066;">location</span>.<span style="color: #660066;">hostname</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">':8080/ws'</span><span style="color: #339933;">,</span>
       realm<span style="color: #339933;">:</span> <span style="color: #3366CC;">'realm1'</span>
    <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #006600; font-style: italic;">/* Lancer ce code une fois que la connexion
       est réussie. Notez que je ne gère pas
       les erreurs dans dans une APP JS, c'est
       un puits sans fond. */</span>
    connection.<span style="color: #660066;">onopen</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>session<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
      <span style="color: #006600; font-style: italic;">/* Appel de la fonction ip() sur le serveur */</span>
      session.<span style="color: #660066;">call</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'demo.ip'</span><span style="color: #009900;">&#41;</span>
&nbsp;
      <span style="color: #006600; font-style: italic;">/* Une fois qu'on a récupéré l'IP,
         on peut fabriquer l'URL de notre
         projet et on appelle la fonction
         get_uuid() du serveur */</span>
      .<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>ip<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        url <span style="color: #339933;">=</span> <span style="color: #3366CC;">'http://'</span> <span style="color: #339933;">+</span> ip <span style="color: #339933;">+</span> <span style="color: #3366CC;">':8000'</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">return</span> session.<span style="color: #660066;">call</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'demo.uuid'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
      <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
&nbsp;
      <span style="color: #006600; font-style: italic;">/* Une fois qu'on a l'UUID, on peut commencer
         à gérer la partie télécommande */</span>
      .<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>uuid<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
&nbsp;
        <span style="color: #006600; font-style: italic;">/* Création du QR code avec le lien pointant
           sur la bonne URL. On met l'ID dans le hash. */</span>
        <span style="color: #000066; font-weight: bold;">var</span> controlUrl <span style="color: #339933;">=</span> url <span style="color: #339933;">+</span> <span style="color: #3366CC;">'/control.html#'</span> <span style="color: #339933;">+</span> uuid<span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">var</span> codeDiv <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;qrcode&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">new</span> QRCode<span style="color: #009900;">&#40;</span>codeDiv<span style="color: #339933;">,</span> controlUrl<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #000066; font-weight: bold;">var</span> ctrllink <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;ctrllink&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        ctrllink.<span style="color: #660066;">href</span> <span style="color: #339933;">=</span> controlUrl<span style="color: #339933;">;</span>
&nbsp;
        <span style="color: #006600; font-style: italic;">/* Notre travail consiste essentiellement à
           manipuler cet élément */</span>
        <span style="color: #000066; font-weight: bold;">var</span> video <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;vid&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
        <span style="color: #006600; font-style: italic;">/* On attache déclare 4 fonctions comme étant
           appelable à distance. Ces fonctions sont
           appelables en utilisant le nom composé
           de notre ID et de l'action qu'on souhaite
           faire. Ex:
           'b27f7e9360c04efabfae5ac21a8f4e3c.play'
           pour appeler &quot;play&quot; sur notre session. */</span>
        session.<span style="color: #660066;">register</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.play'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
           video.<span style="color: #660066;">play</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
        session.<span style="color: #660066;">register</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.pause'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
           video.<span style="color: #660066;">pause</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
        session.<span style="color: #660066;">register</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.volume'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>val<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
           video.<span style="color: #660066;">volume</span> <span style="color: #339933;">=</span> val<span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
        session.<span style="color: #660066;">register</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.status'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>val<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
          <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #009900;">&#123;</span>
            <span style="color: #3366CC;">'playing'</span><span style="color: #339933;">:</span> <span style="color: #339933;">!</span>video.<span style="color: #660066;">paused</span><span style="color: #339933;">,</span>
            <span style="color: #3366CC;">'volume'</span><span style="color: #339933;">:</span> video.<span style="color: #660066;">volume</span>
          <span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
&nbsp;
&nbsp;
       <span style="color: #006600; font-style: italic;">/* Quelqu'un peut très bien
           appuyer sur play directement sur cette page.
&nbsp;
          Il faut donc réagir si l'utilisateur le fait,
          publier un événement via WAMP pour permettre
          à notre télécommande de se mettre à jour
          */</span>
       video.<span style="color: #660066;">addEventListener</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'play'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
         <span style="color: #006600; font-style: italic;">/* On publie un message indiquant que
            le player a recommencé à lire la vidéo.
            */</span>
         session.<span style="color: #660066;">publish</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.play'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
       <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
        video.<span style="color: #660066;">addEventListener</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'pause'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
          session.<span style="color: #660066;">publish</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.pause'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
        video.<span style="color: #660066;">addEventListener</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'volumechange'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
          session.<span style="color: #660066;">publish</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.volume'</span><span style="color: #339933;">,</span> <span style="color: #009900;">&#91;</span>video.<span style="color: #660066;">volume</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
     <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #006600; font-style: italic;">/* Ouverture de la connection une fois que tous les
       callbacks sont bien en place.*/</span>
    connection.<span style="color: #660066;">open</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">  var player = {};
  var url;
  /* On va utiliser du pur JS histoire de pas mélanger
    des notions de jQuery dans le tas. Je ne vais
    PAS utiliser les best practices sinon vous allez
    être noyés dans des détails */

  /* Lancer le code une fois que la page est chargée */
  window.addEventListener(&quot;load&quot;, function(){

    /* Connexion au serveur WAMP. J'utilise
       les valeurs par défaut du serveur de
       dev. On ouvre explicitement la connection
       à la fin du script. */
    var connection = new autobahn.Connection({
       url: 'ws://' + window.location.hostname + ':8080/ws',
       realm: 'realm1'
    });

    /* Lancer ce code une fois que la connexion
       est réussie. Notez que je ne gère pas
       les erreurs dans dans une APP JS, c'est
       un puits sans fond. */
    connection.onopen = function (session) {

      /* Appel de la fonction ip() sur le serveur */
      session.call('demo.ip')

      /* Une fois qu'on a récupéré l'IP,
         on peut fabriquer l'URL de notre
         projet et on appelle la fonction
         get_uuid() du serveur */
      .then(function(ip){
        url = 'http://' + ip + ':8000';
        return session.call('demo.uuid');
      })

      /* Une fois qu'on a l'UUID, on peut commencer
         à gérer la partie télécommande */
      .then(function(uuid){

        /* Création du QR code avec le lien pointant
           sur la bonne URL. On met l'ID dans le hash. */
        var controlUrl = url + '/control.html#' + uuid;
        var codeDiv = document.getElementById(&quot;qrcode&quot;);
        new QRCode(codeDiv, controlUrl);
        var ctrllink = document.getElementById(&quot;ctrllink&quot;);
        ctrllink.href = controlUrl;

        /* Notre travail consiste essentiellement à
           manipuler cet élément */
        var video = document.getElementById(&quot;vid&quot;);

        /* On attache déclare 4 fonctions comme étant
           appelable à distance. Ces fonctions sont
           appelables en utilisant le nom composé
           de notre ID et de l'action qu'on souhaite
           faire. Ex:
           'b27f7e9360c04efabfae5ac21a8f4e3c.play'
           pour appeler &quot;play&quot; sur notre session. */
        session.register(uuid + '.play', function(){
           video.play();
        });

        session.register(uuid + '.pause', function(){
           video.pause();
        });

        session.register(uuid + '.volume', function(val){
           video.volume = val[0];
        });

        session.register(uuid + '.status', function(val){
          return {
            'playing': !video.paused,
            'volume': video.volume
          };
        });



       /* Quelqu'un peut très bien
           appuyer sur play directement sur cette page.

          Il faut donc réagir si l'utilisateur le fait,
          publier un événement via WAMP pour permettre
          à notre télécommande de se mettre à jour
          */
       video.addEventListener('play', function(){
         /* On publie un message indiquant que
            le player a recommencé à lire la vidéo.
            */
         session.publish(uuid + '.play');
       });

        video.addEventListener('pause', function(){
          session.publish(uuid + '.pause');
        });

        video.addEventListener('volumechange', function(){
          session.publish(uuid + '.volume', [video.volume]);
        });

     });
    };

    /* Ouverture de la connection une fois que tous les
       callbacks sont bien en place.*/
    connection.open();
  });</p></div>

<h2>Code de la télécommande</h2>
<p>La télécommande est notre dernier client WAMP (on peut avoir plein de clients WAMP, ne vous inquiétez, ça tient 6000 connections simultanées sur un tout petit Raspberry PI). </p>
<p>Son code a pour but d&#8217;envoyer des ordres au player HTML5, mais aussi de mettre à jour son UI si le player change d&#8217;état.</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #006600; font-style: italic;">/* L'objet qui se charge de la logique de nos
   controles play/pause et changement de
   volume.
   Rien de fou, il change l'affichage
   du bouton et du slider selon qu'on
   est en pause/play et la valeur du
   volume.
   */</span>
<span style="color: #000066; font-weight: bold;">var</span> control <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>
   playing<span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">false</span><span style="color: #339933;">,</span>
   setPlaying<span style="color: #339933;">:</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>val<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      control.<span style="color: #660066;">playing</span> <span style="color: #339933;">=</span> val<span style="color: #339933;">;</span>
      <span style="color: #000066; font-weight: bold;">var</span> button <span style="color: #339933;">=</span> window.<span style="color: #660066;">document</span>.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'play'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
      <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>val<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
         button.<span style="color: #660066;">innerHTML</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">'Play'</span>
      <span style="color: #009900;">&#125;</span> <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
         button.<span style="color: #660066;">innerHTML</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">'Pause'</span><span style="color: #339933;">;</span>
      <span style="color: #009900;">&#125;</span>
   <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span>
   setVolume<span style="color: #339933;">:</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>val<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
      <span style="color: #000066; font-weight: bold;">var</span> slider <span style="color: #339933;">=</span> window.<span style="color: #660066;">document</span>.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'volume'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
      slider.<span style="color: #660066;">value</span> <span style="color: #339933;">=</span> val<span style="color: #339933;">;</span>
   <span style="color: #009900;">&#125;</span>
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
window.<span style="color: #660066;">onload</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
  <span style="color: #000066; font-weight: bold;">var</span> connection <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">new</span> autobahn.<span style="color: #660066;">Connection</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span>
    url<span style="color: #339933;">:</span> <span style="color: #3366CC;">'ws://'</span> <span style="color: #339933;">+</span> window.<span style="color: #660066;">location</span>.<span style="color: #660066;">hostname</span> <span style="color: #339933;">+</span> <span style="color: #3366CC;">':8080/ws'</span><span style="color: #339933;">,</span>
    realm<span style="color: #339933;">:</span> <span style="color: #3366CC;">'realm1'</span>
  <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
  connection.<span style="color: #660066;">onopen</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span> <span style="color: #009900;">&#40;</span>session<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
&nbsp;
    <span style="color: #006600; font-style: italic;">/* Récupération de l'ID dans le hash de l'URL */</span>
    <span style="color: #000066; font-weight: bold;">var</span> uuid <span style="color: #339933;">=</span> window.<span style="color: #660066;">location</span>.<span style="color: #660066;">hash</span>.<span style="color: #660066;">replace</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'#'</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">''</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #006600; font-style: italic;">/* Mise à jour des controles selon le status actuel
       du player grace à un appel RPC vers notre autre
       page. */</span>
    session.<span style="color: #660066;">call</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.status'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">then</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>status<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
&nbsp;
      control.<span style="color: #660066;">setPlaying</span><span style="color: #009900;">&#40;</span>status<span style="color: #009900;">&#91;</span><span style="color: #3366CC;">'playing'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
      control.<span style="color: #660066;">setVolume</span><span style="color: #009900;">&#40;</span>status<span style="color: #009900;">&#91;</span><span style="color: #3366CC;">'volume'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
      <span style="color: #006600; font-style: italic;">/* On attache l'appui sur les contrôles à
         un appel de la fonction play() sur le
         player distant. L'uuid nous permet
         de n'envoyer l'événement que sur le
         bon player. */</span>
      control.<span style="color: #660066;">togglePlay</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
        <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>control.<span style="color: #660066;">playing</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
          session.<span style="color: #660066;">call</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.pause'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
          control.<span style="color: #660066;">setPlaying</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span> <span style="color: #000066; font-weight: bold;">else</span> <span style="color: #009900;">&#123;</span>
          session.<span style="color: #660066;">call</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.play'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
          control.<span style="color: #660066;">setPlaying</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
      <span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
&nbsp;
      control.<span style="color: #660066;">volume</span> <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>val<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        session.<span style="color: #660066;">call</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.volume'</span><span style="color: #339933;">,</span> <span style="color: #009900;">&#91;</span>val <span style="color: #339933;">/</span> <span style="color: #CC0000;">100</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
      <span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
&nbsp;
      <span style="color: #006600; font-style: italic;">/* On ajoute un callback sur les événements
         de changement de status du player. Si
         quelqu'un fait play/pause ou change le
         volume, on veut mettre à jour la page. */</span>
      session.<span style="color: #660066;">subscribe</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.play'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        control.<span style="color: #660066;">setPlaying</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
      <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
      session.<span style="color: #660066;">subscribe</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.pause'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        control.<span style="color: #660066;">setPlaying</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">false</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
      <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
      session.<span style="color: #660066;">subscribe</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.volume'</span><span style="color: #339933;">,</span> <span style="color: #000066; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>val<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        control.<span style="color: #660066;">setVolume</span><span style="color: #009900;">&#40;</span>val<span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #009900;">&#93;</span> <span style="color: #339933;">*</span> <span style="color: #CC0000;">100</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
      <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
  <span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
&nbsp;
  connection.<span style="color: #660066;">open</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">/* L'objet qui se charge de la logique de nos
   controles play/pause et changement de
   volume.
   Rien de fou, il change l'affichage
   du bouton et du slider selon qu'on
   est en pause/play et la valeur du
   volume.
   */
var control = {
   playing: false,
   setPlaying: function(val){
      control.playing = val;
      var button = window.document.getElementById('play');
      if (!val){
         button.innerHTML = 'Play'
      } else {
         button.innerHTML = 'Pause';
      }
   },
   setVolume: function(val){
      var slider = window.document.getElementById('volume');
      slider.value = val;
   }
};
window.onload = function(){
  var connection = new autobahn.Connection({
    url: 'ws://' + window.location.hostname + ':8080/ws',
    realm: 'realm1'
  });

  connection.onopen = function (session) {

    /* Récupération de l'ID dans le hash de l'URL */
    var uuid = window.location.hash.replace('#', '');

    /* Mise à jour des controles selon le status actuel
       du player grace à un appel RPC vers notre autre
       page. */
    session.call(uuid + '.status').then(function(status){

      control.setPlaying(status['playing']);
      control.setVolume(status['volume'])

      /* On attache l'appui sur les contrôles à
         un appel de la fonction play() sur le
         player distant. L'uuid nous permet
         de n'envoyer l'événement que sur le
         bon player. */
      control.togglePlay = function() {
        if (control.playing){
          session.call(uuid + '.pause');
          control.setPlaying(false);
        } else {
          session.call(uuid + '.play');
          control.setPlaying(true);
        }
      };

      control.volume = function(val){
        session.call(uuid + '.volume', [val / 100]);
      };

      /* On ajoute un callback sur les événements
         de changement de status du player. Si
         quelqu'un fait play/pause ou change le
         volume, on veut mettre à jour la page. */
      session.subscribe(uuid + '.play', function(){
        control.setPlaying(true);
      });

      session.subscribe(uuid + '.pause', function(){
        control.setPlaying(false);
      });

      session.subscribe(uuid + '.volume', function(val){
        control.setVolume(val[0] * 100);
      });
    });
  };

  connection.open();
};</p></div>

<h2>En résumé</h2>
<p>Voici à quoi ressemble le projet final :</p>
<pre>.
├── app.py
├── control.html
├── .crossbar
│   └── config.json
└── index.html
</pre>
<div id="attachment_11173" style="width: 499px" class="wp-caption aligncenter"><a href="../wp-content/uploads/2014/06/demo_video_wamp.png" class="grouped_elements" rel="tc-fancybox-group11146"><img class="size-full wp-image-11173" title="Bien que l'app Python lance le serveur automatiquement et de manière invisible, c'est bien un composant à part." src="../wp-content/uploads/2014/06/demo_video_wamp.png" alt="Schéma de fonctionnement de la démo" width="489" height="346" /></a><p class="wp-caption-text">Bien que l&#8217;app Python lance le serveur automatiquement et de manière invisible, c&#8217;est bien un composant à part.</p></div>
<p>Pour ce projet, on aura utilisé :</p>
<ul>
<li><a href="http://wamp.ws/">WAMP</a>: le protocole qui permet de faire communiquer en temps réel des parties d&#8217;application via RPC et PUB/SUB.</li>
<li><a href="http://autobahn.ws/js/">Autobahn.js</a>: une lib pour créer des clients WAMP en javascript.</li>
<li><a href="http://autobahn.ws/python/">Autobahn.py</a>: une lib pour créer des clients WAMP en Python.</li>
<li><a href="http://crossbar.io/">Crossbar.io</a>: un routeur WAMP.</li>
</ul>
<p>Il y a pas mal de notions à prendre en compte.</p>
<p>D&#8217;abord, le <strong>RPC</strong>.</p>
<p>Cela permet à un client de dire &#8220;les autres clients peuvent appeler cette fonction à distance&#8221;. On l&#8217;utilise pour exposer <code>ip()</code> et <code>get_uuid()</code> sur notre serveur et notre Javascript peut donc les appeler. Mais on l&#8217;utilise AUSSI pour qu&#8217;une des pages (le player) expose <code>play()</code>, <code>pause()</code> et <code>volume()</code> et que l&#8217;autre page (notre télécommande) puisse les utiliser.</p>
<p>La grosse différence, c&#8217;est que <code>ip()</code> peut être appelé par tous les clients en utilisant &#8220;demo.ip&#8221; alors que <code>play()</code> ne peut être appelé que par les clients qui connaissent l&#8217;ID du player, puisqu&#8217;il faut utiliser &#8220;&lt;id&gt;.play&#8221;.</p>
<p>Ensuite, il y a le <strong>PUB/SUB</strong>.</p>
<p>Cela permet à un client de dire &#8220;j&#8217;écoute tous les messages adressés à ce nom&#8221;. Et un autre client peut envoyer un message (on appelle ça aussi un événement, c&#8217;est pareil) sur ce nom, de telle sorte que tous les clients abonnés le reçoivent.</p>
<p>On l&#8217;utilise pour que notre télécommande dise &#8220;j&#8217;écoute tous les messages qui concernent les changements de status du player.&#8221; De l&#8217;autre côté, quand on clique sur un contrôle du player, on envoie un message précisant si le volume a changé, ou si on a appuyé sur play/pause. La télécommande peut ainsi mettre son UI à jour et refléter par exemple, la nouvelle valeur du volume.</p>
<p>Cela résume bien les usages principaux de ces deux outils :</p>
<ul>
<li>RPC permet de donner un ordre ou récupérer une information.</li>
<li>PUB/SUB permet de (se) tenir au courant d&#8217;un événement.</li>
</ul>
<p>Voici le workflow de notre projet :</p>
<ul>
<li>On lance un serveur WAMP.</li>
<li>On connecte des clients dessus (du code Python ou Js dans notre exemple).</li>
<li>Les clients déclarent les fonctions qu&#8217;ils exposent en RPC et les événements qu&#8217;ils écoutent en PUB/SUB.</li>
<li>Ensuite on réagit aux actions utilisateurs et on fait les appels RPC et les publications PUB/SUB en conséquence.</li>
</ul>
<p><strong>Si vous virez tous les commentaires, vous verrez que le code est en fait vraiment court pour une application aussi complexe.</strong></p>
<p>Encore une fois, il est possible de le faire sans WAMP, ce sera juste plus compliqué. Je vous invite à essayer de le faire pour vous rendre compte. Avec PHP, Ruby ou une app WSGI, c&#8217;est pas marrant du tout. Avec NodeJs, c&#8217;est plus simple, mais il faut quand même se taper la logique de gestion RPC et PUB/SUB à la main ou installer pas mal de libs en plus.</p>
<p>WAMP rend ce genre d&#8217;app triviale à écrire. Enfin triviale parce que là j&#8217;ignore tous les edge cases, évidemment. Pour un produit solide, il faut toujours suer un peu.</p>
<h2>Les limites du truc</h2>
<p>C&#8217;est du Python 2.7. Bientôt on pourra le faire avec asyncio et donc Python 3.4, mais malheureusement sans le serveur de dev.</p>
<p>Heureusement, Twisted est en cours de portage vers Python 3, et donc tout finira par marcher en 3.2+.</p>
<p>C&#8217;est du HTML5, mais bien entendu, rien ne vous empêche de faire ça avec du Flash si ça vous amuse.</p>
<p>C&#8217;est du WebSocket, mais on peut utiliser un peu de Flash pour <a href="https://github.com/gimite/web-socket-js">simuler WebSocket</a> pour les vieux navigateurs qui ne le supportent pas.</p>
<p>Non, la vraie limite c&#8217;est encore la jeunesse du projet : pas d&#8217;autoreload pour le serveur (super chiant de devoir le faire à la main à chaque fois qu&#8217;on modifie le code) et les erreurs côté serveur se lisent dans la console JS, et pas dans le terminal depuis lequel on a lancé le serveur. Plein de petits détails comme ça.</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-official sd-sharing"><h3 class="sd-title">Partager:</h3><div class="sd-content"><ul><li class="share-twitter"><a href="https://twitter.com/share" class="twitter-share-button" data-url="http://sametmax.com/introduction-a-wamp-en-python/" data-text="Petite démo pragmatique d&#039;un usage de WAMP en Python"  >Tweet</a></li><li class="share-facebook"><div class="fb-share-button" data-href="http://sametmax.com/introduction-a-wamp-en-python/" data-layout="button_count"></div></li><li class="share-google-plus-1"><div class="googleplus1_button"><div class="g-plus" data-action="share" data-annotation="bubble" data-href="http://sametmax.com/introduction-a-wamp-en-python/"></div></div></li><li class="share-email"><a rel="nofollow" data-shared="" class="share-email sd-button" href="index.html%3Fshare=email.html" rel="noopener noreferrer" target="_blank" title="Click to email this to a friend"><span>Email</span></a></li><li><a href="index.html%3Fshare=email.html#" class="sharing-anchor sd-button share-more"><span>More</span></a></li><li class="share-end"></li></ul><div class="sharing-hidden"><div class="inner" style="display: none;"><ul><li class="share-reddit"><div class="reddit_button"><iframe src="http://www.reddit.com/static/button/button1.html?newwindow=true&width=120&amp;url=http%3A%2F%2Fsametmax.com%2Fintroduction-a-wamp-en-python%2F&amp;title=Petite%20d%C3%A9mo%20pragmatique%20d%27un%20usage%20de%20WAMP%20en%20Python" height="22" width="120" scrolling="no" frameborder="0"></iframe></div></li><li class="share-pinterest"><div class="pinterest_button"><a href="https://www.pinterest.com/pin/create/button/?url=http%3A%2F%2Fsametmax.com%2Fintroduction-a-wamp-en-python%2F&#038;media=http%3A%2F%2Fsametmax.com%2Fwp-content%2Fuploads%2F2014%2F06%2FFqebLW21.png&#038;description=Petite%20d%C3%A9mo%20pragmatique%20d%27un%20usage%20de%20WAMP%20en%20Python" data-pin-do="buttonPin" data-pin-config="beside"><img src="http://assets.pinterest.com/images/pidgets/pinit_fg_en_rect_gray_20.png" /></a></div></li><li class="share-end"></li><li class="share-tumblr"><a target="_blank" href="https://www.tumblr.com/share/link/?url=http%3A%2F%2Fsametmax.com%2Fintroduction-a-wamp-en-python%2F&name=Petite%20d%C3%A9mo%20pragmatique%20d%27un%20usage%20de%20WAMP%20en%20Python" title="Share on Tumblr" style="display:inline-block; text-indent:-9999px; overflow:hidden; width:62px; height:20px; background:url('https://platform.tumblr.com/v1/share_2.png') top left no-repeat transparent;">Share on Tumblr</a></li><li class="share-pocket"><div class="pocket_button"><a href="https://getpocket.com/save" class="pocket-btn" data-lang="en" data-save-url="http://sametmax.com/introduction-a-wamp-en-python/" data-pocket-count="horizontal" >Pocket</a></div></li><li class="share-end"></li><li class="share-end"></li></ul></div></div></div></div></div>                        </section><!-- .entry-content -->

        <footer class="entry-meta"><hr class="featurette-divider"><div class="author-info"><div class="row-fluid"><div class="comment-avatar author-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=100&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=200&#038;d=retro&#038;r=x 2x' class='avatar avatar-100 photo' height='100' width='100' /></div> <div class="author-description span10"><h3>About Sam</h3><p>Waf !</p><div class="author-link"><a href="../author/sam/index.html" rel="author">View all posts by Sam <span class="meta-nav">&rarr;</span></a></div></div></div></div></footer>                                    </article>
                                
                            
                        
                    
<div id="comments" class="comments-area" >
	<h2 id="tc-comment-title" class="comments-title">47 thoughts on &ldquo;<span>Petite démo pragmatique d&#8217;un usage de WAMP en Python</span>&rdquo;</h2>              <ul class="commentlist">
                        <li class="comment even thread-even depth-1" id="li-comment-72222">
          
            <article id="comment-72222" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/487750895a0fd37853339de694fba9f8?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/487750895a0fd37853339de694fba9f8?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">artyprog  </cite> <a class="comment-date" href="index.html#comment-72222"><time datetime="2014-06-26T07:55:33+00:00">26/06/2014 at 07:55</time></a></header>  <section class="comment-content comment"><p>Merci beaucoup Sam.</p>
<p>Je ne suis pas encore en mesure de tester<br />
ton exemple.</p>
<p>Mais j&#8217;ai juste une question, un peu stupide sans doute, pourquoi ne pas utiliser directement crossbar ?<br />
Est-ce uniquement une question d&#8217;installation, ou y a t-il un réel avantage à utiliser le serveur de dev ?</p>
<p>D&#8217;autre part, pourras-tu, à l&#8217;occasion, poster l&#8217;exemple pour mise en prod ?</p>
<p>Cordialement</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72259">
          
            <article id="comment-72259" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/d44cf7963dab7c8d2149a009bc2b9034?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/d44cf7963dab7c8d2149a009bc2b9034?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Laurent  </cite> <a class="comment-date" href="index.html#comment-72259"><time datetime="2014-06-26T08:16:35+00:00">26/06/2014 at 08:16</time></a></header>  <section class="comment-content comment"><p>Tain chapeau les gars pour tous les articles que vous postez. Y&#8217;a des fois ou vous êtes pas &#8220;aware&#8221; ?<br />
Quand je vois votre boulot et que moi en ce moment j&#8217;arrive à rien&#8230; Je vois passer plein de trucs intéressant je n&#8217;arrive pas à les lire et si éventuellement je les lis je n&#8217;arrive pas à les comprendre.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-72264">
          
            <article id="comment-72264" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72264"><time datetime="2014-06-26T08:22:22+00:00">26/06/2014 at 08:22</time></a></header>  <section class="comment-content comment"><p>@artyprog: je suis en train de voir si je peux le mettre en prod, mais ça me fait chier de config un serveur pour ça. J&#8217;utilise pas crossbar parce que ça fait des notions en plus à expliquer, et là le tuto est déjà très long. C&#8217;est juste trop pratique de pouvoir lancer un serveur de dev automatiquement.</p>
<p>Si j&#8217;ai le temps, je vais voir pour un exemple de mise en prod. Si j&#8217;ai le temps. Et la motive. Parce que je t&#8217;avoues que l&#8217;article, là, il m&#8217;a mis à genoux pour la journée.</p>
<p>@Laurent: les technos vont très vites, même pour moi. J&#8217;arrive plus à tout suivre depuis quelques mois, c&#8217;est effrayant.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-72270">
          
            <article id="comment-72270" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72270"><time datetime="2014-06-26T08:33:50+00:00">26/06/2014 at 08:33</time></a></header>  <section class="comment-content comment"><p>Arf, moi et deux correcteurs qui éditent en même temps le même article, ça fait n&#8217;importe quoi :)</p>
<p>Bon, je modifie le titre de l&#8217;article, il promet une introduction alors que c&#8217;est plus une démo, et pas un truc pas à pas bien décortiqué. Je voudrais pas faire de publicité mensongère.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-72287">
          
            <article id="comment-72287" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/b022fb204b6774a99df43d5bb849401c?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/b022fb204b6774a99df43d5bb849401c?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Zanguu  </cite> <a class="comment-date" href="index.html#comment-72287"><time datetime="2014-06-26T08:47:13+00:00">26/06/2014 at 08:47</time></a></header>  <section class="comment-content comment"><p>Typo dans le paragraphe résumé : Autohan.py; Il manque un b.</p>
<p>Aussi, je trouve ça assez frustrant de toujours remettre crossbar sur le tapis dés que tu parle de serveur, j&#8217;aurais plus vu une section à la fin du genre : &#8220;et pour utiliser ça en prod bien sur vous prenez pas le serveur de dev mais crossbar&#8221;.<br />
Là ça fait plutôt &#8220;je connais telle techno qui déchire sa maman mais je vous montrerais pas parce que c&#8217;est trop d&#8217;explication&#8221; à chaque paragraphe.<br />
(Ça à l&#8217;air un peu méchant quand je me relis, mais c&#8217;était censé être constructif)</p>
<p>J&#8217;aime bien l&#8217;article (et même que j&#8217;ai lu tout le code).<br />
J&#8217;avais du mal à cerner l’utilité exacte de WAMP et l’intérêt de l&#8217;API flaskesque, mais maintenant c&#8217;est bien plus clair et tu m&#8217;as presque fait aimer le js avec la clarté du .then().</p>
<p>Ah et petite déception, la vidéo de la démo est SFW, c&#8217;est déstabilisant.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72308">
          
            <article id="comment-72308" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/7144c4c992d3b0b2e69a83834270cb98?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/7144c4c992d3b0b2e69a83834270cb98?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">bobuss  </cite> <a class="comment-date" href="index.html#comment-72308"><time datetime="2014-06-26T08:57:03+00:00">26/06/2014 at 08:57</time></a></header>  <section class="comment-content comment"><p>Hello !<br />
Encore un super article ! merci</p>
<p>Juste, j&#8217;ai dû<br />
<code>pip install twisted</code><br />
pour lancer le programme ; autobahn ne semble pas embarquer twisted dans ses dépendances.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-72325">
          
            <article id="comment-72325" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72325"><time datetime="2014-06-26T09:04:04+00:00">26/06/2014 at 09:04</time></a></header>  <section class="comment-content comment"><p>@Zanguu: ouai mais t&#8217;as vu la taille de l&#8217;article. Si je parle d&#8217;autobahn, c&#8217;est comme parler de nginx quand tu fais un tuto sur django, c&#8217;est trop. Avec django, tu utilises le serveur de dev, et avec WAMP aussi. Mais bon, je vais voir, pour les guerriers, si je peux pas rajouter un paragraphe de mise en prod.</p>
<p>@bobuss: bien vu merci. En fait autobahn à 3 dépendances possible : trollus, asyncio ou twisted. Si on précise pas, il installe aucune. J&#8217;ai corrigé la ligne d&#8217;installation.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72341">
          
            <article id="comment-72341" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/7144c4c992d3b0b2e69a83834270cb98?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/7144c4c992d3b0b2e69a83834270cb98?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">bobuss  </cite> <a class="comment-date" href="index.html#comment-72341"><time datetime="2014-06-26T09:19:36+00:00">26/06/2014 at 09:19</time></a></header>  <section class="comment-content comment"><p>re,</p>
<p>la prochaine fois, j&#8217;opterai pour la pull-request &#8230;</p>
<p>dans le code du player, ne pas oublier de passer la valeur du volume dans le publish.</p>
<p><code><br />
video.addEventListener('volumechange', function(){<br />
    session.publish(uuid + '.volume', [video.volume]);<br />
});<br />
</code></p>
<p>et dans le code de la télécommande, dans le setVolume, c&#8217;est l&#8217;attribut value du slider<br />
<code><br />
    slider.value = val;<br />
</code></p>
<p>puis dans le callback du .status, pour setter à la bonne valeur le volume<br />
<code><br />
control.setVolume(status['volume'] * 100)<br />
</code></p>
<p>et enfin, dans le subscribe .volume, lire la donnée qu&#8217;on envoie depuis le player, et qui est un tableau</p>
<p><code><br />
session.subscribe(uuid + '.volume', function(val){<br />
    control.setVolume(val[0] * 100);<br />
});<br />
</code></p>
<p>Encore merci pour l&#8217;introduction, ça promet pour la suite !</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-72357">
          
            <article id="comment-72357" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72357"><time datetime="2014-06-26T09:30:23+00:00">26/06/2014 at 09:30</time></a></header>  <section class="comment-content comment"><p>Merci beaucoup, j&#8217;ai rajouté le volume après coup et c&#8217;est vrai que je me suis pas relu.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72366">
          
            <article id="comment-72366" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/b022fb204b6774a99df43d5bb849401c?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/b022fb204b6774a99df43d5bb849401c?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Zanguu  </cite> <a class="comment-date" href="index.html#comment-72366"><time datetime="2014-06-26T09:34:16+00:00">26/06/2014 at 09:34</time></a></header>  <section class="comment-content comment"><p>@Sam, justement avec Django tu mettrais en avant le serveur de dev pour la démo et tu préciserais à la fin qu&#8217;il ne faut pas l&#8217;utiliser pour de la prod et qu&#8217;il y a des solutions comme nginx pour la prod. Sans forcement expliquer comment le configurer.<br />
Alors que là tu relances &#8220;sans arrêt&#8221; le fait qu&#8217;il faudrait plutôt utiliser crossbar en prod comme si ça te frustrait de ne pas l&#8217;utiliser et du coup c&#8217;est frustrant pour le lecteur (ou juste pour moi, mais je suis bizarre alors on s&#8217;en fout).</p>
<p>Je demandais pas l&#8217;explication pour mettre ça en prod, il y a déjà une intro à crossbar et je suppose qu&#8217;un petit tuto est dans les drafts.</p>
<p>Et puis le point essentiel de mon dernier commentaire : C&#8217;est un très bon article qui m&#8217;a permis de beaucoup mieux appréhender WAMP et c&#8217;est l&#8217;essentiel.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-72384">
          
            <article id="comment-72384" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72384"><time datetime="2014-06-26T09:52:07+00:00">26/06/2014 at 09:52</time></a></header>  <section class="comment-content comment"><p>@Zanguu: ah, pourtant, vu que c&#8217;est moi qui ait intégré le serveur de Dev, je suis pas trop fustré sur la question :)</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72415">
          
            <article id="comment-72415" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/647dae215d91b81bb1b5da30d6990302?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/647dae215d91b81bb1b5da30d6990302?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Krypted  </cite> <a class="comment-date" href="index.html#comment-72415"><time datetime="2014-06-26T10:37:21+00:00">26/06/2014 at 10:37</time></a></header>  <section class="comment-content comment"><p>Just génial ce tuto. On est vraiment gâtés. Je vais tester ça moi même sur un projet perso. </p>
<p>2 petites questions : </p>
<p>&#8211; Si j&#8217;ai bien compris, à chaque</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"> session.<span style="color: #660066;">register</span><span style="color: #009900;">&#40;</span>uuid <span style="color: #339933;">+</span> <span style="color: #3366CC;">'.play'</span><span style="color: #339933;">,</span> func<span style="color: #009900;">&#41;</span></pre></td></tr></table><p class="theCode" style="display:none;"> session.register(uuid + '.play', func)</p></div>

<p>on enregistre un évènement sur le serveur WAMP. </p>
<p> Est-ce que ces événements sont supprimés au bout d&#8217;un moment? Parce que j&#8217;imagine que sur un serveur qui tourne pendant longtemps ça doit prendre pas mal de ressources. </p>
<p>&#8211; Si j&#8217;ai un client javascript qui dit qu&#8217;il register uuid. Est-ce que ça veut dire que le routeur wamp va envoyer toutes les nouvelles demandes RPC vers moi ?</p>
<p>Bon après j&#8217;imagine qu&#8217;il doit y avoir des moyens de spécifier</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-72442">
          
            <article id="comment-72442" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72442"><time datetime="2014-06-26T11:21:36+00:00">26/06/2014 at 11:21</time></a></header>  <section class="comment-content comment"><blockquote><p>Est-ce que ces événements sont supprimés au bout d’un moment? </p></blockquote>
<p>Dès qu&#8217;il n&#8217;y a plus de client qui fournit un callback pour ce namespace, il est supprimé du serveur. Mais bon, c&#8217;est vraiment faible comme consommation, ça risque pas grand chose.</p>
<blockquote><p>
&#8211; Si j’ai un client javascript qui dit qu’il register uuid. Est-ce que ça veut dire que le routeur wamp va envoyer toutes les nouvelles demandes RPC vers moi ?
</p></blockquote>
<p>Il me semble que le dernier arrivé est servit, mais il faudrait que je check. Dans notre cas, ça ne peut pas arriver facilement, l&#8217;ID est unique et jetable. Dans d&#8217;autres cas, il faut adapter sa solution à sa problématique.</p>
<blockquote><p>Bon après j’imagine qu’il doit y avoir des moyens de spécifier</p></blockquote>
<p>C&#8217;est à ça que servent les realms. On peut dire &#8220;ce realm là n&#8217;a pas le droit de déclarer un callback&#8221;.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72562">
          
            <article id="comment-72562" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/b022fb204b6774a99df43d5bb849401c?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/b022fb204b6774a99df43d5bb849401c?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Zanguu  </cite> <a class="comment-date" href="index.html#comment-72562"><time datetime="2014-06-26T14:01:10+00:00">26/06/2014 at 14:01</time></a></header>  <section class="comment-content comment"><p>Question con (mais vraiment hein), il y a une limite à l&#8217;imbrication des callbacks ?<br />
Exemple, pour être plus clair :<br />
<code><br />
 session.register(uuid + '.volume.up', func)<br />
 session.register(uuid + '.volume.down', func)<br />
 session.register(uuid + '.volume.bass', func)<br />
 session.register(uuid + '.volume.mute', func)</p>
<p> // exagération<br />
 session.register(uuid + '.audio.language.default.add.main', func)<br />
</code></p>
<p>L’intérêt est assez réduit pour le dernier bien sur mais pour le mute par exemple je trouve ça plus clair qu&#8217;un uuid.mute_volume.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-72575">
          
            <article id="comment-72575" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72575"><time datetime="2014-06-26T14:20:13+00:00">26/06/2014 at 14:20</time></a></header>  <section class="comment-content comment"><p>Tu veux dire l&#8217;imbrication des namespaces. Non au contraire, ta version est bien plus propre, c&#8217;est juste que j&#8217;ai laissé ça de côté pour simplifier la démo.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72580">
          
            <article id="comment-72580" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/41af3de7bb133d9832974dd67cf4c6ed?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/41af3de7bb133d9832974dd67cf4c6ed?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn"><a href='http://manatlan.com' rel='external nofollow' class='url'>manatlan</a>  </cite> <a class="comment-date" href="index.html#comment-72580"><time datetime="2014-06-26T14:33:10+00:00">26/06/2014 at 14:33</time></a></header>  <section class="comment-content comment"><p>Wouaw, just wouawww &#8230;<br />
J&#8217;avais déjà joué avec les websockets, avec nodejs, meteorjs et twisted &#8230; jadis.<br />
Je lisais avec grand intérêt tes posts sur WAMP, qui me permettait juste d’effleurer le potentiel du bousin. Mais sans jamais vraiment y plonger (l&#8217;api &#8220;pas flaskiest&#8221; ne me branchait pas du tout).<br />
J&#8217;ai récupéré tes sources, j&#8217;ai fait des register, des subscribe et des publish, de clients js et python : et just wouaw! ça appel/event dans tous les sens avec une simplicité déconcertante &#8230;<br />
Je n&#8217;ose même pas imaginer le potentiel de ce truc WAMP.<br />
Merci d&#8217;avoir posté ce post&#8230; Je crois que je suis tombé dedans : FAN !</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-72591">
          
            <article id="comment-72591" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72591"><time datetime="2014-06-26T14:54:02+00:00">26/06/2014 at 14:54</time></a></header>  <section class="comment-content comment"><p>Si tu fais des expérimentations sympas, fait tourner.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72621">
          
            <article id="comment-72621" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/41af3de7bb133d9832974dd67cf4c6ed?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/41af3de7bb133d9832974dd67cf4c6ed?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">manatlan  </cite> <a class="comment-date" href="index.html#comment-72621"><time datetime="2014-06-26T15:37:31+00:00">26/06/2014 at 15:37</time></a></header>  <section class="comment-content comment"><p>Avec les nouvelles API &#8220;flaskiest&#8221; d&#8217;autobahn, on peut créer facilement un serveur.<br />
Et sauf erreur de ma part, j&#8217;ai beau matté le code, il n&#8217;y a pas encore d&#8217;api simple pour créer un client simple (juste pour consommer du serveur) ?</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-72627">
          
            <article id="comment-72627" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-72627"><time datetime="2014-06-26T15:46:11+00:00">26/06/2014 at 15:46</time></a></header>  <section class="comment-content comment"><p>En fait, l&#8217;objet Application est un client simple.</p>
<p>Pour ne pas démarrer de serveur, il suffit de faire :</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">app.<span style="color: black;">run</span><span style="color: black;">&#40;</span>standalone<span style="color: #66cc66;">=</span><span style="color: #008000;">False</span><span style="color: black;">&#41;</span></pre></td></tr></table><p class="theCode" style="display:none;">app.run(standalone=False)</p></div>

</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72828">
          
            <article id="comment-72828" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/487750895a0fd37853339de694fba9f8?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/487750895a0fd37853339de694fba9f8?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">artyprog  </cite> <a class="comment-date" href="index.html#comment-72828"><time datetime="2014-06-26T19:45:52+00:00">26/06/2014 at 19:45</time></a></header>  <section class="comment-content comment"><p>Je viens de tester, c&#8217;est vraiment impressionnant<br />
Autobahn et Domotique devraient faire très bon ménage&#8230;</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-72923">
          
            <article id="comment-72923" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/c87ca92e43cff2f1e859384ab6e52a02?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/c87ca92e43cff2f1e859384ab6e52a02?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Robert  </cite> <a class="comment-date" href="index.html#comment-72923"><time datetime="2014-06-26T21:37:01+00:00">26/06/2014 at 21:37</time></a></header>  <section class="comment-content comment"><p>Quand on y pense, c&#8217;est vraiment horrible d&#8217;écrire et du lire du Javascript, même si j&#8217;aime bien le concept de promises.</p>
<p>J&#8217;ai de mon côté abandonné le dev web, fatigué des frameworks qui sortent tous les 4 matins, fatigué de la prédominance du Javascript, langage que je trouve imbitable, rien qu&#8217;à voir comment nos navigateurs rament à cause de lui, ça me dégoûte de plus en plus. Voir aussi toutes les appli de start up en carton qui nous pondent des milliers d&#8217;applications inutiles sur le net, de la merde en paquet de 10, je préfère encore le site à gifs animés de DarkVador (pour les plus vieux d&#8217;entre nous qui connaissaient).</p>
<p>Entre nodejs, angular, jquery, meteor et tout le bin&#8217;s, on a du code final sale, non homogène et difficile à maintenir, une horreur : débogage pourri, gestion des erreurs pourrie&#8230;D&#8217;ailleurs les dev du web ne sont plus dev, ils deviennent comme nous, les admins, de simples intégrateurs de solutions, cela donne des appli au périmètre non maîtrisé et difficile à consolider dans la durée.</p>
<p>Egalement horrible est le fait qu&#8217;on lie les lib javascript dynamiquement, dans le sens où on pointe une url&#8230;si on fait pas cela on se retrouve avec des api non mises à jour qui changent tous les 4 matins, difficile à maintenir. Si on le fait, on est obligé d&#8217;avoir une connexion au net pour l&#8217;application et les règles de firewall qui vont bien pour la production, bref ça aussi je trouve que c&#8217;est sale.</p>
<p>L&#8217;écosystème JS, ça me fait penser à la TV d&#8217;aujourd&#8217;hui, que des programmes de merde, mais que finalement tout le monde regarde car c&#8217;est hype et à la mode et surtout qu&#8217;on a tous la tête dans le guidon car le peur du décrochage technique est réelle et anxiogène.</p>
<p>Je vous le dit, dans 5 ans, sametmax feront du full JS, il n&#8217;y aura plus que cela&#8230;et des appli encore plus pourries que celles d&#8217;aujourd&#8217;hui.</p>
<p>Sinon j&#8217;ai bien aimé votre article, même si le RPC a au moins 20 ans et que le pattern pub/sub on le connaît aussi depuis longtemps, donc rien de nouveau et la longue vie du marketing hype continue&#8230;</p>
<p>Vivement le retour du VBScript ;) !</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-73017">
          
            <article id="comment-73017" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-73017"><time datetime="2014-06-27T00:15:51+00:00">27/06/2014 at 00:15</time></a></header>  <section class="comment-content comment"><p>@artyprog: à la base ça a été créé pour l&#8217;Internet des objets, il se trouve que ça marche très bien pour le web aussi.</p>
<p>@Robert: y a pas que la prog web dans la vie, donc si la prog web devient full JS, on ira voir ailleurs.</p>
<p>Par ailleurs, comme je le dis dans les autres articles sur WAMP, ni RPC ni PUB/SUB ne sont nouveaux, ce qui est nouveau c&#8217;est :</p>
<p>&#8211; le fait qu&#8217;on ait RPC __ET__ PUB/SUB dans le même protocole<br />
&#8211; la simplicité de mise en oeuvre<br />
&#8211; le fait que ça marche dans le navigateur<br />
&#8211; le fait que ça marche entre plusieurs techno (browser, python, nodejs, android, etc)</p>
<p>WAMP ne permet, je le répète, en rien de faire quelque chose qu&#8217;on ne pouvait pas faire avant. Mais quelle techno le permet ? Par contre, il permet de le faire vraiment plus facilement.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-73346">
          
            <article id="comment-73346" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/b4afa6a51d1186fd941a44b68b775983?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/b4afa6a51d1186fd941a44b68b775983?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">rogererens  </cite> <a class="comment-date" href="index.html#comment-73346"><time datetime="2014-06-27T09:01:06+00:00">27/06/2014 at 09:01</time></a></header>  <section class="comment-content comment"><p>Thanks for having put time into this tutorial!</p>
<p>One sentence I did not understand (OK, it was translated by Google):</p>
<blockquote><p>Soon we may do so with asyncio Python 3.4, but unfortunately without the dev server.</p></blockquote>
<p>Do you mean to say that in a simple development environment</p>
<p><code>python -m SimpleHTTPServer</code></p>
<p>can not be replaced by</p>
<p><code>python -m http.server</code> ?</p>
<p>If so, could you explain that in some more detail?</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-73355">
          
            <article id="comment-73355" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-73355"><time datetime="2014-06-27T09:10:52+00:00">27/06/2014 at 09:10</time></a></header>  <section class="comment-content comment"><p>Without the WAMP dev server, which currently only exists for twisted.</p>
<p>I&#8217;m going to provide a translation of this tutorial on tavendo&#8217;s blog soon. Cool that you could use GT to read it though. I never thought it would be good enough.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-73662">
          
            <article id="comment-73662" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/7cedcd5fe799f836e4ea4f9560e873d0?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/7cedcd5fe799f836e4ea4f9560e873d0?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Tobias  </cite> <a class="comment-date" href="index.html#comment-73662"><time datetime="2014-06-27T12:12:30+00:00">27/06/2014 at 12:12</time></a></header>  <section class="comment-content comment"><p>Hi Sam, thanks for another great post! This kind of hands-on, down to earth examples is highly welcome.</p>
<p>A note regarding &#8220;running in production&#8221;: you can (obviously) have Crossbar run without proxy in front, and serving everything, including static Web. This is what we regularily do. Works great. No Apache, Nginx, whatever needed. Less wheels means less stuff can go wild.</p>
<p>Docs are here: <a href="https://github.com/crossbario/crossbar/wiki#going-to-production" rel="nofollow">https://github.com/crossbario/crossbar/wiki#going-to-production</a></p>
<p>Includes description on how to run on port 80 etc.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-73673">
          
            <article id="comment-73673" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-73673"><time datetime="2014-06-27T12:19:05+00:00">27/06/2014 at 12:19</time></a></header>  <section class="comment-content comment"><p>:)</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-74867">
          
            <article id="comment-74867" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/9fa5b0a6784f7a112a1e2357cd2bdd68?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/9fa5b0a6784f7a112a1e2357cd2bdd68?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">G-rom  </cite> <a class="comment-date" href="index.html#comment-74867"><time datetime="2014-06-28T08:29:15+00:00">28/06/2014 at 08:29</time></a></header>  <section class="comment-content comment"><p>Wow super Sam ! Ça a de la gueule avec l&#8217;API à la flask et effectivement ça a l&#8217;air super simple.</p>
<p>Je vais attendre que ça mûrisse un peu pour jouer avec en attendant, si jamais ça t&#8217;intéresse, ma config de base c&#8217;est RabbitMQ en broker de message, et stomp.js + sockjs pour le support des vieux navigateurs sans websockets. RabbitMQ a l&#8217;avantage d&#8217;avoir plein de clients dans plein de langages et de supporter (via plugin) STOMP via Websocket. Avec ça c&#8217;est assez simple de faire du PUB/SUB ou du RPC.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-74884">
          
            <article id="comment-74884" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/437805955e9381e69429143c0fc40f6e?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/437805955e9381e69429143c0fc40f6e?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Foxmask  </cite> <a class="comment-date" href="index.html#comment-74884"><time datetime="2014-06-28T08:54:08+00:00">28/06/2014 at 08:54</time></a></header>  <section class="comment-content comment"><p>Question conne : est-ce que ça a du sens d&#8217;utiliser cette techno pour interconnecter des services tiers dont on ne maîtrise pas le moment où les données arrivent? Genre des données tombent dans un flux RSS. Comment en être averti instantanément ?</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-75042">
          
            <article id="comment-75042" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/9fa5b0a6784f7a112a1e2357cd2bdd68?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/9fa5b0a6784f7a112a1e2357cd2bdd68?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">G-rom  </cite> <a class="comment-date" href="index.html#comment-75042"><time datetime="2014-06-28T10:51:55+00:00">28/06/2014 at 10:51</time></a></header>  <section class="comment-content comment"><p>Il te faudra forcément un lecteur de flux qui balance un événement sur un channel auquel une de tes app clientes aura souscrit.</p>
<p>Genre un lecteur robot qui parse les flux des sites à intervalles régulier, ou qui souscrit à des event de ces sites des fois qu&#8217;ils en proposent (hey peut être qu&#8217;un jour ils feront du WAMP aussi de leur côté)</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-75115">
          
            <article id="comment-75115" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-75115"><time datetime="2014-06-28T11:44:43+00:00">28/06/2014 at 11:44</time></a></header>  <section class="comment-content comment"><p>@Foxmask : le RSS est une techno basée sur le polling, donc tu es obligé, comme dit G-ROM, de faire un robot qui tourne en background et vérifie régulièrement tous ces flux. Après, utiliser cette techno va avoir deux avantages : c&#8217;est asynchrone, donc tu peux faire 1000 requêtes à 1000 flux en parallèle, et une fois que tu as l&#8217;info, tu peux la pusher à tous les autres clients en même temps immédiatement.</p>
<p>Typiquement, pour ton trigger happy, ça veut dire que tu peux lancer des triggers non bloquants en même temps, et le premier qui retourne un résultat peut déclencher la propagation du dit résultat à tous les clients.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-foxmask even thread-even depth-1" id="li-comment-75485">
          
            <article id="comment-75485" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/3480a9c496196d62494a68bf1f5cade8?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/3480a9c496196d62494a68bf1f5cade8?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn"><a href='http://www.foxmask.info/' rel='external nofollow' class='url'>foxmask</a>  </cite> <a class="comment-date" href="index.html#comment-75485"><time datetime="2014-06-28T16:24:55+00:00">28/06/2014 at 16:24</time></a></header>  <section class="comment-content comment"><p>Merci sam je mets tout ça de cote .</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-77790">
          
            <article id="comment-77790" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/8a08280bd3253ea6c09aa58ab641b93a?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/8a08280bd3253ea6c09aa58ab641b93a?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn"><a href='http://yopmail.com' rel='external nofollow' class='url'>L'africain</a>  </cite> <a class="comment-date" href="index.html#comment-77790"><time datetime="2014-06-29T21:13:09+00:00">29/06/2014 at 21:13</time></a></header>  <section class="comment-content comment"><p><span class="boulet"></span><code>Les problèmes du tiers monde, c’est du pipi de chat à côté. Ils ont de la chance, eux, ils ne connaissent pas le streaming.</code><br />
On est en 2014 est vous avez toujours des idées aussi arriérée. Bravo! Je suis resté bouche bée aprés cette phrase.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-78237">
          
            <article id="comment-78237" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-78237"><time datetime="2014-06-30T03:11:43+00:00">30/06/2014 at 03:11</time></a></header>  <section class="comment-content comment"><p>On est en 2014, et il y a encore des gens qui ne comprennent pas le second degré. Bravo! Je vous colle un tampon après cette phrase.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-91669">
          
            <article id="comment-91669" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/6623e73a82ab7154d115e8dea296a388?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/6623e73a82ab7154d115e8dea296a388?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">SuzyOne  </cite> <a class="comment-date" href="index.html#comment-91669"><time datetime="2014-07-14T01:22:35+00:00">14/07/2014 at 01:22</time></a></header>  <section class="comment-content comment"><p>Bonjour,</p>
<p>Très bon article, j&#8217;ai néanmoins quelques questions :</p>
<p>&#8211; peut-on utiliser cette récente API (bonne idée) en mode client ? Pour faire du publish vite fait ?</p>
<p>&#8211; est-ce que dans le fichier de configuration de crossbar il ne faut pas mettre plutôt cela &#8220;url&#8221;: &#8220;ws://127.0.0.1:8080/ws&#8221; au lieu de &#8220;url&#8221;: &#8220;ws://127.0.0.1/ws&#8221; ?</p>
<p>Merci.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-92216">
          
            <article id="comment-92216" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-92216"><time datetime="2014-07-15T09:00:26+00:00">15/07/2014 at 09:00</time></a></header>  <section class="comment-content comment"><p>Oui, cette API marche très bien pour une client, il suffit de faire app.run(standalone=False) et le serveur n&#8217;est pas démarré.</p>
<p>Pour le port, je ne suis pas sûr. Je pense que la déclaration de port au dessus est suffisante. A vérifier.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-92431">
          
            <article id="comment-92431" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/3ab22a30b771b30bdb5df114db799eab?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/3ab22a30b771b30bdb5df114db799eab?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sigmun  </cite> <a class="comment-date" href="index.html#comment-92431"><time datetime="2014-07-15T14:58:09+00:00">15/07/2014 at 14:58</time></a></header>  <section class="comment-content comment"><p>Bonjour,<br />
je ne suis pas du tout, mais alors pas du tout web-dev ou sys-admin. Pourtant, il y a une question qui, au risque de vous faire rire (mais bon, si en plus on peut se marrer, c&#8217;est déjà pas mal), me turlupine : est-ce que ca peut servir en remplacement de module python comme Pyro ? Dans mon cas, je me sers de Pyro pour faire du couplage de code, et même si j&#8217;adore, ça me contraint à utiliser du python pour l&#8217;interfaçage. Je me demandais je pouvais pas rendre ça plus souple&#8230;</p>
<p>Sinon, super blog&#8230; Je ne fais que commencer à le défricher, mais je sens que je vais y passer du temps ! (heureusement que j&#8217;ai un collègue dans mon bureau, sinon il n&#8217;y aurait pas que la rubrique &#8220;Programmation&#8221; ;-))</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-92943">
          
            <article id="comment-92943" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-92943"><time datetime="2014-07-16T07:38:26+00:00">16/07/2014 at 07:38</time></a></header>  <section class="comment-content comment"><p>Du couplage de code ?</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-132942">
          
            <article id="comment-132942" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/c491f874a45fa4ee84b102e774939cc8?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/c491f874a45fa4ee84b102e774939cc8?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">zed  </cite> <a class="comment-date" href="index.html#comment-132942"><time datetime="2014-09-04T20:57:05+00:00">04/09/2014 at 20:57</time></a></header>  <section class="comment-content comment"><p>&#8220;Donc mettez votre téléphone en Wifi, par en 3G.&#8221;</p>
<p>pas*</p>
<p>:)</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-141468">
          
            <article id="comment-141468" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/de1f605572566a8254265a37648c9187?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/de1f605572566a8254265a37648c9187?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">keiser1080  </cite> <a class="comment-date" href="index.html#comment-141468"><time datetime="2014-09-27T16:04:16+00:00">27/09/2014 at 16:04</time></a></header>  <section class="comment-content comment"><p>sam,<br />
super tuto domage qu&#8217;il n&#8217;y a pas de publish et suscribe cote python.<br />
l&#8217;API flaskesque est utilisable pour le publish ?<br />
j&#8217;ai chercher app.session pour faire un app.session.publish mais j&#8217;ai pas trouver de doc</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-141472">
          
            <article id="comment-141472" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-141472"><time datetime="2014-09-27T16:13:42+00:00">27/09/2014 at 16:13</time></a></header>  <section class="comment-content comment"><p>Ouai y a l&#8217;api flaskesque maintenant. Faut chercher sur le blog, j&#8217;avais fais un tuto quand c&#8217;est sorti.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-153257">
          
            <article id="comment-153257" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/c1d751e884024f2f360ab9b81f319960?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/c1d751e884024f2f360ab9b81f319960?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Romain  </cite> <a class="comment-date" href="index.html#comment-153257"><time datetime="2014-12-26T00:48:32+00:00">26/12/2014 at 00:48</time></a></header>  <section class="comment-content comment"><p>FYI <a href="https://demo.crossbar.io/videocontrol/" rel="nofollow">https://demo.crossbar.io/videocontrol/</a> 404 :(</p>
<p>(pas besoin de publier ce commentaire)</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-153263">
          
            <article id="comment-153263" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-153263"><time datetime="2014-12-26T06:40:33+00:00">26/12/2014 at 06:40</time></a></header>  <section class="comment-content comment"><p>Je leur ai déjà reporté mais ils s&#8217;en occupent pas. C&#8217;est pour ça qu&#8217;ils ont besoin de quelqu&#8217;un je pense.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-153659">
          
            <article id="comment-153659" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://1.gravatar.com/avatar/41afaccb3615b50575e9df2ad18ddd32?s=80&#038;d=retro&#038;r=x' srcset='http://1.gravatar.com/avatar/41afaccb3615b50575e9df2ad18ddd32?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn"><a href='http://www.expertiz.fr' rel='external nofollow' class='url'>Stef42</a>  </cite> <a class="comment-date" href="index.html#comment-153659"><time datetime="2015-01-06T21:49:26+00:00">06/01/2015 at 21:49</time></a></header>  <section class="comment-content comment"><p>1er post et vraiment merci pour tout ce que vous faites.</p>
<p>J&#8217;ai découvert WAMP grâce la publication des slides.</p>
<p>Désolé, mais pour moi c&#8217;est bluffant !!!</p>
<p>J&#8217;ai réussi à faire tourner la démo non sans mal :</p>
<p>app.py semble ne pas lancer de serveur WAMP. Le programme bloque et CTRL+C indique qu&#8217;il ne peut pas se connecter.<br />
ca fonctionne dès qu&#8217;on lance le routeur <b>crossbar</b> (cf <a href="https://github.com/tavendo/AutobahnPython/issues/304" rel="nofollow">https://github.com/tavendo/AutobahnPython/issues/304</a>)<br />
app.py :</p>
<p><code>app.run(url="ws://localhost:8080/ws")</code></p>
<p>les fichiers HTML : &#8216;:8080/&#8217; remplacé par &#8216;:8080/ws&#8217;</p>
<p>@keiser1080 : le <b>subscribe</b> en Python fonctionne. Mais toujours pas de <b>publish</b>.</p>
<p>app.py :</p>
<p><code></p>
<p>@app.subscribe('lecteur.volume')</p>
<p>def onevent1(x):</p>
<p>print("Volume du lecteur : ", x)</p>
<p></code></p>
<p>index.html : publication d&#8217;un nouveau PUB sans l&#8217;UUID (je ne sais pas comment faire référence à uuid.volume qui existe déjà.</p>
<p><code></p>
<p>session.publish('lecteur.volume', [video.volume]);</p>
<p></code></p>
<p>La classe <b>autobahn.twisted.wamp.Application</b> a pas mal changé.</p>
<p>Et en effet, les exemples fournis ne suivent pas trop le code (je sais c&#8217;est dur :-) )</p>
<p><code>app.run(standalone=False)</code></p>
<p>ne fonctionne plus par exemple.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-153695">
          
            <article id="comment-153695" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-153695"><time datetime="2015-01-07T04:43:17+00:00">07/01/2015 at 04:43</time></a></header>  <section class="comment-content comment"><p>Depuis la rédaction de l&#8217;article, l&#8217;API de crossbar a changé, et le routeur intégré n&#8217;existe plus dans autobahn. Je vais mettre à jour l&#8217;article.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="li-comment-164431">
          
            <article id="comment-164431" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/c676f9efc8e54985e84c044899481267?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/c676f9efc8e54985e84c044899481267?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn"><a href='http://vincent.jousse.org' rel='external nofollow' class='url'>Vincent</a>  </cite> <a class="comment-date" href="index.html#comment-164431"><time datetime="2015-09-16T15:35:58+00:00">16/09/2015 at 15:35</time></a></header>  <section class="comment-content comment"><p><span class="merci"></span>Yop yop,</p>
<p>Juste un truc, j&#8217;ai un peu galéré à faire fonctionner l&#8217;exemple. J&#8217;ai du rajouter /ws dans le app.run :</p>
<p>app.run(url=u&#8221;ws://localhost:8080/ws&#8221;)</p>
<p>Et dans le coup idem dans le JS aussi :</p>
<p>url: &#8216;ws://&#8217; + window.location.hostname + &#8216;:8080/ws&#8217;,</p>
<p>Est-ce que j&#8217;ai loupé quelque chose ou est-ce qu&#8217;il faut mettre l&#8217;article à jour ? :)</p>
<p>Merci en tout cas !</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-164439">
          
            <article id="comment-164439" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://0.gravatar.com/avatar/c676f9efc8e54985e84c044899481267?s=80&#038;d=retro&#038;r=x' srcset='http://0.gravatar.com/avatar/c676f9efc8e54985e84c044899481267?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn"><a href='http://vincent.jousse.org' rel='external nofollow' class='url'>Vincent</a>  </cite> <a class="comment-date" href="index.html#comment-164439"><time datetime="2015-09-16T20:09:57+00:00">16/09/2015 at 20:09</time></a></header>  <section class="comment-content comment"><p>Sans vouloir être pénible, je pense que t&#8217;as oublié de modifier le code de la télécommande :-)</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
        <li class="comment byuser comment-author-sam bypostauthor even thread-even depth-1" id="li-comment-164441">
          
            <article id="comment-164441" class="comment"><div class="row-fluid"><div class="comment-avatar span2"><img alt='' src='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=80&#038;d=retro&#038;r=x' srcset='http://2.gravatar.com/avatar/bf9ecde8f5e286de6ce5c80206cf9dd6?s=160&#038;d=retro&#038;r=x 2x' class='avatar avatar-80 photo' height='80' width='80' /></div><div class="span10"> <header class="comment-meta comment-author vcard"><cite class="fn">Sam <span> Post author</span> </cite> <a class="comment-date" href="index.html#comment-164441"><time datetime="2015-09-16T20:50:22+00:00">16/09/2015 at 20:50</time></a></header>  <section class="comment-content comment"><p>Au contraire, au contraire, tu m&#8217;aides beaucoup. J&#8217;ai tellement d&#8217;articles sur le blog, sans l&#8217;aide des lectures ils seraient tous complètement inutiles.</p>
</section></div></div></article>          <!-- #comment-## -->
        </li><!-- #comment-## -->
              </ul><!-- .commentlist -->
            <p class="nocomments">Comments are closed.</p></div><!-- #comments .comments-area -->


<div class="ie-comment">
Des questions Python sans rapport avec l'article ? Posez-les sur <a href="http://indexerror.net">IndexError</a>.

</div>
        
          <hr class="featurette-divider __after_loop">
          <nav id="nav-below" class="navigation" role="navigation">

              <h3 class="assistive-text">
                Post navigation              </h3>

              <ul class="pager">
                                  <li class="previous">
                    <span class="nav-previous">
                      <a href="../dune-base-a-lautre-en-python/index.html" rel="prev"><span class="meta-nav">&larr;</span> D&#8217;une base à l&#8217;autre en Python</a>                    </span>
                  </li>
                                                  <li class="next">
                    <span class="nav-next">
                        <a href="../la-fin-de-lere-du-spam-de-sites-pornos/index.html" rel="next">La fin de l&#8217;ère du spam de sites pornos <span class="meta-nav">&rarr;</span></a>                    </span>
                  </li>
                              </ul>

          </nav><!-- #nav-below .navigation -->

        
        
                </div><!--.article-container -->

                    
        <div class="span3 right tc-sidebar">
           <div id="right" class="widget-area" role="complementary">
                                                      <aside id="text-9" class="widget widget_text">			<div class="textwidget"><p style="font-size:1.3em"><a href="../mais-ou-je-suis-tombee-la/index.html">Mais où je suis tombé(e) là ?</a></p></div>
		</aside><aside id="text-7" class="widget widget_text">			<div class="textwidget"><img src="http://www.adobe.com/images/pdficon_small.png" width="16" height="16"/> <a href="http://pdfcrowd.com/url_to_pdf/">Télécharger cette page en PDF</a> </div>
		</aside><aside id="text-4" class="widget widget_text">			<div class="textwidget"><br><br><a href="../appel-a-contributeurs-impertinents/index.html"><img src="../wp-content/uploads/2012/07/contributeur.png" width="288px" style="vertical-align: middle;margin-top:-40px;margin-bottom:10px;"></a> </div>
		</aside><aside id="blog_subscription-4" class="widget jetpack_subscription_widget"><h3 class="widget-title">Souscrire à nos conneries</h3>
			<form action="index.html%3Fshare=email.html#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-4">
				<div id="subscribe-text"><p>Entrez votre adresse mail et vous recevrez une notification à chaque nouvel article.</p>
</div><p>Join 1,492 other subscribers</p>
					<p id="subscribe-email">
						<label id="jetpack-subscribe-label" for="subscribe-field-blog_subscription-4">
							Email Address						</label>
						<input type="email" name="email" required="required" class="required" value="" id="subscribe-field-blog_subscription-4" placeholder="Email Address" />
					</p>

					<p id="subscribe-submit">
						<input type="hidden" name="action" value="subscribe" />
						<input type="hidden" name="source" value="http://sametmax.com/introduction-a-wamp-en-python/?shared=email&#038;msg=fail" />
						<input type="hidden" name="sub-type" value="widget" />
						<input type="hidden" name="redirect_fragment" value="blog_subscription-4" />
												<input type="submit" value="J&#039;adhère, bon dieu !" name="jetpack_subscriptions_widget" />
					</p>
							</form>

			<script>
			/*
			Custom functionality for safari and IE
			 */
			(function( d ) {
				// In case the placeholder functionality is available we remove labels
				if ( ( 'placeholder' in d.createElement( 'input' ) ) ) {
					var label = d.querySelector( 'label[for=subscribe-field-blog_subscription-4]' );
						label.style.clip 	 = 'rect(1px, 1px, 1px, 1px)';
						label.style.position = 'absolute';
						label.style.height   = '1px';
						label.style.width    = '1px';
						label.style.overflow = 'hidden';
				}

				// Make sure the email value is filled in before allowing submit
				var form = d.getElementById('subscribe-blog-blog_subscription-4'),
					input = d.getElementById('subscribe-field-blog_subscription-4'),
					handler = function( event ) {
						if ( '' === input.value ) {
							input.focus();

							if ( event.preventDefault ){
								event.preventDefault();
							}

							return false;
						}
					};

				if ( window.addEventListener ) {
					form.addEventListener( 'submit', handler, false );
				} else {
					form.attachEvent( 'onsubmit', handler );
				}
			})( document );
			</script>
				
</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h3 class="widget-title">TagCloud</h3><div class="tagcloud"><a href="../tag/0bin/index.html" class="tag-cloud-link tag-link-148 tag-link-position-1" style="font-size: 9.04pt;" aria-label="0bin (11 items)">0bin</a>
<a href="../tag/angularjs/index.html" class="tag-cloud-link tag-link-443 tag-link-position-2" style="font-size: 8.4pt;" aria-label="angularjs (9 items)">angularjs</a>
<a href="../tag/asyncio/index.html" class="tag-cloud-link tag-link-922 tag-link-position-3" style="font-size: 9.04pt;" aria-label="asyncio (11 items)">asyncio</a>
<a href="../tag/autobahn/index.html" class="tag-cloud-link tag-link-979 tag-link-position-4" style="font-size: 8.4pt;" aria-label="autobahn (9 items)">autobahn</a>
<a href="../tag/bash/index.html" class="tag-cloud-link tag-link-14 tag-link-position-5" style="font-size: 10.8pt;" aria-label="bash (19 items)">bash</a>
<a href="../tag/bitcoin/index.html" class="tag-cloud-link tag-link-320 tag-link-position-6" style="font-size: 8.4pt;" aria-label="bitcoin (9 items)">bitcoin</a>
<a href="../tag/blog/index.html" class="tag-cloud-link tag-link-107 tag-link-position-7" style="font-size: 11.84pt;" aria-label="blog (26 items)">blog</a>
<a href="../tag/cache/index.html" class="tag-cloud-link tag-link-333 tag-link-position-8" style="font-size: 8.72pt;" aria-label="cache (10 items)">cache</a>
<a href="../tag/comprehension-lists/index.html" class="tag-cloud-link tag-link-20 tag-link-position-9" style="font-size: 8pt;" aria-label="comprehension-lists (8 items)">comprehension-lists</a>
<a href="../tag/crossbar/index.html" class="tag-cloud-link tag-link-1046 tag-link-position-10" style="font-size: 8.4pt;" aria-label="crossbar (9 items)">crossbar</a>
<a href="../tag/css/index.html" class="tag-cloud-link tag-link-188 tag-link-position-11" style="font-size: 8.4pt;" aria-label="css (9 items)">css</a>
<a href="../tag/cul-2/index.html" class="tag-cloud-link tag-link-33 tag-link-position-12" style="font-size: 9.28pt;" aria-label="cul (12 items)">cul</a>
<a href="../tag/dict/index.html" class="tag-cloud-link tag-link-435 tag-link-position-13" style="font-size: 8pt;" aria-label="dict (8 items)">dict</a>
<a href="../tag/django/index.html" class="tag-cloud-link tag-link-28 tag-link-position-14" style="font-size: 16pt;" aria-label="django (89 items)">django</a>
<a href="../tag/don/index.html" class="tag-cloud-link tag-link-1210 tag-link-position-15" style="font-size: 10.48pt;" aria-label="don (17 items)">don</a>
<a href="../tag/encoding/index.html" class="tag-cloud-link tag-link-54 tag-link-position-16" style="font-size: 8.72pt;" aria-label="encoding (10 items)">encoding</a>
<a href="../tag/git/index.html" class="tag-cloud-link tag-link-18 tag-link-position-17" style="font-size: 12.88pt;" aria-label="git (35 items)">git</a>
<a href="../tag/http/index.html" class="tag-cloud-link tag-link-204 tag-link-position-18" style="font-size: 9.6pt;" aria-label="http (13 items)">http</a>
<a href="../tag/import/index.html" class="tag-cloud-link tag-link-215 tag-link-position-19" style="font-size: 8.4pt;" aria-label="import (9 items)">import</a>
<a href="../tag/ipython/index.html" class="tag-cloud-link tag-link-164 tag-link-position-20" style="font-size: 8.72pt;" aria-label="ipython (10 items)">ipython</a>
<a href="../tag/iterable/index.html" class="tag-cloud-link tag-link-217 tag-link-position-21" style="font-size: 9.84pt;" aria-label="iterable (14 items)">iterable</a>
<a href="../tag/javascript/index.html" class="tag-cloud-link tag-link-96 tag-link-position-22" style="font-size: 14.08pt;" aria-label="javascript (50 items)">javascript</a>
<a href="../tag/jquery/index.html" class="tag-cloud-link tag-link-112 tag-link-position-23" style="font-size: 8pt;" aria-label="jquery (8 items)">jquery</a>
<a href="../tag/linux/index.html" class="tag-cloud-link tag-link-238 tag-link-position-24" style="font-size: 9.04pt;" aria-label="linux (11 items)">linux</a>
<a href="../tag/meta/index.html" class="tag-cloud-link tag-link-102 tag-link-position-25" style="font-size: 17.52pt;" aria-label="meta (138 items)">meta</a>
<a href="../tag/mysql/index.html" class="tag-cloud-link tag-link-82 tag-link-position-26" style="font-size: 8pt;" aria-label="mysql (8 items)">mysql</a>
<a href="../tag/nginx/index.html" class="tag-cloud-link tag-link-183 tag-link-position-27" style="font-size: 9.84pt;" aria-label="nginx (14 items)">nginx</a>
<a href="../tag/nsfw/index.html" class="tag-cloud-link tag-link-319 tag-link-position-28" style="font-size: 9.84pt;" aria-label="nsfw (14 items)">nsfw</a>
<a href="../tag/pep8/index.html" class="tag-cloud-link tag-link-552 tag-link-position-29" style="font-size: 8pt;" aria-label="pep8 (8 items)">pep8</a>
<a href="../tag/pip/index.html" class="tag-cloud-link tag-link-344 tag-link-position-30" style="font-size: 8.72pt;" aria-label="pip (10 items)">pip</a>
<a href="../tag/poo/index.html" class="tag-cloud-link tag-link-549 tag-link-position-31" style="font-size: 10pt;" aria-label="poo (15 items)">poo</a>
<a href="../tag/python/index.html" class="tag-cloud-link tag-link-4 tag-link-position-32" style="font-size: 22pt;" aria-label="python (496 items)">python</a>
<a href="../tag/python-3/index.html" class="tag-cloud-link tag-link-365 tag-link-position-33" style="font-size: 8.4pt;" aria-label="python 3 (9 items)">python 3</a>
<a href="../tag/redis/index.html" class="tag-cloud-link tag-link-196 tag-link-position-34" style="font-size: 8.72pt;" aria-label="redis (10 items)">redis</a>
<a href="../tag/ruby/index.html" class="tag-cloud-link tag-link-325 tag-link-position-35" style="font-size: 8pt;" aria-label="ruby (8 items)">ruby</a>
<a href="../tag/shell/index.html" class="tag-cloud-link tag-link-202 tag-link-position-36" style="font-size: 8.72pt;" aria-label="shell (10 items)">shell</a>
<a href="../tag/sublime-text/index.html" class="tag-cloud-link tag-link-76 tag-link-position-37" style="font-size: 8.4pt;" aria-label="sublime text (9 items)">sublime text</a>
<a href="../tag/ubuntu/index.html" class="tag-cloud-link tag-link-255 tag-link-position-38" style="font-size: 10.24pt;" aria-label="ubuntu (16 items)">ubuntu</a>
<a href="../tag/unicode/index.html" class="tag-cloud-link tag-link-53 tag-link-position-39" style="font-size: 8.4pt;" aria-label="unicode (9 items)">unicode</a>
<a href="../tag/unit-tests/index.html" class="tag-cloud-link tag-link-302 tag-link-position-40" style="font-size: 8.72pt;" aria-label="unit tests (10 items)">unit tests</a>
<a href="../tag/unpacking/index.html" class="tag-cloud-link tag-link-180 tag-link-position-41" style="font-size: 8pt;" aria-label="unpacking (8 items)">unpacking</a>
<a href="../tag/virtualenv/index.html" class="tag-cloud-link tag-link-259 tag-link-position-42" style="font-size: 9.04pt;" aria-label="virtualenv (11 items)">virtualenv</a>
<a href="../tag/wamp/index.html" class="tag-cloud-link tag-link-1039 tag-link-position-43" style="font-size: 10pt;" aria-label="wamp (15 items)">wamp</a>
<a href="../tag/web-2/index.html" class="tag-cloud-link tag-link-758 tag-link-position-44" style="font-size: 8pt;" aria-label="web (8 items)">web</a>
<a href="../tag/yield/index.html" class="tag-cloud-link tag-link-287 tag-link-position-45" style="font-size: 8.4pt;" aria-label="yield (9 items)">yield</a></div>
</aside><aside id="text-5" class="widget widget_text"><h3 class="widget-title"> Envoyez des sioux</h3>			<div class="textwidget"><p><img src="../wp-content/uploads/2013/07/bitcoin.png" width="16" height="16"/> On adooooore les bitcoins :</p>

<p>

<a href="bitcoin:19zAHPPuce4BAhsdy9KaFwVLurEJXMhMAn?amount=1X8&label=SamEtMax">19zAHPPuce4BAhsdy9KaFwVLurEJXMhMAn</a>

</p></div>
		</aside><aside id="nav_menu-3" class="widget widget_nav_menu"><h3 class="widget-title">Nos projets</h3><div class="menu-nos-projets-container"><ul id="menu-nos-projets" class="menu"><li id="menu-item-15841" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15841"><a href="http://multiboards.net/">Multiboards &#8211; l&#8217;actu geek fr en une page</a></li>
<li id="menu-item-15837" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15837"><a href="http://0bin.net">0bin &#8211; le pastebin chiffré</a></li>
<li id="menu-item-15838" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15838"><a href="http://allthatcounts.net">All that counts &#8211; compteur pour jeux</a></li>
<li id="menu-item-15839" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15839"><a href="https://github.com/sametmax/django-quicky">Django quicky &#8211; quick views for Django</a></li>
<li id="menu-item-15840" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15840"><a href="https://github.com/sametmax/VizHash.js">VizHash.js &#8211; Hash visuels</a></li>
<li id="menu-item-15842" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15842"><a href="https://github.com/sametmax/codes-des-articles">Code des articles du blog</a></li>
</ul></div></aside><aside id="text-11" class="widget widget_text"><h3 class="widget-title"> </h3>			<div class="textwidget"> </div>
		</aside><aside id="meta-3" class="widget widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="../wp-login.php.html">Log in</a></li>
			<li><a href="../feed.1">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="../comments/feed/index.html">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
			</aside>                                              </div><!-- #left or #right-->
        </div><!--.tc-sidebar -->

        
        </div><!--.row -->
    </div><!-- .container role: main -->

    
</div><!--#main-wrapper"-->

		<!-- FOOTER -->
		<footer id="footer" class="">
		 					<div class="container footer-widgets ">
					<div class="row widget-area" role="complementary">
												
							<div id="footer_one" class="span4">
																
										<aside id="nav_menu-2" class="widget widget_nav_menu"><h3 class="widget-title">Hors du blog</h3><div class="menu-bottom-menu-container"><ul id="menu-bottom-menu" class="menu"><li id="menu-item-2391" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2391"><a href="../contactez-nous/index.html">Page de contact</a></li>
<li id="menu-item-12230" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12230"><a href="http://twitter.com/sam_et_max">@sam_et_max sur twitter</a></li>
<li id="menu-item-12285" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12285"><a href="http://bridge.suumitsu.eu/?action=display&#038;bridge=TwitterBridge&#038;u=sam_et_max&#038;format=AtomFormat">Nos tweets en RSS</a></li>
<li id="menu-item-12231" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12231"><a href="https://github.com/sametmax/">Fork me, I&#8217;m famous (github)</a></li>
</ul></div></aside>
																							</div><!-- .{$key}_widget_class -->

						
							<div id="footer_two" class="span4">
																
										<aside id="text-8" class="widget widget_text">			<div class="textwidget">Tous les textes de ce blog, sauf signalement contraire, sont sous licence <a href="http://creativecommons.org/licenses/by/3.0/">creative common 3.0 unported</a>.</div>
		</aside>
																							</div><!-- .{$key}_widget_class -->

						
							<div id="footer_three" class="span4">
																
										<aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Toi aussi, trouve un article obsolète sur notre blog</h3>		<ul>
			<li><a href='../2019/09/index.html'>September 2019</a>&nbsp;(1)</li>
	<li><a href='../2019/06/index.html'>June 2019</a>&nbsp;(1)</li>
	<li><a href='../2019/02/index.html'>February 2019</a>&nbsp;(1)</li>
	<li><a href='../2019/01/index.html'>January 2019</a>&nbsp;(3)</li>
	<li><a href='../2018/12/index.html'>December 2018</a>&nbsp;(1)</li>
	<li><a href='../2018/09/index.html'>September 2018</a>&nbsp;(2)</li>
	<li><a href='../2018/08/index.html'>August 2018</a>&nbsp;(1)</li>
	<li><a href='../2018/07/index.html'>July 2018</a>&nbsp;(3)</li>
	<li><a href='../2018/06/index.html'>June 2018</a>&nbsp;(4)</li>
	<li><a href='../2018/05/index.html'>May 2018</a>&nbsp;(2)</li>
	<li><a href='../2018/03/index.html'>March 2018</a>&nbsp;(2)</li>
	<li><a href='../2018/02/index.html'>February 2018</a>&nbsp;(1)</li>
	<li><a href='../2017/12/index.html'>December 2017</a>&nbsp;(4)</li>
	<li><a href='../2017/11/index.html'>November 2017</a>&nbsp;(5)</li>
	<li><a href='../2017/10/index.html'>October 2017</a>&nbsp;(2)</li>
	<li><a href='../2017/09/index.html'>September 2017</a>&nbsp;(1)</li>
	<li><a href='../2017/07/index.html'>July 2017</a>&nbsp;(5)</li>
	<li><a href='../2017/06/index.html'>June 2017</a>&nbsp;(3)</li>
	<li><a href='../2017/05/index.html'>May 2017</a>&nbsp;(3)</li>
	<li><a href='../2017/04/index.html'>April 2017</a>&nbsp;(2)</li>
	<li><a href='../2017/03/index.html'>March 2017</a>&nbsp;(3)</li>
	<li><a href='../2017/02/index.html'>February 2017</a>&nbsp;(5)</li>
	<li><a href='../2017/01/index.html'>January 2017</a>&nbsp;(5)</li>
	<li><a href='../2016/10/index.html'>October 2016</a>&nbsp;(2)</li>
	<li><a href='../2016/09/index.html'>September 2016</a>&nbsp;(5)</li>
	<li><a href='../2016/08/index.html'>August 2016</a>&nbsp;(2)</li>
	<li><a href='../2016/03/index.html'>March 2016</a>&nbsp;(8)</li>
	<li><a href='../2016/02/index.html'>February 2016</a>&nbsp;(9)</li>
	<li><a href='../2016/01/index.html'>January 2016</a>&nbsp;(16)</li>
	<li><a href='../2015/12/index.html'>December 2015</a>&nbsp;(6)</li>
	<li><a href='../2015/11/index.html'>November 2015</a>&nbsp;(7)</li>
	<li><a href='../2015/10/index.html'>October 2015</a>&nbsp;(2)</li>
	<li><a href='../2015/09/index.html'>September 2015</a>&nbsp;(6)</li>
	<li><a href='../2015/08/index.html'>August 2015</a>&nbsp;(10)</li>
	<li><a href='../2015/07/index.html'>July 2015</a>&nbsp;(18)</li>
	<li><a href='../2015/06/index.html'>June 2015</a>&nbsp;(13)</li>
	<li><a href='../2015/05/index.html'>May 2015</a>&nbsp;(12)</li>
	<li><a href='../2015/04/index.html'>April 2015</a>&nbsp;(13)</li>
	<li><a href='../2015/03/index.html'>March 2015</a>&nbsp;(8)</li>
	<li><a href='../2015/02/index.html'>February 2015</a>&nbsp;(4)</li>
	<li><a href='../2015/01/index.html'>January 2015</a>&nbsp;(21)</li>
	<li><a href='../2014/12/index.html'>December 2014</a>&nbsp;(24)</li>
	<li><a href='../2014/11/index.html'>November 2014</a>&nbsp;(6)</li>
	<li><a href='../2014/10/index.html'>October 2014</a>&nbsp;(18)</li>
	<li><a href='../2014/09/index.html'>September 2014</a>&nbsp;(10)</li>
	<li><a href='../2014/08/index.html'>August 2014</a>&nbsp;(5)</li>
	<li><a href='../2014/07/index.html'>July 2014</a>&nbsp;(11)</li>
	<li><a href='../2014/06/index.html'>June 2014</a>&nbsp;(25)</li>
	<li><a href='../2014/05/index.html'>May 2014</a>&nbsp;(14)</li>
	<li><a href='../2014/04/index.html'>April 2014</a>&nbsp;(10)</li>
	<li><a href='../2014/03/index.html'>March 2014</a>&nbsp;(23)</li>
	<li><a href='../2014/02/index.html'>February 2014</a>&nbsp;(27)</li>
	<li><a href='../2014/01/index.html'>January 2014</a>&nbsp;(17)</li>
	<li><a href='../2013/12/index.html'>December 2013</a>&nbsp;(27)</li>
	<li><a href='../2013/11/index.html'>November 2013</a>&nbsp;(25)</li>
	<li><a href='../2013/10/index.html'>October 2013</a>&nbsp;(27)</li>
	<li><a href='../2013/09/index.html'>September 2013</a>&nbsp;(1)</li>
	<li><a href='../2013/08/index.html'>August 2013</a>&nbsp;(31)</li>
	<li><a href='../2013/07/index.html'>July 2013</a>&nbsp;(32)</li>
	<li><a href='../2013/06/index.html'>June 2013</a>&nbsp;(24)</li>
	<li><a href='../2013/05/index.html'>May 2013</a>&nbsp;(30)</li>
	<li><a href='../2013/04/index.html'>April 2013</a>&nbsp;(31)</li>
	<li><a href='../2013/03/index.html'>March 2013</a>&nbsp;(33)</li>
	<li><a href='../2013/02/index.html'>February 2013</a>&nbsp;(29)</li>
	<li><a href='../2013/01/index.html'>January 2013</a>&nbsp;(34)</li>
	<li><a href='../2012/12/index.html'>December 2012</a>&nbsp;(32)</li>
	<li><a href='../2012/11/index.html'>November 2012</a>&nbsp;(36)</li>
	<li><a href='../2012/10/index.html'>October 2012</a>&nbsp;(35)</li>
	<li><a href='../2012/09/index.html'>September 2012</a>&nbsp;(36)</li>
	<li><a href='../2012/08/index.html'>August 2012</a>&nbsp;(37)</li>
	<li><a href='../2012/07/index.html'>July 2012</a>&nbsp;(33)</li>
	<li><a href='../2012/06/index.html'>June 2012</a>&nbsp;(24)</li>
	<li><a href='../2012/05/index.html'>May 2012</a>&nbsp;(31)</li>
	<li><a href='../2012/04/index.html'>April 2012</a>&nbsp;(20)</li>
	<li><a href='../2012/03/index.html'>March 2012</a>&nbsp;(10)</li>
	<li><a href='../2012/02/index.html'>February 2012</a>&nbsp;(14)</li>
		</ul>
		</aside>
																							</div><!-- .{$key}_widget_class -->

																	</div><!-- .row.widget-area -->
				</div><!--.footer-widgets -->
				    				 <div class="colophon">
			 	<div class="container">
			 		<div class="row-fluid">
					    <div class="span4 social-block pull-left"><span class="tc-footer-social-links-wrapper" ><a class="social-icon icon-feed" href="../feed/rss/index.html" title="Subscribe to my rss feed"  ></a></span></div><div class="span4 credits"><p>&middot; &copy; 2019 <a href="../index.html" title="Sam &amp; Max" rel="bookmark">Sam &amp; Max</a> &middot; Designed by <a href="http://themesandco.com/">Themes &amp; Co</a> &middot;</p></div><div class="span4 backtop"><p class="pull-right"><a class="back-to-top" href="index.html%3Fshare=email.html#">Back to top</a></p></div>	      			</div><!-- .row-fluid -->
	      		</div><!-- .container -->
	      	</div><!-- .colophon -->
	    			</footer>
			<div style="display:none">
	<div class="grofile-hash-map-bf9ecde8f5e286de6ce5c80206cf9dd6">
	</div>
	<div class="grofile-hash-map-487750895a0fd37853339de694fba9f8">
	</div>
	<div class="grofile-hash-map-d44cf7963dab7c8d2149a009bc2b9034">
	</div>
	<div class="grofile-hash-map-bf9ecde8f5e286de6ce5c80206cf9dd6">
	</div>
	<div class="grofile-hash-map-b022fb204b6774a99df43d5bb849401c">
	</div>
	<div class="grofile-hash-map-7144c4c992d3b0b2e69a83834270cb98">
	</div>
	<div class="grofile-hash-map-647dae215d91b81bb1b5da30d6990302">
	</div>
	<div class="grofile-hash-map-41af3de7bb133d9832974dd67cf4c6ed">
	</div>
	<div class="grofile-hash-map-c87ca92e43cff2f1e859384ab6e52a02">
	</div>
	<div class="grofile-hash-map-b4afa6a51d1186fd941a44b68b775983">
	</div>
	<div class="grofile-hash-map-7cedcd5fe799f836e4ea4f9560e873d0">
	</div>
	<div class="grofile-hash-map-9fa5b0a6784f7a112a1e2357cd2bdd68">
	</div>
	<div class="grofile-hash-map-437805955e9381e69429143c0fc40f6e">
	</div>
	<div class="grofile-hash-map-3480a9c496196d62494a68bf1f5cade8">
	</div>
	<div class="grofile-hash-map-8a08280bd3253ea6c09aa58ab641b93a">
	</div>
	<div class="grofile-hash-map-98b2c9ac771203d02c6fef55fa355a63">
	</div>
	<div class="grofile-hash-map-3ab22a30b771b30bdb5df114db799eab">
	</div>
	<div class="grofile-hash-map-c491f874a45fa4ee84b102e774939cc8">
	</div>
	<div class="grofile-hash-map-de1f605572566a8254265a37648c9187">
	</div>
	<div class="grofile-hash-map-c1d751e884024f2f360ab9b81f319960">
	</div>
	<div class="grofile-hash-map-41afaccb3615b50575e9df2ad18ddd32">
	</div>
	<div class="grofile-hash-map-c676f9efc8e54985e84c044899481267">
	</div>
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"http:\/\/sametmax.com\/introduction-a-wamp-en-python\/":11146};
	</script>
			<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
			<div id="fb-root"></div>
			<script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&appId=249643311490&version=v2.3'; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script>
			<script>
			jQuery( document.body ).on( 'post-load', function() {
				if ( 'undefined' !== typeof FB ) {
					FB.XFBML.parse();
				}
			} );
			</script>
						<script>
			function renderGooglePlus1() {
				if ( 'undefined' === typeof gapi ) {
					return;
				}

				jQuery( '.g-plus' ).each(function() {
					var $button = jQuery( this );

					if ( ! $button.data( 'gplus-rendered' ) ) {
						gapi.plusone.render( this, {
							href: $button.attr( 'data-href' ),
							size: $button.attr( 'data-size' ),
							annotation: $button.attr( 'data-annotation' )
						});

						$button.data( 'gplus-rendered', true );
					}
				});
			}

			(function() {
				var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
				po.src = 'https://apis.google.com/js/platform.js';
				po.innerHTML = '{"parsetags": "explicit"}';
				po.onload = renderGooglePlus1;
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
			})();

			jQuery( document.body ).on( 'post-load', renderGooglePlus1 );
			</script>
				<div id="sharing_email" style="display: none;">
		<form action="index.html%3Fshare=email.html" method="post">
			<label for="target_email">Send to Email Address</label>
			<input type="email" name="target_email" id="target_email" value="" />

			
				<label for="source_name">Your Name</label>
				<input type="text" name="source_name" id="source_name" value="" />

				<label for="source_email">Your Email Address</label>
				<input type="email" name="source_email" id="source_email" value="" />

						<input type="text" id="jetpack-source_f_name" name="source_f_name" class="input" value="" size="25" autocomplete="off" title="This field is for validation and should not be changed" />
			
			<img style="float: right; display: none" class="loading" src="../wp-content/plugins/jetpack/modules/sharedaddy/images/loading.gif" alt="loading" width="16" height="16" />
			<input type="submit" value="Send Email" class="sharing_send" />
			<a rel="nofollow" href="index.html%3Fshare=email.html#cancel" class="sharing_cancel">Cancel</a>

			<div class="errors errors-1" style="display: none;">
				Post was not sent - check your email addresses!			</div>

			<div class="errors errors-2" style="display: none;">
				Email check failed, please try again			</div>

			<div class="errors errors-3" style="display: none;">
				Sorry, your blog cannot share posts by email.			</div>
		</form>
	</div>
					<script type="text/javascript">
				// Pinterest shared resources
				var s = document.createElement("script");
				s.type = "text/javascript";
				s.async = true;
				s.setAttribute('data-pin-hover', true);				s.src = window.location.protocol + "//assets.pinterest.com/js/pinit.js";
				var x = document.getElementsByTagName("script")[0];
				x.parentNode.insertBefore(s, x);
				// if 'Pin it' button has 'counts' make container wider
				jQuery(window).load( function(){ jQuery( 'li.share-pinterest a span:visible' ).closest( '.share-pinterest' ).width( '80px' ); } );
			</script>
		<script type="text/javascript" src="https://platform.tumblr.com/v1/share.js"></script>		<script>
		// Don't use Pocket's default JS as it we need to force init new Pocket share buttons loaded via JS.
		function jetpack_sharing_pocket_init() {
			jQuery.getScript( 'https://widgets.getpocket.com/v1/j/btn.js?v=1' );
		}
		jQuery( document ).ready( jetpack_sharing_pocket_init );
		jQuery( document.body ).on( 'post-load', jetpack_sharing_pocket_init );
		</script>
		<script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"http:\/\/sametmax.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}}};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/plugins/contact-form-7/includes/js/scripts.js%3Fver=5.0.2'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201936'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var pollsL10n = {"ajax_url":"http:\/\/sametmax.com\/wp-admin\/admin-ajax.php","text_wait":"Your last request is still being processed. Please wait a while ...","text_valid":"Please choose a valid poll answer.","text_multiple":"Maximum number of choices allowed: ","show_loading":"1","show_fading":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/plugins/wp-polls/polls-js.js%3Fver=2.73.8'></script>
<script type='text/javascript' src='../wp-content/plugins/wp-syntax/js/wp-syntax.js%3Fver=1.1'></script>
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=2019Sepaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/plugins/jetpack/modules/wpgroho.js%3Fver=4.9.7'></script>
<script type='text/javascript' src='../wp-includes/js/comment-reply.min.js%3Fver=4.9.7'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/ui/core.min.js%3Fver=1.11.4'></script>
<script type='text/javascript' src='../wp-content/themes/customizr/inc/assets/js/modernizr.min.js%3Fver=3.2.10'></script>
<script type='text/javascript' src='../wp-content/themes/customizr/inc/assets/js/retina.min.js%3Fver=3.2.10'></script>
<script type='text/javascript' src='../wp-includes/js/wp-embed.min.js%3Fver=4.9.7'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js%3Fver=6.3.2'></script>
<script type='text/javascript'>
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-facebook', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
</script>
<script type='text/javascript' src='https://stats.wp.com/e-201936.js' async='async' defer='defer'></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:6.3.2',blog:'32490438',post:'11146',tz:'0',srv:'sametmax.com'} ]);
	_stq.push([ 'clickTrackerInit', '32490438', '11146' ]);
</script>
<div class="tc-btt-wrapper"><i class="btt-arrow" style="color:#394143"></i></div>	</body>
	</html>