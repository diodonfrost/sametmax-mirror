<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" >

<channel>
	<title>angularjs &#8211; Sam &amp; Max</title>
	<atom:link href="http://sametmax.com/tag/angularjs/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Thu, 05 Sep 2019 08:22:03 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.9.7</generator>
<site xmlns="com-wordpress:feed-additions:1">32490438</site>	<item>
		<title>La mort du tuto angular</title>
		<link>http://sametmax.com/la-mort-du-tuto-angular/</link>
		<comments>http://sametmax.com/la-mort-du-tuto-angular/#comments</comments>
		<pubDate>Sun, 14 Jun 2015 18:25:29 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Philo et culture]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[javascript]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=16389</guid>
		<description><![CDATA[<a href="http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/">J'avais demandé</a> si il y avait encore des gens intéressés par le <a href="http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-2/">tuto angularjs</a> que j'avais commencé. En effet les ressources sur Angular sont généralement de mauvaise qualité, et la réponse avait été un gros OUI.]]></description>
				<content:encoded><![CDATA[<p><a href="http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/">J&#8217;avais demandé</a> si il y avait encore des gens intéressés par le <a href="http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-2/">tuto angularjs</a> que j&#8217;avais commencé. En effet les ressources sur Angular sont généralement de mauvaise qualité, et la réponse avait été un gros OUI.</p>
<p>Je m&#8217;étais donc mis en tête de continuer. Malgré <a href="https://www.youtube.com/watch?v=KJ_xAwSeFR8">la mort annoncée du framework</a>. Malgré <a href="http://www.i-programmer.info/news/167-javascript/7932-angularjs-20-is-radically-different-.html">une V2 qui va tout casser</a>.</p>
<p>Voyez-vous, j&#8217;aime Angular. Bien que je pense que pour des grosses apps une approche comme ReactJS + BackboneJS est plus saine, pour une petit app rapide ou du prototypage c&#8217;est très productif et pratique.</p>
<p>En plus, je n&#8217;aime vraiment pas manquer à mes engagements, et en presque 3 ans de ce blog, je les ai tenu. J&#8217;ai toujours publié les articles promis. Toujours répondu aux mails. Parfois avec des mois de retard, certes, mais je n&#8217;ai signé aucun contrat moral sur les deadlines :)</p>
<p>Je vais néanmoins faire une exception ici et envoyer le tuto Angular au cimetière. Toute mes excuses à ceux qui l&#8217;attendaient.</p>
<p>Bien sûr il y a le fait que j&#8217;ai beaucoup de travail. Cependant si c&#8217;était la cause principale je n&#8217;écrirais plus ici car ça me demande des heures et des heures chaque semaine.</p>
<p>C&#8217;est surtout qu&#8217;il se trouve que j&#8217;avorte régulièrement des tentatives de retravailler dessus. C&#8217;est un signe de manque de motivation certain, et je viens d&#8217;en comprendre aujourd&#8217;hui la raison : c&#8217;est du Javascript.</p>
<p>Jusqu&#8217;ici le blog s&#8217;était autorisé régulièrement des sorties de la ligne éditoriale, mais un tel travail, un guide complet sur Angular, enterine le JS comme un sujet majeur du site.</p>
<p>Or ce n&#8217;est pas le cas.</p>
<p><a href="http://sametmax.com/un-gros-troll-de-plus-sur-javacscript/">Je n&#8217;aime pas Javascript.</a></p>
<p>Du coup non seulement me motiver à faire le dossier me demande une énorme énergie (qui pour le moment se transforme en procrastination coupable), mais en prime je me dis que c&#8217;est dépenser des ressources pour faire le taff d&#8217;une communauté qu&#8217;au final je ne supporte que par obligation professionnelle.</p>
<p>Le résultat est donc que bien que je vais continuer à parler de JS et à coder en JS (programmation Web oblige), je ne vais pas lui accorder autant de place sur S&#038;M ou dans mes heures de loisir.</p>
<p>Je remercie ceux qui prennent le temps de le faire, après tout je profite de leur travail. De mon côté, je vais me concentrer sur les domaines qui me sont plus chers, et parler d&#8217;autre chose uniquement de manière ponctuelle. L&#8217;investissement me parait plus judicieux.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/la-mort-du-tuto-angular/feed/</wfw:commentRss>
		<slash:comments>31</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">16389</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2015/06/you-trusted-me.gif" length="777074" type="image/jpg" />	</item>
		<item>
		<title>Je me te tâte à arrêter le tuto Angular</title>
		<link>http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/</link>
		<comments>http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/#comments</comments>
		<pubDate>Thu, 15 Jan 2015 04:25:58 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[guide]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[meta]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=15736</guid>
		<description><![CDATA[Malgré les <a href="https://medium.com/este-js-framework/what-i-would-recommend-instead-of-angular-js-62b057d8a9e">critiques</a>, j'aime beaucoup AngularJS. Mais à <a href="http://www.i-programmer.info/news/167-javascript/7932-angularjs-20-is-radically-different-.html">l'annonce</a> de la version 2 d'Angular complètement incompatible avec la version 1, seulement quelques années après sa sorties, des questions <a href="http://www.quirksmode.org/blog/archives/2015/01/the_problem_wit.html">se sont posées</a> sur l'avenir du framework.]]></description>
				<content:encoded><![CDATA[<p>Malgré les <a href="https://medium.com/este-js-framework/what-i-would-recommend-instead-of-angular-js-62b057d8a9e">critiques</a>, j&#8217;aime beaucoup AngularJS. Mais à <a href="http://www.i-programmer.info/news/167-javascript/7932-angularjs-20-is-radically-different-.html">l&#8217;annonce</a> de la version 2 d&#8217;Angular complètement incompatible avec la version 1, seulement quelques années après sa sortie, des questions <a href="http://www.quirksmode.org/blog/archives/2015/01/the_problem_wit.html">se sont posées</a> sur l&#8217;avenir du framework.</p>
<p>J&#8217;utilise AngularJS pour certains de mes projets, je suis payé pour former sur AngularJS et j&#8217;ai commencé à écrire <a href="http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-1/">un guide</a> sur le sujet.</p>
<p>Mais je me demande franchement si ça vaut le coup de s&#8217;investir plus.</p>
<p>Je vais continuer à l&#8217;utiliser pour mes projets actuels, tout en regardant du côté de la concurrence <a href="http://facebook.github.io/flux/">ici</a> et <a href="http://facebook.github.io/react/">là</a>.</p>
<p>Si j&#8217;écris l&#8217;article, ce n&#8217;est pas pour vous alarmer. Ni même pour vous dire &#8220;arrêtez d&#8217;utiliser Angular&#8221;. Je pense que la V1 va être maintenue par la communauté pendant des années.</p>
<p>Non, je me demande simplement si ça vaut le coup que je me casse le cul à finir le guide.</p>
<p>J&#8217;ai du travail à la pelle, le<a href="http://sametmax.com/un-gros-guide-bien-gras-sur-les-tests-unitaires-en-python-partie-1/"> guide sur les tests en Python</a>, <a href="https://github.com/sametmax/Django--an-app-at-a-time/tree/fran%C3%A7ais">Django une app à la fois</a>, 0bin à porter en Python 3&#8230;</p>
<p>Bref, est-ce que vous êtes toujours aussi intéressés par ce guide ?</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/feed/</wfw:commentRss>
		<slash:comments>37</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">15736</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2015/01/bbiydaX.gif" length="265415" type="image/jpg" />	</item>
		<item>
		<title>AngularJS pour les utilisateurs de jQuery : partie 2</title>
		<link>http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-2/</link>
		<comments>http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-2/#comments</comments>
		<pubDate>Mon, 27 Oct 2014 06:53:27 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[javascript]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=12561</guid>
		<description><![CDATA[Après une intro sans trop de code, on va passer à du concret.]]></description>
				<content:encoded><![CDATA[<p>Après une intro sans trop de code, on va passer à du concret.</p>
<p><iframe class='youtube-player' type='text/html' width='1170' height='689' src='http://www.youtube.com/embed/6Kbv1OpIpaA?version=3&#038;rel=1&#038;fs=1&#038;autohide=2&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;wmode=transparent' allowfullscreen='true' style='border:0;'></iframe></p>
<p>Pour apprivoiser la bête, on va comme d&#8217;habitude lui faire donner la patte et dire bonjour :</p>
<pre lang="html"><!doctype html>
<!-- Lien entre l'app et la page -->
<html ng-app="tuto">
  <head>
    <meta charset="utf-8" />
    <title>Hello Angular</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.js"></script>
    <script type="text/javascript">

    // Déclaration de l'app
    var app = angular.module('tuto', [])

    // Lancement du code quand angular est prêt
    app.run(function(){
        alert('Hello !')
    })

    </script>
  </head>
  <body>
  </body>
</html></pre>
<p>Pour comprendre ce snippet, il faut réaliser qu&#8217;Angular est d&#8217;abord et avant tout un moyen d&#8217;organiser son code, et qu&#8217;il vous incite à le séparer en conteneurs :</p>
<ul>
<li>Des modules, qu&#8217;on appelle aussi apps. Ce sont les boîtes qui contiennent les autres boîtes. L&#8217;équivalent des apps Django, en fait : on peut mettre tout le programme dedans, mais on peut aussi en faire une lib réutilisable.</li>
<li>Les providers : des fournisseurs de services. Tout le code métier est dedans.</li>
<li>Les directives : tout le code de manipulation du DOM est dedans.</li>
<li>Les contrôleurs : fait le lien entre le HTML et les données.</li>
</ul>
<p>Dans ce code, nous déclarons un module (ou app, c&#8217;est kif-kif) nommé &#8220;tuto&#8221; et n&#8217;ayant aucune dépendance (le second paramètre est un array vide) :</p>
<pre lang="javascript">var app = angular.module('tuto', [])</pre>
<p>Les apps ne font pas grand chose. <strong>Ce sont de gros namespaces avec des dépendances</strong>, c&#8217;est à dire qui déclarent les autres apps nécessaires à leur fonctionnement. Par défaut, aucune autre app n&#8217;est obligatoire pour lancer notre code, donc on ne déclare aucune dépendance.</p>
<p>Il y a juste un piège qu&#8217;il faut connaître. Si je fais :</p>
<pre lang="javascript">var app = angular.module('tuto')</pre>
<p>(notez l&#8217;absence de second paramètre)</p>
<p>Angular va tenter de me chercher la référence d&#8217;app du nom de &#8220;tuto&#8221; qui existe déjà. L&#8217;absence de dépendance se note donc avec un array vide, et non l&#8217;absence d&#8217;array. Subtilité piégeuse s&#8217;il en est. Vu qu&#8217;on n&#8217;aura pas besoin de déclarer de dépendances avant longtemps, inutile de vous crisper dessus, je vous l&#8217;indique juste pour le débuggage qui va immanquablement arriver le jour où vous oublierez l&#8217;array vide.</p>
<p>Ensuite, on fait le lien entre notre code HTML et l&#8217;app via :</p>
<pre lang="html"><html ng-app="tuto"></pre>
<p><code>ng-app</code> est ce qu&#8217;on appelle une directive. Toutes les directives préfixées <code>ng-</code> sont fournies avec le framework et déjà chargées, prêtes à être utilisées. Une directive est un bout de code Javascript appliqué à du HTML, dans ce cas précis via un attribut.</p>
<p>Vous vous souvenez dans les années 2000 comme on vous faisait chier avec le fait de ne pas mettre de Javascript inline dans du HTML ? Les directives, c&#8217;est du Javascript inline qui ne dit pas son nom.</p>
<p><strong>Chaque page doit être liée à une app, et une seule.</strong> Si on ne met pas <code>ng-app</code>, notre code ne se chargera pas, si on en met 2, ça foire. C&#8217;est le point d&#8217;entrée de notre code. Nous déclarons donc que cette page sera gérée par notre app &#8220;tuto&#8221;.</p>
<p>Puis lance notre hello tonitruant :</p>
<pre lang="javascript">    app.run(function(){
        alert('Hello !')
    })</pre>
<p><code>app</code> est la variable contenant la référence à notre app, et en utilisant la méthode <code>.run</code>, on lui passe un <a href="http://sametmax.com/quest-ce-quun-callback/">callback</a> à appeler quand l&#8217;app sera prête.</p>
<p>Il y a plusieurs choses à réaliser ici :</p>
<ul>
<li>C&#8217;est un callback, donc le code de la fonction ne s&#8217;exécute pas tout de suite. Il sera lancé après l&#8217;initialisation de l&#8217;app.</li>
<li>C&#8217;est ce qu&#8217;il y a de plus proche du <code>$.ready</code> de jQuery.</li>
<li>On n&#8217;utilise presque jamais ce code avec Angular.</li>
</ul>
<p>Vous allez me dire, mais espèce de pignouf, pourquoi tu nous montres un code que personne n&#8217;utilise ?</p>
<p>Et bien parce que le titre du dossier est <em>AngularJS pour les utilisateurs de jQuery</em>, du coup je vous mets en terrain connu.</p>
<p>Mais la vérité, c&#8217;est qu&#8217;un vrai hello d&#8217;Angular ressemble à ça :</p>
<pre lang="html"><!doctype html>
<html ng-app="tuto">
  <head>
    <meta charset="utf-8" />
    <title>Hello Angular</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.js"></script>
    <script type="text/javascript">

    /* La je recréé l'app à chaque fois pour des raisons de praticité, mais
        dans un vrai code vous auriez ça dans un fichier à part, une seule
        fois */
    var app = angular.module('tuto', [])

    // Création d'un controller, et attachement d'une variable au scope.
    app.controller('HelloCtrl', function($scope){
        // Attachement d'une donnée au scope
        $scope.hello = "Hello"
    })

    </script>
  </head>
  <body ng-controller="HelloCtrl">
    <!-- Affichage du message attaché au scope -->
    <h1>{{ hello }}</h1>
  </body>
</html></pre>
<p>Et là il y a beaucoup à dire.</p>
<p>Premièrement, contrairement à jQuery, il n&#8217;y a pas de notion de préparation du DOM. En vérité, on peut mettre son code Angular en vrac, et Angular va initialiser tout son monde dans le bon ordre, et exécuter ce qu&#8217;il faut au bon moment. Et ce bon moment est parfois avant que le DOM soit prêt.</p>
<p>Mais vous n&#8217;avez pas à vous en soucier.</p>
<p>Car avec Angular, on manipule très rarement le DOM. Très peu de <code>$('selecteur')</code>, <code>$node.bind()</code> et autre <code>$node.append()</code>, à part dans les directives.</p>
<p>La majorité de votre taf va être de définir des données en pur Javascript, de dire où elles vont dans la page, et de les manipuler en Javascript pendant qu&#8217;Angular s&#8217;occupe de mettre la page à jour automatiquement.</p>
<p>Nous avons pas mal de nouvelles notions ici. D&#8217;abord, le contrôleur&#8230;</p>
<p><strong>C&#8217;est un bout de code qu&#8217;on va lier à un bout de HTML</strong> via la directive <code>ng-controller</code> :</p>
<pre lang="html">  <body ng-controller="HelloCtrl">
    ...
  </body></pre>
<p>Le contrôleur va être responsable de mettre à disposition des données pour ce bout de HTML. On peut lier  autant de contrôleurs qu&#8217;on veut dans une page, et même les imbriquer. Ici, on dit que notre contrôleur <code>HelloCtrl</code> est responsable de mettre des données à disposition pour le tag <code>body</code> et tout ce qu&#8217;il contient.</p>
<p>On fait rarement des contrôleurs qui ratissent aussi large dans de vraies apps, mais pour notre exercice, c&#8217;est très bien.</p>
<p>Comment met-on à disposition des données ? Qu&#8217;est-ce que veut dire &#8220;mettre à disposition&#8221; ? Quelles données ?</p>
<p>Notre contrôleur ressemble à ceci :</p>
<pre lang="html">
    app.controller('HelloCtrl', function($scope){
        $scope.hello = "Hello"
    })
</pre>
<p>La fonction de callback sera exécutée quand <code>ng-controller="HelloCtrl"</code> sera activé automatiquement par Angular. Vous n&#8217;avez pas à vous souciez de quand, il le fera au moment le plus optimisé.</p>
<p>La seule chose dont vous avez à vous soucier, c&#8217;est ce que vous allez mettre dedans.</p>
<p>Et il y a ici deux nouvelles notions :</p>
<ul>
<li>L&#8217;injection de dépendances.</li>
<li>Le service (je vous explique ce qu&#8217;est un service plus loin) <code>$scope</code>.</li>
</ul>
<p>L&#8217;injection de dépendance fait partie de ces trucs qu&#8217;Angular fait automatiquement pour vous. Quand vous déclarez une variable dans le callback d&#8217;un contrôleur, Angular va chercher ce nom en mémoire, et récupérer le service qui porte ce nom. S&#8217;il ne le trouve pas, il plante.</p>
<p>Une fois qu&#8217;il a trouvé le service, il va attendre tranquillement le bon moment pour appeler le callback. Ce moment opportun arrivant, il va lui passer le service en paramètre. On dit qu&#8217;il lui &#8220;injecte&#8221; le service.</p>
<p>En relisant ces paragraphes, je réalise qu&#8217;il y a un mélange de plein de termes : contrôleurs, services, injection, bla, bla, bla.</p>
<p>Voilà le deal :</p>
<ol>
<li>Vous déclarez un contrôleur et vous le liez à du HTML via <code>ng-controller</code>.</li>
<li>Dans ce contrôleur vous dites &#8220;j&#8217;ai besoin du service Machin&#8221;</li>
<li>Angular cherche s&#8217;il connaît Machin. Si non, il plante.</li>
<li>Angular prépare le HTML, décide qu&#8217;il est prêt, appelle votre contrôleur et lui passe Machin en paramètre automatiquement.</li>
</ol>
<p>Les services sont justes des d&#8217;objets javascript ordinaires, qu&#8217;on a nommés d&#8217;une certaine manière pour qu&#8217;Angular puisse les injecter. C&#8217;est tout.</p>
<p>En effet, pour résoudre le problèmes d&#8217;espace de nom en Javascript et d&#8217;organisation d&#8217;une grosse application, les créateurs d&#8217;Angular on créé un grand registre. On enregistre notre code dedans sous un nom (<code>Angular.module('nom_de_l_app')</code>, <code>app.controller('nom_du_controller')</code>, etc.), et Angular récupère le bon code au bon moment. C&#8217;est essentiellement un moyen de pallier au fait que Javascript est dégueulasse.</p>
<p>Donc, plutôt que de faire des imports comme en Python, on va déclarer une variable en paramètre, et Angular injecte le bon objet pour vous. C&#8217;est bizarre, mais on s&#8217;habitue.</p>
<p>Du coup, là :</p>
<pre lang="javascript">app.controller('HelloCtrl', function($scope){</pre>
<p>Je dis &#8220;crée moi le contrôleur nommé &#8216;HelloCtrl&#8217;, et quand tu vas appeler le callback, passe lui l&#8217;objet nommé &#8216;$scope&#8217; en paramètre. Fais ça au bon moment, je m&#8217;en branle, je veux pas le savoir. Démmerde toi, on a tous des problèmes.&#8221;</p>
<p>Le résultat, c&#8217;est que votre fonction sera exécutée automatiquement au bon moment, et qu&#8217;elle aura <code>$scope</code> qui lui sera passé.</p>
<p>Alors à quoi sert ce <code>$scope</code> ?</p>
<p>C&#8217;est simple : tout ce qui est attaché en attribut de <code>$scope</code> est accessible dans le HTML géré par ce contrôleur. Quand je fais :</p>
<pre lang="javascript">    app.controller('HelloCtrl', function($scope){
        $scope.hello = "Hello"
    })
</pre>
<p>Et que après je lie mon contrôleur au HTML :</p>
<pre lang="html">  <body ng-controller="HelloCtrl">
    <!-- Affichage du message attaché au scope -->
    <h1>{{ hello }}</h1>
  </body></pre>
<p>Ma variable <code>hello</code> est disponible ici (via les petites moustaches qu&#8217;on verra au prochain chapitre), parce que je suis dans <code>body</code> qui est géré par le contrôleur <code>HelloCtrl</code> qui contient un <code>$scope</code> avec l&#8217;attribut <code>hello</code>. Fiou ! Ca en fait des couches. Mais Angular, c&#8217;est comme <del>un orgre</del> un onion.</p>
<p>Vous touchez ici du doigt l&#8217;essence même du boulot des contrôleurs, et à peu près leur unique but : mettre des données à disposition du HTML. C&#8217;est le C de <a href="http://sametmax.com/quest-de-que-mvc-et-a-quoi-ca-sert/">MVC</a>.</p>
<p>C&#8217;est pour cette raison que je vous ai répété &#8220;Angular va tout faire au bon moment, vous n&#8217;avez pas à vous soucier de quand&#8221;. Ceci est en effet très frustrant à entendre quand on vient du monde de jQuery puisque qu&#8217;on doit savoir exactement quand on fait les choses : il faut que le DOM soit prêt, il faut que les éléments sur lesquels on travaille existent, il faut qu&#8217;on puisse récupérer des nodes et en ajouter.</p>
<p>Avec Angular, on ne fait rien de tout ça. On va déclarer ses données dans le contrôleur, et dire où elles doivent être mises dans la page. Angular se charge de faire le lien pour vous quand le HTML est prêt, quand le Javascript est chargé, quand les Dieux sont avec vous&#8230;</p>
<hr>
<a href="https://github.com/sametmax/codes-des-articles/tree/master/2014/octobre"><br />
Télécharger le code de l&#8217;article.</a></p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-2/feed/</wfw:commentRss>
		<slash:comments>6</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">12561</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2014/10/index.jpeg" length="8147" type="image/jpg" />	</item>
		<item>
		<title>AngularJS pour les utilisateurs de jQuery : partie 1</title>
		<link>http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-1/</link>
		<comments>http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-1/#comments</comments>
		<pubDate>Tue, 02 Sep 2014 09:55:36 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[meh]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=12170</guid>
		<description><![CDATA[Angular rend l'utilisation de JS plus supportable, mais possède une très grosse courbe d'apprentissage bien pentue, avec des ressources vraiment mal foutues.]]></description>
				<content:encoded><![CDATA[<p>Après avoir sondé un peu Twitter, le sujet intéresse, et il est très, mais alors, très mal traité ailleurs sur le net. Malgré mon aversion, <a href="http://sametmax.com/un-gros-troll-de-plus-sur-javacscript/">bien connue</a>, pour javascript, je m&#8217;en bouffe beaucoup, prog Web oblige.</p>
<p>Angular rend l&#8217;utilisation de JS plus supportable, mais possède une très grosse courbe d&#8217;apprentissage bien pentue, avec des ressources vraiment mal foutues.</p>
<p>Et surtout, le problème vient de l&#8217;habitude de jQuery.</p>
<p>AngularJS est l&#8217;anti-jQuery, ça ne fonctionne pas du tout pareil, mais personne n&#8217;est là pour vous montrer comment faire la transition. Ce sera le but de ce dossier, un dossier qui va être long car ce framework est un gros morceau.</p>
<h2>Quand utiliser AngularJS ?</h2>
<p>Tous les sites ne sont pas faits pour être créés avec Angular. En effet, si votre site est essentiellement composé de contenu statique, avec juste un peu de dynamique pour quelques widgets, Angular n&#8217;a aucun intérêt.</p>
<p>Angular est lourd à mettre en œuvre, on va donc se faire chier à sortir le bazooka quand on monte au front, pas quand on fait une garde de nuit en rase campagne.</p>
<p>Malgré le fait que Google interprète maintenant les pages en JS, le texte reste roi, et Angular vous force à faire des pages en pur JS, rendant le référencement aléatoire de votre contenu. Les hacks que l&#8217;on voit un peu partout sur la toile pour compenser cela sont très loin d&#8217;obtenir l&#8217;effet d&#8217;un référencement naturel de contenu facilement accessible à l&#8217;ancienne.</p>
<p>En fait, le plus gros défaut d&#8217;Angular, c&#8217;est qu&#8217;il ne permet pas, pour le moment, de faire de la dégradation gracieuse. Soit le mec a Javascript et il a accès au site. Soit le site est illisible.</p>
<p>jQuery a donc encore de beaux jours devant lui.</p>
<p>Typiquement, on ne prendra pas Angular pour :</p>
<ul>
<li>La partie publique d&#8217;un blog de type WordPress.</li>
<li>Un wiki type Wikipédia.</li>
<li>Un forum ou site collaboratif.</li>
<li>Un tube vidéo.</li>
</ul>
<p>Ce sont des sites dont le contenu est important. On veut que les moteurs de recherche puisse les indexer de fond en comble. On veut que ce soit lisible sans JS et par les aveugles (sauf le tube vidéo :-D). Les ajouts de JS se feront par petites touches.</p>
<p>On utilisera plutôt Angular pour :</p>
<ul>
<li>Une app grand public.</li>
<li>La partie admin d&#8217;un blog.</li>
<li>Un logiciel d&#8217;entreprise.</li>
<li>Un réseau social.</li>
</ul>
<p>Ce sont des sites pour lesquels l&#8217;ergonomie est plus importante que le contenu. Le public est captif, et on peut exiger Javascript, prix à payer pour une expérience utilisateur moderne.</p>
<p>Vous noterez qu&#8217;il y a une certaine opposition entre vieux format (wiki, forum, blog) et format contemporain (app, réseau social). Ce n&#8217;est pas un hasard. Les premiers sont orientés contenu, les seconds orientés usage. C&#8217;est ainsi que le Web a évolué, et Angular est là exactement pour répondre à cette évolution.</p>
<p>Il est néanmoins tout à fait possible de faire des choses hybrides. Rien n&#8217;empêche de faire des parties du sites statiques, et d&#8217;autres très dynamiques, de mélanger les deux sur une même page. Par exemple, sur un blog, vous pouvez mettre l&#8217;article en statique pour le ref et la facilité de consultation, et la partie commentaires en Angular, pour améliorer l&#8217;expérience utilisateur.</p>
<h2>Que va apporter Angular ?</h2>
<p>Les avantages sont doubles.</p>
<p>D&#8217;abords, il y a les avantages pour vous, le développeur. Angular vous force en effet à utiliser un style Javascript très propre qui tend à découpler les composants, isoler les services, lisser les angles et refaire le papier peint à fleur. L&#8217;application en devient plus propre, plus facile à faire évoluer et à maintenir. Toutes les bonnes pratiques d&#8217;organisation d&#8217;une app JS ont une réponse angularesque. Ce n&#8217;est pas forcément celle que vous voulez, mais elle marche.</p>
<p>Ensuite, Angular va vous rendre plus productif. Pas tout de suite, évidement, coincés que vous êtes dans votre logique jQuerinne. Mais une fois le cap passé, coder beaucoup de JS sera immensément plus simple et plus rapide, car Angular vous épargne beaucoup de logique répétitive.</p>
<p>En prime, ce framework est orienté tests. Ce n&#8217;est pas obligatoire, mais c&#8217;est bien plus facile qu&#8217;avec des modules jQuery.</p>
<p>Mais il y a également les avantages pour l&#8217;utilisateur. Puisque qu&#8217;Angular est complètement dynamique, il bénéficiera automatiquement d&#8217;une app plus réactive, avec moins de rechargements, plus de fonctionnalités aussi. En effet, vous rechignerez moins à rajouter cette fonction &#8220;delete-row&#8221; si vous savez que ça vous prend 3 lignes de code.</p>
<p>Attention cependant, il y a aussi des inconvénients.</p>
<p>Angular est lourd, c&#8217;est long à charger, ça bouffe de la ressource pour chaque tab, et si vous avez beaucoup de traitements sur une page, vous avez intérêt à optimiser votre race le bouzin sinon ça va ramer. Tout le monde n&#8217;est pas sur une machine de dev propre à 8 cœurs avec une ligne ADSL qui a tout compris.</p>
<p>En fait, si votre site est destiné à être consulté ainsi : je cherche, je consulte du contenu, et je m&#8217;en vais, charger Angular est un pur gâchis. Il faut au moins que l&#8217;on interagisse un peu avec le site pour que ça vaille le coup : créer du contenu, manipuler des informations, se faire notifier, etc.</p>
<p>Et puis il y a la tentation, la tentation forte de tout faire à la main côté client. Avec son lot de problèmes de sécurité (le delete qui fait pas de vérif), de merdier dans l&#8217;histo de navigation (le clic du milieu qui marche pas, le back qui back pas où on veut), les sessions qui font des siennes (je suis déco, mais y mon avartar là, pourquoi ?), etc.</p>
<p>Angular n&#8217;est pas une solution pour le bidouilleur Javascript de devenir soudainement grand programmeur Web, et ne dispense pas de coder correctement.</p>
<h2>Si je fais de l&#8217;Angular, je dois faire du NodeJS ?</h2>
<p>Non.</p>
<p>Angular est une techno parfaitement neutre, elle est limitée au client, et par conséquent, vous êtes libres de choisir votre techno côté serveur : .Net, PHP, Ruby, Java, Python&#8230;</p>
<p>Par contre, pour les tests, les outils sont très orientés autour de l&#8217;écosystème NodeJS : npm, grunt, PhantomJS, etc. Il va falloir mettre les mains dans le cambouis, avec son lot de trucs qui s&#8217;installent pas, de dépendances mal branlées, de doc pas à jour, de code JS peu expressif et tout le bordel. C&#8217;est tout le problème du JS, la communauté a gardé le côté crade et à l&#8217;arrache du langage. Heureusement, ils ont récupéré les designers du monde Ruby, donc vous aurez des tutos obsolètes, mais très jolis.</p>
<h2>Ok, mais je peux faire quoi avec ?</h2>
<p>Car finalement, quand on n&#8217;a pas utilisé Angular, on se demande finalement qu&#8217;est-ce que ça apporte par rapport à jQuery.</p>
<p>Essentiellement, c&#8217;est que ça divise par 100 les manipulations du DOM. Avec Angular, on met ses données dans un tableau d&#8217;objets JS, on indique où les afficher, et on manipule ensuite notre array. Le DOM est mis à jour sans qu&#8217;on doive s&#8217;en soucier.</p>
<p>Ça à l&#8217;air de rien comme ça, mais si vous ouvrez vos fichiers JS avec jQuery, vous verrez qu&#8217;ils sont blindés de <code>.click()</code>code et de <code>.append()</code>. C&#8217;est la majorité du code ! Code qu&#8217;on a pas besoin d&#8217;écrire avec Angular.</p>
<p>L&#8217;organisation d&#8217;Angular invite aussi naturellement à écrire un code linéaire. Pas de blocs dans des blocs dans des blocs, chaînes de callbacks et amas de closures. Il y en a toujours, mais bien moins.</p>
<p>Après, on fait finalement la même chose qu&#8217;on ferait avec jQuery, mais plus facilement. Ce qui explique qu&#8217;on fait rarement une app full JS avec jQuery, ce qui est infernal à coder, alors qu&#8217;on le fait systématiquement avec Angular, car c&#8217;est son milieu naturel.</p>
<p>Ce qui va vous surprendre avec cette façon de faire, c&#8217;est que tout ce qui s&#8217;affiche dans la page passe par Angular. En fait, on a généralement une API REST, et Angular en front pour afficher le site. Pas trop de templating côté serveur.</p>
<p>Et on verra des exemples concrets de tout ça dans <a href="http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-2/">les parties suivantes</a> :)</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-1/feed/</wfw:commentRss>
		<slash:comments>32</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">12170</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2014/09/FaeriesAireandDeathWaltz1.gif" length="724555" type="image/jpg" />	</item>
		<item>
		<title>Rendre un élément scrollable avec Angular</title>
		<link>http://sametmax.com/rendre-un-element-scrollable-avec-angular/</link>
		<comments>http://sametmax.com/rendre-un-element-scrollable-avec-angular/#comments</comments>
		<pubDate>Tue, 01 Jul 2014 09:30:20 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[javascript]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=11240</guid>
		<description><![CDATA[Petit snippet que j'utilise dans mes apps angular. Ça permet de définir un comportement quand l'utilisateur scroll au dessus d'un élément. Typiquement, augmenter la valeur d'un champ, faire défiler un carousel, etc. Il faut, bien entendu, éviter que la page scroll elle-même.]]></description>
				<content:encoded><![CDATA[<p>Petit snippet que j&#8217;utilise dans mes apps angular. Ça permet de définir un comportement quand l&#8217;utilisateur scrolle au-dessus d&#8217;un élément. Typiquement, augmenter la valeur d&#8217;un champ, faire défiler un carousel, etc. Il faut, bien entendu, éviter que la page scrolle elle-même.</p>
<h2>Implémentation</h2>
<pre lang="javascript">app.directive('wheelable', function() {
"use strict";

  /* On définit sur quels attributs on va mettre les callbacks */
  var directive = {
      scope: {
          'onWheelUp': '&onwheelup',
          'onWheelDown': '&onwheeldown'
      }
  };

  /* On limite la directive aux attributs */
  directive.restrict = 'A';

  /* Le code qu'active la directive quand on la pose sur l'élément */
  directive.link = function($scope, element, attributes) {

      /* On attache un callback à tous les événements de scrolling */
      element.bind('mousewheel wheel', function(e) {

        /* On vérifie si l'utilisateur scroll up ou down */
        if (e.originalEvent) {
          e = e.originalEvent;
        }
        var delta = (e.wheelDelta) ? e.wheelDelta : -e.deltaY;
        var isScrollingUp = (e.detail || delta > 0);

        /* On appelle le bon callback utilisateur */
        if (isScrollingUp){
          $scope.$apply($scope.onWheelUp());
        } else {
          $scope.$apply($scope.onWheelDown());
        }

        /* On évite que la page scrolle */
        e.preventDefault();
      });
  };

  return directive;
});</pre>
<h2>Usage</h2>
<p>Comme pour toutes les directives qui impliquent des callbacks, il faut définir des fonctions et les attacher à votre scope dans un controleur (ou un service attaché au controleur) :</p>
<pre lang="javascript">app.controller('FooCtrl', function($scope) {
"use strict";
  $scope.votreCallBackPourQuandCaScrollDown = function(){
    // faire un truc par exemple moi je l'utilise pour changer
    // la valeur de l'élément.
  };
  $scope.votreCallBackPourQuandCaScrollDown = function(){
    // faire un autre truc
  };
});</pre>
<p>La directive s&#8217;utilise en mettant l&#8217;attribut <code>wheelable</code> sur l&#8217;élément qu&#8217;on veut rendre scrollable. Ensuite on déclare dans les attributs <code>onwheeldown</code> et <code>onwheelup</code> le code à exécuter, et zou :</p>
<pre lang="html">
<div ng-controller="FooCtrl">
  ...
  <input type="text" wheelable
         onwheeldown="votreCallBackPourQuandCaScrollDown()"
         onwheelup="votreCallBackPourQuandCaScrollUp()"
         >
  ...
</div>
</pre>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/rendre-un-element-scrollable-avec-angular/feed/</wfw:commentRss>
		<slash:comments>8</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">11240</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2014/07/R36fqO3.gif" length="272833" type="image/jpg" />	</item>
		<item>
		<title> La protection CSRF de Django et les requêtes Ajax</title>
		<link>http://sametmax.com/la-protection-csrf-de-django-et-les-requetes-ajax/</link>
		<comments>http://sametmax.com/la-protection-csrf-de-django-et-les-requetes-ajax/#comments</comments>
		<pubDate>Tue, 10 Jun 2014 04:18:36 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[ajax]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[cookie]]></category>
		<category><![CDATA[csrf]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[header]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[jquery]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=10438</guid>
		<description><![CDATA[La protection contre les <a href="https://fr.wikipedia.org/wiki/CSRF">attaques CSRF</a> est dans le top 10 des erreurs les plus chiantes en Django, main dans la main avec les fichiers statiques qui ne marchent pas, les URL qui ne matchent pas et les CBV qui nheuuuu, juste pas.]]></description>
				<content:encoded><![CDATA[<p>La protection contre les <a href="https://fr.wikipedia.org/wiki/CSRF">attaques CSRF</a> est dans le top 10 des erreurs les plus chiantes en Django, main dans la main avec les fichiers statiques qui ne marchent pas, les URL qui ne matchent pas et les CBV qui nheuuuu, juste pas.</p>
<p>Une fois qu&#8217;on a compris le principe, ça va pour la prog normal, mais un jour on a besoin de faire un POST en Ajax, et on se retrouve avec une erreur invisible. Après avoir dégainé Firebug, on comprend qu&#8217;on a une 403 forbidden, et votre cerveau finit (la durée galérienne est plus ou moins longue selon les profiles, les heures de sommeil et les phases de la lune) par réaliser qu&#8217;on n&#8217;a pas envoyé le token CSRF. Merde.</p>
<p>C&#8217;est là que généralement les gens sortent du <code>@csrf_exempt</code>, ou carrément, en finissent avec cette solution radicale :</p>
<pre lang="python">MIDDLEWARE_CLASSES = (
    'django.middleware.gzip.GZipMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.locale.LocaleMiddleware',
    # 'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
)</pre>
<p>Mais c&#8217;est quand même dommage d&#8217;en arriver là alors qu&#8217;on peut le faire proprement.</p>
<p>D&#8217;abord, le token est sauvegardé dans un cookie. Il faut donc le récupérer.</p>
<pre lang="javascript">
// ue petite fonction pour récupérer la valeur d'un cookie,
// puisque bien entendu, comme toutes les APIS javascripts,
// les choses qu'on fait le plus souvent ne sont pas incluses
// en natif. Oui je suis aigri.
function getCookie(name) {
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                return decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
}</pre>
<p>Sinon, pour les fainéants, il y a y a un <a href="https://github.com/carhartl/jquery-cookie">plugin jquery</a> qui permet de faire <code>$.cookie('nom')</code>.</p>
<p>Ensuite, on attache cette valeur en header avec toutes les requêtes POST. Comme ça, plus besoin de l'inclure manuellement, on peut faire ses requêtes sans y penser.</p>
<p>Avec jQuery :</p>
<pre lang="javascript">$.ajaxSetup({
    // fonction appelée avant d'envoyer une requête AJAX
    beforeSend: function(xhr, settings) {
         // on ajoute le header que si la requête est pour le site en cours
         // (URL relative) et est de type POST
         if (!/^https?:.*/.test(settings.url)  && settings.type == "POST") {
             // attachement du token dans le header
             xhr.setRequestHeader("X-CSRFToken",  getCookie('csrftoken'));
         }
     }
});</pre>
<p>Avec AngularJs :</p>
<pre lang="javascript">
// interception de la configuration du provider HTTP
// qui possède un mécanisme déjà tout prêt pour ça
votre_app.config(function($httpProvider) {
    $httpProvider.defaults.xsrfCookieName = 'csrftoken';
    $httpProvider.defaults.xsrfHeaderName = 'X-CSRFToken';
});
</pre>
<p>Attention, si l'app n'est pas servie par Django (template statique avec uniquement des appels Ajax), il faut faire au moins un GET avant de faire son premier POST afin d'obtenir le cookie.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/la-protection-csrf-de-django-et-les-requetes-ajax/feed/</wfw:commentRss>
		<slash:comments>19</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">10438</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2014/06/tumblr_n68oe9Se2S1r539hzo1_500.jpg" length="39875" type="image/jpg" />	</item>
		<item>
		<title>Service, factory et provider dans AngularJS</title>
		<link>http://sametmax.com/service-factory-et-provider-dans-angularjs/</link>
		<comments>http://sametmax.com/service-factory-et-provider-dans-angularjs/#comments</comments>
		<pubDate>Tue, 29 Apr 2014 09:07:41 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[factory]]></category>
		<category><![CDATA[javascript]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=10095</guid>
		<description><![CDATA[Tuto long et chiant sur un concept de base d'angularjs.]]></description>
				<content:encoded><![CDATA[<p>AngularJS est un framework difficile à prendre en main. Pas parce qu&#8217;il est particulièrement compliqué, mais parce que ses concepts sont vraiment différents de ceux qu&#8217;on a l&#8217;habitude de rencontrer dans les frameworks habituels. Le pire, c&#8217;est quand on vient de jQuery, car Angular est un peu l&#8217;anti-jQuery et il faut littéralement désapprendre ses habitudes.</p>
<p>Généralement, les gens s&#8217;en sortent avec les contrôleurs. Ils ne mettent pas le bon code dedans, ils ne savent pas comment rendre les bouts de code indépendants et réutilisables, mais ils arrivent à en faire quelque chose. Les directives, ils n&#8217;y touchent pas, mais ils peuvent s&#8217;en passer pendant un certain temps et juste réutiliser du code trouvé sur Github.</p>
<p>Par contre le côté service/factory/provider, ça c&#8217;est un gros problème. On ne peut pas faire sans, mais peu de gens savent faire avec. En codant <a href="http://allthatcounts.net">All that counts</a>, j&#8217;ai réalisé que c&#8217;était un bon tuto à faire. Donc en avant.</p>
<p>Article long = musique, évidement.</p>

<!-- iframe plugin v.4.3 wordpress.org/plugins/iframe/ -->
<iframe width="420" height="315" src="//www.youtube.com/embed/lMLnDuzgkjo" frameborder="0" 0="allowfullscreen" scrolling="yes" class="iframe-class"></iframe>

<p>On m&#8217;a très justement demandé les prérequis pour suivre cet article : il faut avoir fait des tutos de base sur Angular et notamment comprendre l&#8217;injection de dépendance et le data binding.</p>
<h2>Que font ces trucs là ?</h2>
<p>Techniquement, un service, une factory ou un provider, dans AngularJS, <strong>ça sert à la même chose</strong>. Un service est juste une manière plus facile d&#8217;écrire une factory, qui est juste une manière plus simple d&#8217;écrire un provider.</p>
<p><strong>Les 3 servent à créer un objet Javascript ordinaire, c&#8217;est tout.</strong></p>
<p>Oui, oui, c&#8217;est vraiment tout. C&#8217;est le seul et unique but de cela. Vous allez me dire, mais alors pourquoi se faire chier à les utiliser alors qu&#8217;on peut écrire un objet à la main ? Tout simplement parce qu&#8217;ils permettent d&#8217;encapsuler cette création, l&#8217;isoler du reste du code, un problème toujours difficile en Javascript.</p>
<p>Ils sont là pour éviter de pourrir le namespace global, tout en n&#8217;utilisant pas la technique bien connu de &#8220;je met un gros conteneur avec tout dedans et tout le monde y accède&#8221;, qu&#8217;on a tendance à voir dans la plupart des projets JS. Le code est ainsi plus maintenable et testable.</p>
<p>Chaque service/factory/provider permet d&#8217;avoir un groupe de fonctionnalités séparé du reste. On peut utiliser celui-ci facilement partout ailleurs en utilisant l&#8217;injection de dépendance. <strong>Si vous ne savez pas ce que c&#8217;est, arrêtez-vous tout de suite, c&#8217;est le principe de fonctionnement de base d&#8217;Angular, il faut quitter cet article et prendre un tuto pour débutant.</strong> Revenez ensuite.</p>
<p>Dans un service/factory/provider, on va donc mettre du code métier et/ou des données de l&#8217;app, mais groupés par thème.</p>
<p>Par exemple, sur une app video, on peut en faire un qui va contenir le code pour gérer le profile utilisateur et un pour gérer la playlist.</p>
<p>On aura donc deux services/factories/providers, qui vont créer au final deux objets. Chaque objet va contenir des méthodes et des données. Pour le profile, on peut imaginer qu&#8217;il va contenir le nom d&#8217;utilisateur, son ID, et une méthode de login et de logout :</p>
<pre lang="javascript">{
    "name": "Hodor",
    "Id": 7898,
    "login": function(){
        // faire un truc pour se loger
    },
    "logout": function(){
        // faire un truc pour se deco
    }
}</pre>
<p>Pour la playlist, on peut imaginer que ça va contenir la liste des videos, la video en cours de lecture et de quoi passer à la suivante et précédente :</p>
<pre lang="javascript">{
    "name" : "Super playlist"
    "videos": [
        {"title": "video 1", "url": "http://..."},
        {"title": "video 2", "url": "http://..."}
    ],
    "currentVideo": 1,
    "next": function(){
        // passer à la vid suivante
    },
    "previous": function(){
        // passer à la vid précédente
    }

}</pre>
<p>Et c&#8217;est tout. Ce n&#8217;est ni plus ni moins que ça, des objets normaux dans lesquels ont va mettre nos données et nos méthodes. <strong>Ce qui est &#8220;special&#8221;, c&#8217;est comment ils sont créés et utilisés.</strong> Et c&#8217;est ça qu&#8217;on va voir tout de suite.</p>
<h2>Créer un objet via un service/factory/provider</h2>
<p>Voyons le plus compliqué d&#8217;abord : le provider. Les deux autres ne sont que des raccourcis pour écrire un provider, de toute façon.</p>
<p>Le rôle du provider, c&#8217;est de créer et mettre à disposition un objet. C&#8217;est tout. Il n&#8217;y a rien de plus. Je répète, ça ne sert qu&#8217;à ça. &#8220;provider&#8221;, ça veut dire &#8220;fournisseur&#8221; en anglais. Et c&#8217;est ce que ça fait : ça fournit un objet. Supposons que vous avez déjà créé une app &#8220;monApp&#8221;. Écrire un provider pour créer l&#8217;objet &#8220;profile&#8221; ressemble à ça :</p>
<pre lang="javascript">
// On appelle notre objet qui sera créé "profile". Ce qui signifie que l'on
// pourra ensuite utiliser le nom "profile" pour annoncer quand
// on souhaite utiliser l'objet issu de ce provider.
monApp.provider("profile", function(){

    // Un provider, au final, c'est juste une fonction anonyme qu'on relie
    // à un nom :)

    // Cette fonction DOIT avoir une méthode nommé "$get" attachée à son "this"
    this.$get = function() {

        // Et la méthode "$get" DOIT retourner l'objet qu'on veut créer.
        return {
            "name": "Anonymous",
            "Id": null,
            "login": function(){
                // faire un truc pour se loger
            },
            "logout": function(){
                // faire un truc pour se deco
            }
        }
    }
});
</pre>
<p>C&#8217;est tout. Je vous jure que c&#8217;est tout. C&#8217;est juste une boîte qu&#8217;Angular va prendre, et appeler la méthode <code>$get</code> pour obtenir un objet. En plus, un seul objet, car la méthode ne sera appelée qu&#8217;une fois : l&#8217;objet sera un singleton.</p>
<p>Plus tard dans le code, quand vous ferez un controller :</p>
<pre lang="javascript">mymonAppApp.controller('UnControlleurCommeUnAutre', function($scope, profile) {
    $scope.profile = profile;
});</pre>
<p>Vous utiliserez <code>profile</code> en paramètre, il va donc être injecté automatiquement. C&#8217;est tout le principe d&#8217;angular, des tas de boîtes qui déclarent quelles autres boîtes elles utilisent via l&#8217;injection de dépendance.</p>
<p>Ici, l&#8217;objet va être créé (si ce n&#8217;est pas déjà fait ailleurs), et c&#8217;est tout. Le boulot d&#8217;un controller, c&#8217;est essentiellement de mettre des objets issus des providers dans le scope pour que le HTML puisse les utiliser. Je vous promet, c&#8217;est 90% des use cases.</p>
<p>Votre objet sera le conteneur que l&#8217;on va manipuler pour changer le nom du profile, se logger, etc. C&#8217;est juste une boîte qui rend un service. D&#8217;ailleurs on appelle souvent les objets issus des providers des &#8220;services&#8221;.</p>
<p>Utiliser des providers évite de créer tout une logique de classes, de gérer des namespaces, des instanciations : on est obligé de faire de l&#8217;encapsulation et de la composition. Ca rend le code (javascript) plus propre et plus testable, bien décomposé et découplé. <strong>Avoir un code propre est le but principal des providers, ils ne fournissent rien comme fonctionnalités qu&#8217;on ne puisse faire autrement</strong>.</p>
<p>Maintenant voyons ce qu&#8217;est une factory. En fait, c&#8217;est juste un raccourci pour écrire un provider :</p>
<pre lang="javascript">monApp.factory('profile', function() {
    return {
        "name": "Anonymous",
        "Id": null,
        "login": function(){
            // faire un truc pour se loger
        },
        "logout": function(){
            // faire un truc pour se deco
        }
    }
});</pre>
<p>Ça fait exactement la même chose, et on l&#8217;utilise exactement pareil. C&#8217;est juste plus court. Pas de méthode <code>$get</code> à écrire, on retourne l&#8217;objet cash pistache.</p>
<p>Pourquoi on utilise un provider alors ? Parce que c&#8217;est plus pratique à configurer, comme on le verra plus bas. Mais la factory est suffisante la plupart du temps. Ce qui est marrant, c&#8217;est qu&#8217;en terme informatique, un provider est un design pattern &#8220;factory&#8221;, ce qui m&#8217;a vachement rendu confus au début&#8230;</p>
<p>Et le service alors ? C&#8217;est une syntaxe alternative :</p>
<pre lang="javascript">monApp.service('profile', function() {
    this.name = "Anonymous";
    this.id = null;
    this.login = function(){
        // faire un truc pour se loger
    }
    this.logout = function(){
        // faire un truc pour se deco
    }
});</pre>
<p>La fonction va être utilisée directement (avec <code>new</code>) pour créer l&#8217;objet, donc pas besoin de <code>return</code> : on attache tout à <code>this</code>. Mais le résultat est strictement le même. Le choix entre une factory et un service est vraiment une question de goût. Personnellement je vous conseille d&#8217;utiliser des factories car ça vous évite le casse-tête de la portée de <code>this</code>, grande cause d&#8217;erreurs en JS.</p>
<h2>Dépendances et injections</h2>
<p>Souvenez-vous qu&#8217;on peut faire ça :</p>
<pre lang="javascript">mymonAppApp.controller('UnControlleurCommeUnAutre', function($scope, profile) {
    $scope.profile = profile;
});</pre>
<p>Pour dire &#8220;mon controller dépend de profile, donc s&#8217;il te plait Angular, crée l&#8217;objet et passe le moi&#8221;.</p>
<p>Et bien ça marche aussi entre les providers/factories/services. Par exemple, si je fais un provider pour ma playlist, mais que la playlist dépend du profile :</p>
<pre lang="javascript">monApp.provider("playlist", function(){

    // En utilisant le nom de l'autre provider ici, je demande à ce qu'il
    // soit injecté ici, et donc disponible ici. Je dis "ce provider
    // est dépendant de l'objet fournit par cet autre provider."
    this.$get = function(profile) {

        return {
            // Et du coup je peux accéder aux attributs de l'objet.
            "name": "Playlist de " + profile.name
            "videos": [],
            "currentVideo": 1,
            "next": function(){
                // passer à la vid suivante
            },
            "previous": function(){
                // passer à la vid précédente
            }
        }
    }
});</pre>
<p>Si je le faisais avec une factory, se serait pareil, mais en plus simple :</p>
<pre lang="javascript">
// l'injection de dépendance se fait au niveau de la fonction anonyme
// car il n'y a pas de méthode "$get"
monApp.factory("playlist", function(profile){
    return {
        "name": "Playlist de " + profile.name
        "videos": [],
        "currentVideo": 1,
        "next": function(){
            // passer à la vid suivante
        },
        "previous": function(){
            // passer à la vid précédente
        }
    }
});</pre>
<h2>L&#8217;interêt des providers</h2>
<p>L&#8217;interêt principal d&#8217;utiliser un provider plutôt qu&#8217;une factory, c&#8217;est qu&#8217;on peut le rendre configurable.</p>
<p>Par exemple, je veux que ma playlist ne soit jamais vide, alors si elle l&#8217;en, on met deux vidéos par défaut dedans :</p>
<pre lang="javascript">monApp.factory("playlist", function(profile){

    // je ne retourne pas l'objet tout de suite, je vais le modifier
    var playlist = {
        "name": "Playlist de " + profile.name
        "videos": [],
        "currentVideo": 1,
        "next": function(){
            // passer à la vid suivante
        },
        "previous": function(){
            // passer à la vid précédente
        }
    };

    // hop, je m'assure que la playlist n'est jamais vide en modifiant
    // l'objet
    if (playlist.videos.length === 0){
        playlist.videos = [
            {"title": "video 1", "url": "http://..."},
            {"title": "video 2", "url": "http://..."}
        ]
    }

    // ne pas oublier de retourner l'objet à la fin quand même :)
    return playlist;
});</pre>
<p>Tout ça sera largement suffisant dans la plupart des cas. Mais dans le rare cas où je veux faire une lib réutilisable, je veux que ces vidéos par défaut soient configurables. Comment alors permettre que l&#8217;utilisateur de ma lib les choisisse ?</p>
<p>En utilisant un provider :</p>
<pre lang="javascript">monApp.provider("playlist", function(){

    // On déclare des données attachée sur le provider. PAS sur l'objet que
    // le provider va créer, attention. Sur le provider lui-même.
    // Le provider, je le rappelle, c'est cette fonction anonyme qui retourne
    // un objet via sa méthode "$get" (oui, les fonctions sont des objets
    // en JS, et peuvent avoir des méthodes. Ce langage est très clair.)
    this.defaultVideos = [
            {"title": "video 1", "url": "http://..."},
            {"title": "video 2", "url": "http://..."}
    ]

    // ensuite je fais ma méthode "$get" qui va retourner l'objet voulu,
    // comme d'hab
    this.$get = function(profile) {

        var playlist = {
            "name": "Playlist de " + profile.name
            "videos": [],
            "currentVideo": 1,
            "next": function(){
                // passer à la vid suivante
            },
            "previous": function(){
                // passer à la vid précédente
            }
        }

        // Au moment de la création de l'objet, j'utilise les données
        // attachées au provider pour fournir la valeur par défaut.
        if (playlist.videos.length === 0){
            playlist.videos = this.defaultVideos;
        }

        return playlist;
    }
});</pre>
<p>Jusqu&#8217;ici, vous allez me dire, mais quelle est la différence avec le précédent ? Et bien il se trouve qu&#8217;Angular met à votre disposition automatiquement <code>playlist</code>, <strong>mais également <code>playlistProvider</code></strong>, une référence sur le provider qui va créer l&#8217;objet <code>playlist</code>.</p>
<p>ATTENTION : quand vous déclarez ici &#8220;playlist&#8221;, &#8220;playlist&#8221; est le nom de l&#8217;objet créé par le provider. Angular, lui, va automagiquement attacher le nom &#8220;playlistProvider&#8221; au provider qui a créé l&#8217;objet. Vous n&#8217;avez rien à faire pour cela, il va automatiquement s&#8217;appeler &#8220;nomDeVotreObjetProvider&#8221; et sera mis à votre disposition.</p>
<p>Du coup :</p>
<pre lang="javascript">// On peut utiliser "config" pour lancer du code avant la création des objets
// par les providers. Tout le code dans des blocs "config" est toujours lancé en premier,
// avant tous les providers/factories/services de cette app.
monApp.config(function(playlistProvider){
    // ici l'utilisateur de votre lib a accès au provider avant la création de
    // l'objet, et à donc le loisir de changer les valeurs par défaut
    playlistProvider.defaultVideos = [
            {"title": "Autre video", "url": "http://..."},
    ]
});</pre>
<p>Ce n&#8217;est pas un cas courant, et la plupart du temps, utiliser une factory marchera très bien.</p>
<h2>Et tout ça, je m&#8217;en sers pour quoi ?</h2>
<p>On met dans les providers/services/factories, tout le code qui n&#8217;est pas lié à la navigation ou à la manipulation de DOM. Bref, tout le code de la logique de votre app. Le code qui n&#8217;est pas lié au Web. Un profile n&#8217;a rien à avoir avec le Web. Une playlist n&#8217;a rien à voir avec le Web. Mais il faut un code pour les gérer, et des variables vont devoir êtres mises quelque part.</p>
<p>Généralement, ces providers/services/factories sont utilisés :</p>
<ul>
<li>Par un controller.</li>
<li>Par une directive.</li>
<li>Par d&#8217;autres providers/services/factories.</li>
</ul>
<p>Mais aussi, directement dans le HTML.</p>
<p>En effet, quand vous allez faire ça :</p>
<pre lang="javascript">
// le boulot du controller, c'est essentiellement d'attacher les bons
// services au scope, je vous dis !
mymonAppApp.controller('VideoCtrl', function($scope, playlist) {
    $scope.playlist = playlist;
});</pre>
<p>Vous allez ensuite pouvoir déclarer votre controller dans votre HTML. Dans un<br />
bloc de HTML couvert par un controller, vous avez accès à toutes les attributs<br />
du scope, donc à votre service &#8220;playlist&#8221;. Et du coup, paf, à tout son code :</p>
<pre lang="html">
<div ng-controller="VideoCtrl">
    ...
    <p>Playlist :</p>
    <ul>
       <li ng-repeat="vid for playlist.videos">{{ vid.title }}</li>
    </ul>
    <p>
    <button ng-click="playlist.next()">Next</button>
    </p>
</div></pre>
<p>Et c&#8217;est ça la beauté d&#8217;Angular : tout est bien séparé, et bien rangé. Votre code métier dans les providers, votre code d&#8217;interface dans le HTML, votre liaison entre le HTML et les providers à travers les controllers&#8230; Enfin du code JS qui ne ressemble pas à des spaghetti trop cuites par un enfant de 6 ans scatoman.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/service-factory-et-provider-dans-angularjs/feed/</wfw:commentRss>
		<slash:comments>29</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">10095</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2014/04/o3eChX7.jpg" length="69390" type="image/jpg" />	</item>
		<item>
		<title>Not invented here</title>
		<link>http://sametmax.com/not-invented-here/</link>
		<comments>http://sametmax.com/not-invented-here/#comments</comments>
		<pubDate>Thu, 24 Apr 2014 07:18:30 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[bootstrap]]></category>
		<category><![CDATA[countdown]]></category>
		<category><![CDATA[html5]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[jeu]]></category>
		<category><![CDATA[timer]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=10065</guid>
		<description><![CDATA[Que fait un programmeur quand il n'est pas satisfait ? <del>Il va sur redtube</del> Il réinvente la roue, bien sûr !
]]></description>
				<content:encoded><![CDATA[<p>À la maison on joue beaucoup. Aux jeux vidéo, bien entendu, mais aussi à tout un tas d&#8217;autres trucs, incluant des jeux de rôles, de société, de carte&#8230; Ça joue même de la musique. Il y a un carton qui déborde de cartes magic, l&#8217;indispensable pot plein de dés 6/10/20, et des dizaines de boîtes en tout genre, parfois des titres dont moi-même je n&#8217;ai jamais entendu parlé, un piano à queue, divers lots de baffles et même des contentions psychiatriques. Pour d&#8217;autres jeux.</p>
<p>Je me tâte à faire une rubrique &#8220;jeu&#8221; d&#8217;ailleurs, pour introduire un jeu de plateau de temps en temps.</p>
<p>Évidement, à force de parties, on commence à en avoir plein le cul d&#8217;attendre le tour de l&#8217;autre, donc on joue au chrono. On a tenté le sablier, la montre, le portable, l&#8217;app, et rien n&#8217;est vraiment satisfaisant.</p>
<p>Que fait un programmeur dans ce cas ? Il réinvente la roue, bien sûr !</p>
<p>Voici donc <a href="http://allthatcounts.net/">All That Counts</a>, une Web app qui contient :</p>
<ul>
<li>Des timers.</li>
<li>Des chronos.</li>
<li>Des compteurs de points.</li>
</ul>
<p>C&#8217;est du HTML5 + Javascript, il n&#8217;y a pas de backend. Est inclus un mode offline, donc il suffit de visiter l&#8217;app une fois pour pouvoir toujours l&#8217;utiliser sauf vidange du cache. Magie de Bootstrap, ça marche sur mobile, tablette et destop. Comprendre : design responsive générique.</p>
<p>Sur les navs supportant l&#8217;élément audio, ça gong à la fin des timers.</p>
<p>La page &#8220;Count Down&#8221; est pratique pour faire sa gym, cuire ses œufs et organiser une partie avec des tours limités dans le temps pour 3 joueurs ou plus. Les widgets incluent le temps de dépassement si on a besoin de mettre des pénalités aux escargots et aux stallers.</p>
<p>La partie &#8220;Chrono&#8221;, c&#8217;est gadget pour moi, mais ça pourra peut être servir à certains. J&#8217;y ai collé la possibilité de cumuler des temps de tours, pour les sportifs. Je ne sais pas si c&#8217;est utile, les coureurs me diront. A la limite pour les concours d&#8217;apnée&#8230;</p>
<p>L&#8217;onglet &#8220;Counter&#8221; c&#8217;est pour compter les points quand on a pas de papier ou de jeton, c&#8217;est du dépannage. Ça peut servir aussi pour les gens dont le métier implique de compter des têtes de pipe comme les videurs, les hôtesses de l&#8217;air, etc.</p>
<p>Ce qu&#8217;on utilise le plus est le mode &#8220;Versus&#8221;, qui sert aux duels. C&#8217;est une sorte de <a href="http://fr.wikipedia.org/wiki/Pendule_d%27%C3%A9checs">pendule d&#8217;échecs</a>, avec plusieurs comportements réglables. Par défaut, le passage d&#8217;un décompte à l&#8217;autre se fait automatiquement et manuellement, chaque changement de joueur impliquant une remise à zéro.</p>
<p><del datetime="2014-04-24T08:11:17+00:00">Comme il n&#8217;y a pas de backend, vous pouvez avoir le code source en faisant Ctrl + S, donc je vais pas vraiment me faire chier à le mettre sur github. Déjà, j&#8217;ai du codé en pur JS. Moi. Heureusement qu&#8217;il y a AngularJS, sinon je changeais de métier. Le déploiement, pareil, c&#8217;est Ctrl + C, Ctrl + V, donc je vais pas écrire de doc. L&#8217;utilisation, bon, c&#8217;est des clics sur des boutons labellisés&#8230;</del></p>
<p><a href="https://github.com/sametmax/allthatcounts">Le code source est dispo sur github</a>.</p>
<p>La seule astuce, c&#8217;est qu&#8217;en mode versus, CTRL permet de faire un switch, et SPACE permet de faire pause et resume. Je pense que vous vous en sortirez. C&#8217;est un compteur, pas une navette spatiale.</p>
<p>Si l&#8217;envie incroyable de rajouter des features vous prend, mettez un comment, et je me bougerais le cul pour githuber tout ça.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/not-invented-here/feed/</wfw:commentRss>
		<slash:comments>19</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">10065</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2014/04/Shut-Up-And-Take-My-Rupees.jpg" length="40075" type="image/jpg" />	</item>
		<item>
		<title>Utiliser AngularJs avec le langage de template de Django</title>
		<link>http://sametmax.com/utiliser-angularjs-avec-le-langage-de-template-de-django/</link>
		<comments>http://sametmax.com/utiliser-angularjs-avec-le-langage-de-template-de-django/#comments</comments>
		<pubDate>Tue, 06 Nov 2012 14:29:57 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=2879</guid>
		<description><![CDATA[Par défaut Angular évalue les expressions qui sont marquées par <code>{{}}</code>, exactement comme le langage de template Django. Cela amène à un conflit.]]></description>
				<content:encoded><![CDATA[<p><a href="http://angularjs.org/">AngularJS</a> est vraiment une bibliothèque javascript prometteuse. Je suis en train de jouer avec, avec l&#8217;espoir qu&#8217;un jour elle remplace complètement jQuery + Backbone.js dans tous mes projets.</p>
<p>Une chose qui peut être ennuyeuse cependant, c&#8217;est que par défaut Angular évalue les expressions qui sont marquées par <code>{{}}</code>, exactement comme le langage de template Django. Cela amène à un conflit.</p>
<p>Heureusement on peut changer ces marqueurs à l&#8217;initialisation:</p>
<pre lang="javascript">
var m = angular.module('monApp', []); 
m.config(function($interpolateProvider) { 
    $interpolateProvider.startSymbol('[['); 
    $interpolateProvider.endSymbol(']]'); 
});</pre>
<p>Ici je choisis <code>[[]]</code>.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/utiliser-angularjs-avec-le-langage-de-template-de-django/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">2879</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2012/11/02_amant_placard.jpg" length="60719" type="image/jpg" />	</item>
	</channel>
</rss>
