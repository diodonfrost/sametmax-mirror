<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" >

<channel>
	<title>javascript &#8211; Sam &amp; Max</title>
	<atom:link href="http://sametmax.com/tag/javascript/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Thu, 05 Sep 2019 08:22:03 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.9.7</generator>
<site xmlns="com-wordpress:feed-additions:1">32490438</site>	<item>
		<title>Le don du mois: mobx</title>
		<link>http://sametmax.com/le-don-du-mois-mobx/</link>
		<comments>http://sametmax.com/le-don-du-mois-mobx/#comments</comments>
		<pubDate>Mon, 02 Jul 2018 10:41:28 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[don]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[mobx]]></category>
		<category><![CDATA[react]]></category>
		<category><![CDATA[reactjs]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=24750</guid>
		<description><![CDATA[Quand je vous dis que j'ai donné 50 balles à <a href="https://github.com/mobxjs/mobx">Mobx</a>, c'est que le projet déchire. Et il déchire <strong>malgré</strong> le fait qu'il soit codé en JS.]]></description>
				<content:encoded><![CDATA[<p>Si vous avez suivi un peu les différents <a href="http://sametmax.com/tag/don/">dons du mois</a> au fur et à mesure de la vie du blog, vous avez du vous rendre compte de 2 choses:</p>
<ul>
<li>Le don du mois n&#8217;est pas mensuel. Il est juste limité à un par mois. Ça m&#8217;évite la pression d&#8217;être un bon samaritain. Sauf que du coup, j&#8217;oublie parfois pendant trèèèèèèès longtemps :)</li>
<li>Il n&#8217;y a pas beaucoup de projets JS dans le lot. Ahem.</li>
</ul>
<p>En fait le seul et unique projet JS supporté a été <a href="http://sametmax.com/le-don-du-mois-vue-js/">VueJS</a>. C&#8217;est dire que la barre est haute, étant donné la qualité exceptionnelle de ce projet.</p>
<p>Donc quand je vous dis que j&#8217;ai donné 50 balles à <a href="https://github.com/mobxjs/mobx">Mobx</a>, c&#8217;est que le projet déchire. Et il déchire <strong>malgré</strong> le fait qu&#8217;il soit codé en JS.</p>
<p>Mobx permet, en gros, de surveiller les modifications à une structure de données. Vous posez un marqueur sur la structure, et un sur les fonctions utilisant la structure, et c&#8217;est tout:</p>
<pre lang="javascript">class TodoList {
    @observable todos = []; // dire à mobx de surveiller
}

...

@observer // dire à mobx de tenir à jour
class TodoListView extends Component {
    render() {
        return <ul>
            {this.props.todoList.todos.map(todo =>)}
        </ul>
    }

</pre>
<p> C&#8217;est là la brillance du système: malgré sa simplicité, mobx va récursivement réagir à toute modifications, même sur des données complexes imbriquées; Et calculer toutes les dépendances de chaque fonction pour ne les appeler qu&#8217;au meilleur moment.</p>
<p>C&#8217;est facile à utiliser, et étonnamment rapide à exécuter.</p>
<p>Le résultat ? Quand un client me force à utiliser ReactJS, je saute redux, et je met Mobx à la place. Ca donne <em>presque</em> l&#8217;impression d&#8217;utiliser Vue: le code de manipulation d&#8217;état est simple à comprendre, gentil sur le CPU et les mutations d&#8217;état restent courtes et élégantes. Le reste est toujours moche, mais ça on y peut rien.</p>
<p>Bref, mobx est ce qui rend react acceptable. Et tout ce qui peut apaiser la douleur du dev en front-end n&#8217;a pas de prix.</p>
<p>J&#8217;ai regardé le code source, et la popote interne est bien complexe. Mais à chaque fois que je veux l&#8217;utiliser je me dis que ça ne pourra pas être si simple&#8230; et si.</p>
<p>La page de don, <a href="https://mobx.js.org/donate.html">c&#8217;est par là</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/le-don-du-mois-mobx/feed/</wfw:commentRss>
		<slash:comments>7</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">24750</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2018/07/mmGrMWi.png" length="482085" type="image/jpg" />	</item>
		<item>
		<title>Vue, j&#8217;l&#8217;avais pas vu</title>
		<link>http://sametmax.com/vue-jlavais-pas-vu/</link>
		<comments>http://sametmax.com/vue-jlavais-pas-vu/#comments</comments>
		<pubDate>Sun, 14 May 2017 13:10:42 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[js]]></category>
		<category><![CDATA[react]]></category>
		<category><![CDATA[reactjs]]></category>
		<category><![CDATA[vue]]></category>
		<category><![CDATA[vue.js]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=23281</guid>
		<description><![CDATA[Dans le dernier article, je vous offrais votre dose maintenant obligatoire de bashing de l'écosystème JS. En l’occurrence en suggérant que React était un bouquet de roses avec plus d'épines que de pétales. Mais vue ?]]></description>
				<content:encoded><![CDATA[<p><em>(Pour Max: je t&#8217;ai mis un exemple de code tout fait en bas de page car je sais que ça va te saouler de tout lire)<br />
</em><br />
Elle était facile, mais ça fait des années que le blog est up, je peux pas avoir de l&#8217;inspiration tout le temps.</p>
<p><a href="http://sametmax.com/reaction-a-reactjs/">Dans le dernier article</a>, je vous offrais votre dose maintenant obligatoire de bashing de l&#8217;écosystème JS. En l’occurrence en suggérant que React était un bouquet de roses avec plus d&#8217;épines que de pétales.</p>
<p>Mais bon, si les gens utilisent React, ça n&#8217;est pas QUE parce que c&#8217;est la mode. C&#8217;est parce que cette techno répond à un besoin de plus en plus impérieux en dev front end : avoir un outil valable pour créer des GUI avancées en JS.</p>
<p>Parce que le combo jQuery + moteur de template, ça nous a mené loin, mais on arrive au stade où ça scale plus.</p>
<p>Pas mal de tentatives ont été faites pour répondre au problème : knockout, angular 1, polymer, etc.</p>
<p>La nouvelle génération (react, riot, vue, angular 2+, etc) est beaucoup plus mature et performante, et offre des fonctionnalités très sympas:</p>
<ul>
<li>DOM virtuel qui permet de faire des mises à jour fréquentes sur de très nombreux objets à l&#8217;écran sans freezer le browser.</li>
<li>Découplage très élégant des données et de leurs représentations.</li>
<li>Facilité de manipulation des éléments HTML, des events et du cycle de vie de tout le bordel.</li>
<li>Création de composants graphiques isolés et réutilisables.</li>
</ul>
<p>En gros, partout où on faisait avant <code>$(selecteur).trucmuche(element)</code>, on peut maintenant faire ça plus facilement, plus rapidement et plus proprement. (Par contre Vue/React/etc font pas l&#8217;AJAX, tournez-vous vers <a href="https://github.com/mzabriskie/axios">axios</a> ou gardez jQuery sous le coude).</p>
<p>Bon, si ils offrent TOUS ces éléments là, pourquoi diable est-ce que j&#8217;ai une préférence pour Vue.JS plutôt que Riot, Angular ou React ?</p>
<p>Souvenez-vous, je reprochais essentiellement ceci à React:</p>
<ul>
<li>Grosse courbe d&#8217;apprentissage. Ce qui impacte la productivité de tout nouveau dans l&#8217;équipe.</li>
<li>Mauvaise ergonomie du JSX qui du coup s&#8217;écrit, se lit et se debug lentement.</li>
<li>Mauvaise foi totale de la communauté qui prétend qu&#8217;on peut utiliser React sans la tonne de nutella autour, ce qui est comme argumenter qu&#8217;on peut faire du Java sans IDE.</li>
<li>Nutella sus-nommé qui est blindé d&#8217;huile de palme et de vidange.</li>
<li>Globalement une API inélégante et peu intuitive.</li>
</ul>
<p>Mais alors, qu&#8217;est-ce que <a href="https://vuejs.org/">Vue.js</a> fait de mieux ?</p>
<p>Ben tout, mes amis. Tout.</p>
<h2>Légèreté</h2>
<p>A l&#8217;heure où les codeurs hypes de la vibe du flex ont tous un fichier de conf webpack de 3 km, mais déjà obsolète et qui pétera à la prochaine upgade, Vue offre un point de vue rafraîchissant sur la question.</p>
<p>TOUTE, j&#8217;ai bien dit TOUTE, la puissance de vue.js est accessible avec une simple inclusion de balise script. </p>
<p>Vous en avez marre des pages de 3Mo ? Minifié et gzippé, Vue.js pèse moins de 30ko.</p>
<p>Dans un monde où il faut soit faire un site Web, soit faire une SPA (aux chiottes l&#8217;amélioration progressive !), Vue permet de ne remplacer que quelques bouts de vos pages si vous n&#8217;avez pas envie de tout transformer en un monstre de JS.</p>
<p>La doc, très bien faite, vous permettra de prendre l&#8217;outil en main en une après-midi. En buvant du thé.</p>
<p>Le tout, sans besoin d&#8217;aucun écosystème particulier. Aucun. Rien. Ca marche out of the box.</p>
<p>En gros, là où tout le monde vous vend du scale up, Vue vous permet de scale down.</p>
<h2>Puissance</h2>
<p>Malgré cela, Vue reste parfaitement adaptée aux gros projets. En fait, elle a été créée pour et par l&#8217;équipe du site du géant chinois, alibaba.com. Alors oui, c&#8217;est sûr, c&#8217;est pas Facebook et son milliard d&#8217;utilisateurs, mais comme mes projets ne servent pas 10 millions de pages par jour, contrairement à Alibaba, je pense que je suis ok.</p>
<p>Dans la pratique, qu&#8217;est-ce que ça veut dire ?</p>
<p>Et bien d&#8217;abord, <a href="http://www.stefankrause.net/wp/?p=316">Vue est plus rapide que React</a>. Ouais ça fait mal au cul de lire ça quand on vient de finir d&#8217;optimiser son pipeline de rendu JSX, surtout que la techno a été créée pour la vitesse. Mais voilà, c&#8217;est le cas.</p>
<p>Vue supporte aussi parfaitement l&#8217;inclusion dans un écosystème plus gros si le besoin s&#8217;en fait sentir :</p>
<ul>
<li>Vous pouvez utiliser Vue avec <a href="https://github.com/vuejs-templates/webpack">Webpack</a>.</li>
<li>Vous avez <a href="https://vuex.vuejs.org">un store</a> et <a href="https://vuex.vuejs.org">un routeur</a> pour vue.</li>
<li>Vous pouvez <a href="https://github.com/vuejs/babel-plugin-transform-vue-jsx">utiliser du JSX</a> si vous êtes maso.</li>
<li>Vous pouvez créer des SPA avec une hiérarchie de <a href="https://vuejs.org/v2/guide/components.html">composants</a>.</li>
<li>Vous pouvez faire le <a href="https://vuejs.org/v2/guide/ssr.html">rendu des templates côté serveur</a>.</li>
</ul>
<p>En gros, Vue peut faire absolument tout ce que les autres font. Mais ne vous oblige pas à commencer en sortant le bazooka. Vue est ce que React aurait dû être depuis le début.</p>
<p>Notez qu&#8217;on peut remercier les devs de React pour avoir popularisé de nombreux concepts que Vue utilise. Standing on the giants&#8217; shoulders et tout, et tout. Vue n&#8217;aurait jamais existé sans React. Mais maintenant que Vue est là, on peut laisser React en paix.</p>
<h2>Elégance</h2>
<p>De par son design, Vue vous permet donc de commencer doucement, en ajoutant 30ko à votre projet et en l&#8217;utilisant un peu ici et là. Puis quand vous en avez besoin, vous pouvez commencer à utiliser des fonctionnalités avancées.</p>
<p>Par exemple, vous pouvez comme avec Angular 1 balancer toutes vos variables et binding dans le HTML de votre page en vrac. Et plus tard tout refactoriser en composant comme avec React. Tranquille.</p>
<p>L&#8217;API de Vue est petite, et surtout, facile à comprendre car tout est bien nommé, et bien rangé. Voyez plutôt:</p>
<pre lang="javascript">
Vue({
  el: "#app", // l'élément sur lequel attacher la vue
  created: function(){
    // code lancé au démarrage
  },
  mounted: function(){
    // code lancé quand la vue est attachée à la page
  },
  updated: function(){
    // code lancé quand la vue est mise à jour
  },
  destroyed: function(){
    // code lancé quand la vue est détruite
  }
  data: {
    // ben ici y a vous données statiques
  },
  methods: {
    // ici les fonctions à rendre disponibles dans le HTML
  },
  computed: {
    // ici on met les données à recalculer à la volée
    // à chaque refresh
  }
})
</pre>
<p>Voilà vous avez là 50% de l&#8217;API de Vue. Very hard indeed.</p>
<p>On sent partout que les devs ont apporté des soins à des petits détails comme:</p>
<pre lang="html">
<!-- Lance truc() juste au premier click.
Appelle preventDefault automatiquement. -->
<a v-on:click.once.prevent="truc()">Foo</a>
</pre>
<p>D&#8217;une manière générale, tout template Vue est du HTML valide, ce qui fait qu&#8217;il est très facile d&#8217;insérer du Vue sur un site existant.</p>
<h2>Un petit bout de vue</h2>
<p>Mais alors, pour tous ceux qui en sont restés à jQuery et handlebar.js, à quoi ça ressemble tout ça ?</p>
<p>Ben un todo ressemble à ça en Vue:</p>
<pre lang="html">
<!DOCTYPE html>
<html>
<head>
  <title>Todo</title>
  <script src="https://unpkg.com/vue"></script>
</head>
<body>
<!-- Cette partie va être contrôlée par la vue -->
<div id="app">

<!-- Quand on soumet le formulaire, on ajoute la tâche -->
<form v-on:submit.prevent="addTask(newTask)">
  <!-- L'input est maintenant lié à la variable newTask -->
  <p><input v-model="newTask"> <button>Ajouter</button></p>
</form>

<ul>
  <!-- Créer un li pour chaque tache dans mon array 'tasks' -->
  <li v-for="task in tasks">{{task}}</li>
</ul>
  
</div>

<script type="text/javascript">
app = new Vue({
  el: "#app", // j'attache cette vue à l'élément avec l'id App
  data: {
    tasks: [], // mes tâches seront stockées dans l'array 'tasks'
    newTask: "", // ce que contient l'input du formulaire
  },
  methods: {
    addTask: function(task){
      this.tasks.push(task); // on ajoute la tâche dans l'array
      this.newTask = ""; // on vide l'input
    }
  }
})
</script>

</body>
</html>
</pre>
<p>(Vous pouvez littéralement copier-coller ce code dans un fichier todo.html et ça marche. Essayez de faire ça avec React&#8230;)</p>
<p>Comme avec Angular/React/Riot on a séparé complètement la logique de manipulation des données de celle de l&#8217;affichage qui est mis à jour automatiquement quand les données changent.</p>
<p>Contrairement à React, on n&#8217;est pas obligé de créer un arbre complexe de composants qui transforme toute sa page en soupe de JS(X). Mais contrairement à Angular, on n&#8217;est pas obligé de rester sur cet exemple simple, et on peut créer une hiérarchie de composants. </p>
<p>Un composant peut complètement isoler le JS, le HTML et le CSS (qui n&#8217;affecte alors que le composant):</p>
<p><img src="https://vuejs.org/images/vue-component.png"></img></p>
<p>Et pour que ça marche, pas besoin de préprocesseur, pas besoin de ES6, ES7, typescript, babel, webpack, npm&#8230; Vous pouvez les utiliser. Sur un gros projet je me fais chier à setup ce qui vaut le coup. Mais vous n&#8217;êtes pas obligé. </p>
<h2>La communauté</h2>
<p>La communauté est importante pour un projet, et celle de vue est très agréable. Ce sont des gens polis, humbles, et compétents. Ils pensent aux petits détails. Regardez par exemple <a href="https://vuex.vuejs.org/en/intro.html">cette page</a> pleine de jolis schémas.</p>
<p>En comparaison, la communauté React est criarde. Les confs des devs de Facebook sont faites par <a href="https://www.youtube.com/watch?v=XxVg_s8xAms">des présentateurs tout droit sortis de South Park</a>. Quand on critique react, on se fait insulter personnellement sur twitter par les fan boys plutôt que de tenter de discuter, preuve systématique de l&#8217;absence d&#8217;arguments.</p>
<p>Enfin les seuls éléments donnés pour combattre les critiques sont les raisons des problèmes, un rappel de la taille des utilisateurs et des &#8220;moi j&#8217;aime&#8221; laconiques. </p>
<p>Mais faites un test. Prenez 3 dev, un react, un jquery, un vue. Faites leur faire un agenda CRUD avec recherche et autocompletion qui tape en Ajax dans un backend Django/Rails/Whatever. Donnez leurs des machines vierges. Et sortez le pop corn.</p>
<p>Pour le moment, React possède encore deux avantages: react native, et la masse (fb, les utilisateurs, le nombre de plugins, etc). </p>
<p>Mais honnêtement ? Il y a très peu de bénéfices à utiliser React plutôt que Vue sur la plupart des projets pur Web. Et un coût garanti d&#8217;être élevé.</p>
<p>Angular 1 est en train de mourir de l&#8217;abandon de Google. Après la sucette de l&#8217;incompatibilité d&#8217;Angular 2, je n&#8217;ai aucune confiance en la techno et ne compte donc pas réinvestir de billes dedans. De plus Angular 2+ souffre du même problème d&#8217;obligation d&#8217;installer la terre entière avant de commencer à coder.</p>
<p>Riot est une meilleure alternative, mais l&#8217;obligation de passer par des composants est un no-go IMO. Créer des composants pour moi est l&#8217;exception, pas la règle. Je le fais en dernier, à la phase de refactoring.</p>
<p>Donc ne vous emmerdez pas, prenez quelques heures pour jouer avec Vue, ça coûte pas cher, et c&#8217;est chouette.</p>
<p>&#8212;&#8212;&#8212;&#8212;-</p>
<p>On me signale dans l&#8217;oreillette de linker dans <a href="https://fr.vuejs.org/">la doc française</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/vue-jlavais-pas-vu/feed/</wfw:commentRss>
		<slash:comments>53</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">23281</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2017/05/v1qeO3S.jpg" length="56355" type="image/jpg" />	</item>
		<item>
		<title>Réaction à ReactJS</title>
		<link>http://sametmax.com/reaction-a-reactjs/</link>
		<comments>http://sametmax.com/reaction-a-reactjs/#comments</comments>
		<pubDate>Wed, 10 May 2017 18:39:23 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[js]]></category>
		<category><![CDATA[react]]></category>
		<category><![CDATA[reactjs]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=23244</guid>
		<description><![CDATA[Alors merde, quoi, react, keskeçavo ?]]></description>
				<content:encoded><![CDATA[<p>Grand utilisateur de jQuery, formateur Angular et maintenant adorateur de VueJS, vous vous demandez sûrement ce que je pense de React. Si, je le sais, mon avis est pour vous comme un phare dans la nuit sombre du frontend engluée dans le brouillard de JavaScript.</p>
<p>Après tout, Facebook est codé avec cette techno pixel par pixel, et ils servent des milliards de pages chaque jour. Ça ne peut pas être mauvais. Ce ne sont pas de cons quand même.</p>
<p>Et puis tout le monde en parle, les asticots gigotent autour des restes du gigot d&#8217;ordre que les devs des GAFAS tentent de mettre au menu dans leur régime sans sel et sans typage.</p>
<p>Alors merde, quoi, react, keskeçavo ?</p>
<p>Je vais passer peut être pour un réact (hashtag lol), mais franchement le gigot au brouillard, c&#8217;est pas mon plat préféré.</p>
<p>Taillons un peu JS, ça m&#8217;avait manqué.</p>
<h2>Mon royaume pour un hello world</h2>
<p>React est tellement chiant à setuper que la doc officielle <a href="https://facebook.github.io/react/docs/hello-world.html">vous propose le hello world dans un code pen</a> histoire de pas vous faire fuir tout de suite.</p>
<p>En fait, si pour vous installer un module avec npm/yarn/bower (plutôt que de copier le truc directement ou d&#8217;utiliser un CDN) est déjà un truc qui vous fait grogner, vous êtes loin derrière.</p>
<p>Il va vous falloir un outil de build (gulp, grunt ou l&#8217;usine à Vespene Webpack) et la série de recettes obsolètes customisées trouvées sur un coin de github pour connecter tous les bouts de votre pipeline. React bien sûr, mais aussi Babel pour transformer le JSX en JS.</p>
<p>Babel suit la left-pad philosophie, à savoir que tout est configurable et éclaté en centaines de petites dépendances et settings. C&#8217;est tellement chiant que des packages existent, appelés &#8220;presets&#8221;, dont l&#8217;unique but est de configurer Babel pour une tâche particulière.</p>
<p>Une fois que vous avez tout ça up, vous vous allez à la pêche au tuto, seulement pour remarquer que tout le monde code en ES6, voir ES7, et vous rajoutez donc un peu plus de plugins à tout ce bordel. Allah vous garde si vous tentez d&#8217;utiliser TypeScript.</p>
<p>Et vient alors le moment tant attendu pour faire coucou de la main programmatiquement. Ça foire, bien entendu. Le debugger vous pointe sur un bundle.js de plusieurs Mo, et vous apprenez que le support des sources maps est inégal d&#8217;un navigateur à l&#8217;autre.</p>
<p>Bienvenue.</p>
<h2>Le X c&#8217;est pas toujours excitant</h2>
<p>Une fois passée la douloureuse expérience de mettre en place votre environnement de travail, vous trouvez un certains confort. L&#8217;autoreload de la page est franchement pratique, et pouvoir utiliser l&#8217;unpacking (pardon le spread), les valeurs de paramètres par défaut et les arrow functions sans vous soucier de la compat du navigateur c&#8217;est quand même cool. Avec un webpack tout bien huilé avec amour (et douleur), vous pouvez faire des imports en JS et on a presque l&#8217;impression d&#8217;utiliser un langage de programmation.</p>
<p>Et puis le JSX, de loin ça à l&#8217;air pas mal ! Du HTML directement dans le JS ça parait un peu bizarre mais on vous le vend comme un avantage : finis les langages de templates limités, vous pouvez utiliser la pleine puissance (hum&#8230;) du langage JavaScript pour créer vos balises.</p>
<p>Sauf que non, le JSX, ça pue du cul.</p>
<p>D&#8217;abord, il y a le fait que toutes les structures sont à faire en JS. Les conditions, les concaténations et bien entendu, les boucles. Donc vous avez une liste de noms et numéros de téléphone, en VueJS, vous faites:</p>
<pre lang="html"><ul>
    <li v-for="pers in persons" v-if="pers">
        <strong>{{ pers.nom }} </strong>: {{ pers.tel }} 
    </li>
    <li v-else>
        <em>Nobody's here!</em>
    </li>
</ul></pre>
<p>Mais en React, vous allez faire péter une expression ternaire et une fonction anonyme en plein milieu rien que pour l&#8217;occasion:</p>
<pre lang="jsx"><ul>
    {
      (this.state.persons)
        ? this.state.persons.map((pers) => (
            <li><strong>{ pers.nom } </strong>: { pers.tel } </li>
        ))
        : (
            <li>
                <em>Nobody's here!</em>
            </li>
        )
    }
</ul></pre>
<p>Vous la sentez bien la puissance de JavaScript là ?</p>
<p>Et attention à ces boucles, car dedans vous guette cette erreur qui va vous poursuivre jusque dans vos cauchemars:</p>
<pre>
SyntaxError: Adjacent JSX elements must be wrapped in an enclosing tag</pre>
<p>Babel vous signale gentiment que ne pouvez pas produire un snippet de JSX qui contienne plus d&#8217;un élément à la racine. Donc il faut TOUT wrapper dans un container. TOUT. Vous allez avoir vite des DIVs et des SPANs inutiles partout, juste pour faire plaisir à React. C&#8217;est absurde. C&#8217;est à vomir. Ca nique votre CSS et remplit vos sessions &#8220;examinez un élément&#8221; de tendinites dues aux clics pour déplier tout l&#8217;arbre des emballages cadeaux de vos balises. Et aussi, nique la sémantique.</p>
<p>Pour éviter ça vous allez tenter d&#8217;inliner un maximum de trucs dans une seule expression JSX ou tout foutre dans des arrays. Car je ne l&#8217;ai pas précisé ? Les arrays de JSX sont automatiquement et magiquement convertis en sous-éléments. Et du coup vous pourrez profiter au maximum des qualités de lisibilité de JS.</p>
<p>JSX est bourré de petits trucs comme ça, pour faire plaisir.  Par exemple, j&#8217;ai un bouton, quand je le clique il delete la personne de la ligne de mon agenda. Je mets aussi une classe pour tous et une selon que la personne est importante ou non. Un prevent default pour éviter que le browser recharge la page si je suis dans un form.</p>
<p>En Vue, je passe un objet qui dit quelle classe afficher ou non. Le click handler contient une instruction <code>prevent</code> qui me permet d&#8217;appeler <code>preventDefault</code> automatiquement. Et j&#8217;appelle <code>deletePerson</code> tout naturellement :</p>
<pre lang="html"><button class="{'delete-person': true, 'important-person': pers.isImportant}" 
        v-on:click.prevent="deletePerson(pers)">
    Delete
</button></pre>
<p>En react, on ne peut pas passer de paramètre à son handler. Il faut le passer dans une closure. Mais alors la closure va recevoir l&#8217;objet event, qu&#8217;on doit donc faire suivre à notre handler, afin qu&#8217;il puisse appeler <code>preventDefault</code> à la main. A noter aussi que <code>class</code> s&#8217;appelle <code>className</code>. Et n&#8217;accepte que des strings donc la concaténation se fait à la mano.</p>
<pre lang="html">// plus haut on appelle preventDefault dans handleDelete

<button className={'delete-person ' + (pers.isImportant ? 'important-person': '')}
        onClick={(e) => this.deletePerson(pers, e)}>
    Delete
</button>
</pre>
<p>Ce n&#8217;est pas juste chiant à lire, c&#8217;est surtout hyper chiant à trouver, à taper et à debugger. </p>
<h2>Un peu de nutella sur votre confiture ?</h2>
<p>React, c&#8217;est verbeux, il va falloir vous y faire. Il suffit de comparer <a href="https://github.com/tastejs/todomvc/tree/gh-pages/examples">le code nécessaire</a> pour faire une TODO en react avec les autres frameworks.</p>
<p>Mais ce n&#8217;est pas juste ça qui est lourd.</p>
<p>Non, le vrai truc qui est super pesant, c&#8217;est que react est un cancer. Quand il est utilisé, il contamine tout.</p>
<p>Par principe, une fois que vous utilisez react, il faut mettre TOUTE VOTRE PAGE en react. Pas juste un petit bout. Par là j&#8217;entends que 90% de votre HTML va devoir migrer dans le code JSX. Votre beau code HTML bien propre, converti en cette monstruosité de mélange entre le langage le plus dégueulasse du monde et un monstre mimic qui essaye de se faire passer pour du HTML pour vous bouffer.</p>
<p>Or, toute l&#8217;idée c&#8217;est de faire des composants, de diviser votre pages en plus petits bouts. Mais voilà, React n&#8217;a rien prévu de simple pour la communication. Pour passer des données des composants enfants, il faut les passer via les attributs de balise HTML (appelés les props, pour faciliter la rechercher Google). Si vous avez 5 niveaux d&#8217;imbrications, vous vous tapez ça 5 fois.</p>
<p>Plus amusant, il n&#8217;y a aucun mécanisme pour passer des infos de l&#8217;enfant aux parents. La méthode standard est d&#8217;écrire puis passer manuellement un callback du parent à l&#8217;enfant, via props, et appeler ce callback dans l&#8217;enfant avec la valeur que le parent utilise ensuite. POUR. CHAQUE. PUTAIN. DE. VALEUR.</p>
<p>Passer des callbacks, ça va 5 minutes. Et ça ne résout pas un problème de communication entre composants parallèles, c&#8217;est à dire ni parent, ni enfant. Du coup tout le monde finit par utiliser une lib supplémentaire type <code>EventEmitter</code> pour servir de bus de communication.</p>
<p>Quand vous entendez les gens se plaindre de la difficulté d&#8217;utiliser l&#8217;écosystème de react, les fans répondent souvent que l&#8217;écosystème n&#8217;est pas obligatoire. On peut très bien s&#8217;en passer sur un petit projet. </p>
<p>Sauf que react est absolument inutilisable sans. Sans un bus d&#8217;event, un transpiler ES6 + JSX, un builder et un hot reloader au mininum, le projet ne dépasse jamais le stade du prototype.</p>
<p>Mais bon soyons franc, beaucoup de projets react tout court ne dépassent jamais le stade du prototype. On parle de codeurs JS là.</p>
<h2>Etat</h2>
<p>Les props ne doivent jamais changer. Seul l&#8217;état d&#8217;un composant react peut changer, ce qui trigger un nouveau rendu du composant.</p>
<p>Mais l&#8217;état lui-même est en read-only. On est supposé uniquement créer un nouvel état à chaque fois et remplacer l&#8217;ancien.</p>
<p>Au début on le fait à la main, mais JS n&#8217;est pas vraiment fait pour faire de l&#8217;immutabilité, et ça devient uber chiant très vite. Changer la propriété d&#8217;un objet qui est lui même dans un array demande de recréer tout l&#8217;array et l&#8217;objet. A chaque fois.</p>
<p>On se tourne alors vers des libs (encore une) type immutable.js qui fournit des listes et maps qui sont immutables et permettent de faire ces opérations sans y laisser ses jours de congé.</p>
<p>Une fois de plus, les connards qui vous disent qu&#8217;on peut faire du react sans la tonne de boiler plate qu&#8217;on voit dans les tutos ne le font jamais eux-mêmes. Parce que oui, on peut faire Paris-Amiens à pied en théorie, mais bon&#8230;</p>
<h2>Des décisions à la con</h2>
<p>Clairement, react a été fait pour créer des UI. Mais au bout d&#8217;un moment, les utilisateurs se sont réveillés et ont voulu une encapsulation pour des composants non UI. Mais react ne sait pas faire. Quand vous avez donc un composant non UI, par exemple la déclaration de votre routing, vous le déclarez&#8230; en JSX:</p>
<pre lang="jsx">  render((
      <Router history={browserHistory}>
        <Route path="/foo" component={FooView}/>
        <Route path="/bar" component={BarViw}/>
      </Router>
  ), document.getElementById('app'))</pre>
<p>Votre app va devenir très vite une pyramide de composants, certains qui s&#8217;affichent, d&#8217;autres non, tous se passant en cascade des données les uns aux autres.</p>
<p>Et au passage, quel est l&#8217;abruti qui a décidé des noms des méthodes des cycles de vie comme <code>getInitialState</code>, <code>componentWillMount</code> et <code>componentDidMount</code> ? </p>
<p>Surtout que vos méthodes et les méthodes héritées de la classe du component sont dans le même espace de nom.</p>
<h2>Le bonheur des stores</h2>
<p>Un truc dont on peut vraiment se passer par contre, ce sont les stores. Flux, redux, vuex, etc. On peut utiliser n&#8217;importe quelle solution pour stocker l&#8217;état de son projet côté client.</p>
<p>Mais si vous voulez profiter des promesses de react, comme le time travel et la concurrence parfaite, il vous faudra un store. </p>
<p>&#8220;store&#8221; c&#8217;est le nom huppé que react donne à ses modèles. Je ne vais pas rentrer dans les détails, et vous laissez décider par vous même du truc. Voici, comment la doc vous recommande d&#8217;ajouter une personne dans une liste d&#8217;un agenda avec redux, la store la plus populaire:</p>
<pre lang="jsx">
// Les imports
import React from 'react';
import { render } from 'react-dom';
import { createStore } from 'redux';
import { Provider } from 'react-redux';

// creation du store
const initialState = {'agenda': []};

function reducer(state=initialState, action){
  switch (action.type) {
    case 'ADD_PERSON':
      return {
        'agenda': [..., action.object]
      }
    default:
      return state
  }
}

const store = createStore(reducer);


// creation de l'action d'ajouter un objet dans le store

function addPersonAction(obj){
    return {
        'type': 'ADD_Person',
        'object': obj
    };
}


export function addPerson(Person){
    store.dispatch(addPersonAction(Person));
}


// composant qui affiche le form de l'agenda et la liste des personnes
var Agenda = React.createClass({

  handleAdd: function(){
      addPerson({
        "name": this.refs.name.value,
        "tel": this.refs.tel.value
      })
  },

  render: function(){

    return <form onClick={this.handleAdd}>
        <p><input ref="name" /><input ref="tel" /><button>Add</button></p>
    </form>

    <ul>
        {
            this.store.agenda.map((pers) => (
                <li><strong>{ pers.nom } </strong>: { pers.tel } </li>
            ))
        }
    </ul>
  }


});


// adapter qui permet de passer le store à l'agenda
const AgendaContainer = connect(function(state){
    return {'agenda': state.get("agenda")};
})(Agenda);


// affichage du bouzin
render((
<Provider store={store}>
  <AgendaContainer>
</Provider>
), document.getElementById('app'))</pre>
<p>Vous imaginez bien que trouver ça tout seul a été un bonheur. Parce que oui, la doc est absolument à chier, dans la longue tradition des stacks JS modernes.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/reaction-a-reactjs/feed/</wfw:commentRss>
		<slash:comments>37</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">23244</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2017/05/MH6XS6B.gif" length="523818" type="image/jpg" />	</item>
		<item>
		<title>Le don du mois : vue.js</title>
		<link>http://sametmax.com/le-don-du-mois-vue-js/</link>
		<comments>http://sametmax.com/le-don-du-mois-vue-js/#comments</comments>
		<pubDate>Mon, 01 May 2017 08:37:43 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Philo et culture]]></category>
		<category><![CDATA[don]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[js]]></category>
		<category><![CDATA[vue]]></category>
		<category><![CDATA[vue.js]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=23211</guid>
		<description><![CDATA[Le pognon rentre à nouveau et c'est donc le retour du don du mois.]]></description>
				<content:encoded><![CDATA[<p>Le pognon rentre à nouveau et c&#8217;est donc le retour du don du mois.</p>
<p>Ça ne fait que quelques temps que j&#8217;utilise <a href="https://vuejs.org/">Vue.js</a>, mais globalement c&#8217;est déjà mon outil par défaut pour toute UI en JS.</p>
<p>J&#8217;ai encore des demandes de formations et projets pour Angular 1 et React, mais si j&#8217;ai le choix il n&#8217;y a aucune hésitation.</p>
<p>J&#8217;ai essayé quelques alternatives, comme Riot, mais on arrive jamais à cette combinaison parfaite de simplicité, légèreté, puissance et performance. Ce projet est un petit bijoux du monde de l&#8217;open source. Un truc rare en Javascript.</p>
<p>Bref, c&#8217;est bien beau de cracher toujours sur JS, mais ça résout pas le problème. Il faut aussi aider, et c&#8217;est donc pour ça que je fais un don de 50 €, <a href="https://vuejs.org/support-vuejs/">par ici</a>.</p>
<p>Et si vous regrettiez l&#8217;époque de la simplicité de jQuery mais que vous avez envie de quelque chose qui automatise bien plus comme un framework moderne, vous savez ce qu&#8217;il vous reste à essayer :)</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/le-don-du-mois-vue-js/feed/</wfw:commentRss>
		<slash:comments>18</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">23211</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2017/05/trJulgf.jpg" length="20067" type="image/jpg" />	</item>
		<item>
		<title>Puis-je copier/coller mon brave ?</title>
		<link>http://sametmax.com/20808/</link>
		<comments>http://sametmax.com/20808/#comments</comments>
		<pubDate>Sun, 23 Oct 2016 07:41:48 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[api]]></category>
		<category><![CDATA[clipboard]]></category>
		<category><![CDATA[copier/coller]]></category>
		<category><![CDATA[html5]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[js]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=20808</guid>
		<description><![CDATA[Sebsauvage a partagé <a href="http://sebsauvage.net/links/?cKAfaQ">un snippet</a> pour utiliser l'API du clipboard en JS. Et j'ai donc voulu savoir comment détecter que cette functionalité est implémentée par le navivateur en cours. ]]></description>
				<content:encoded><![CDATA[<p>Dans <a href="0bin.net">0bin</a> on utilise encore flash pour faire le copier/coller, et je pense qu&#8217;on va le virer. Plus de raison de supporter les navigateurs trop vieux et après tout c&#8217;est pas grave de se voir refuser un raccourci pour copier/coller : le reste est utilisable.</p>
<p>Pourquoi je vous dis ça ?</p>
<p>Et bien parce que sebsauvage a partagé <a href="http://sebsauvage.net/links/?cKAfaQ">un snippet</a> pour utiliser l&#8217;API du clipboard en JS. Et j&#8217;ai donc voulu savoir comment détecter que cette functionalité est implémentée par le navigateur en cours. </p>
<p>Je suis ainsi allé voir <a href="https://github.com/Modernizr/Modernizr/pull/659/commits/7354ab3e0167ced43df9fae43c13c25a10f36fcf">les sources de modernizr</a>, et il implémente en fait une combinaisons de 2 techniques.</p>
<p>D&#8217;abord, vérifier si l&#8217;objet <code>window</code> a un attribut <code>ClipboardEvent</code>. Si oui, c&#8217;est réglé. Si non, il crée un <code>div</code>, on check s&#8217;il a un attribut <code>paste</code>. Le reste sont <a href="http://perfectionkills.com/detecting-event-support-without-browser-sniffing/">les hacks de compatibilité</a> avec les très vieux navs que je ne vais pas retranscrire ici.</p>
<p>Donc en gros, avant de faire un copier/coller en JS, vérifiez:</p>
<pre lang="javascript">function implementClipboardAPI(){
   try {
     return (!!window.ClipboardEvent || 'onpaste' in document.createElement('div'));
   } catch(e) {
     return false;
   }
}
</pre>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/20808/feed/</wfw:commentRss>
		<slash:comments>6</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">20808</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2016/10/JUaJo1o.jpg" length="105114" type="image/jpg" />	</item>
		<item>
		<title>La communauté JS est actuellement une machine à créer de la dette technique</title>
		<link>http://sametmax.com/la-communaute-js-est-actuellement-une-machine-a-creer-de-la-dette-technique/</link>
		<comments>http://sametmax.com/la-communaute-js-est-actuellement-une-machine-a-creer-de-la-dette-technique/#comments</comments>
		<pubDate>Tue, 12 Jan 2016 12:45:08 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[javascript]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=17772</guid>
		<description><![CDATA[Vous savez, quand on ne brule pas un Troll, ses blessures se soignent rapidement, et il attaque à nouveau.]]></description>
				<content:encoded><![CDATA[<p>Vous savez, quand on ne brule pas un Troll, ses blessures se soignent rapidement, et il attaque à nouveau.</p>
<p>Et vous savez également comme <a href="http://sametmax.com/un-gros-troll-de-plus-sur-javacscript/">j’aime troller JS</a>. </p>
<p>De plus, il y a quelque temps, je vous affirmais que <a href="http://sametmax.com/non-nodejs-nest-pas-mature/" title="Non, nodejs n’est pas mature">NodeJS n’était pas mature</a>.</p>
<p>Est-ce que l’écosystème JS a muri depuis ?</p>
<p>Et bien maintenant je crois qu’on a passé l’enfance, et qu’on est dans la phase de l’adolescence. Ca crie, ça bouge, ça a plein d’énergie, et ça mérite des baffes.</p>
<p>Je sais, je sais, je vais encore avoir une horde de fans boys qui aiment le typage mou et les champs de moustaches venir me dire que je devrais arrêter d’écrire, de coder et m’enfoncer la version imprimée de Wikipédia dans l’anus.</p>
<div id="attachment_17777" style="width: 714px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2016/01/h0dDER3.jpg" class="grouped_elements" rel="tc-fancybox-group17772"><img src="http://sametmax.com/wp-content/uploads/2016/01/h0dDER3.jpg" alt="According to this, you&#039;re a hérétic" width="704" height="899" class="size-full wp-image-17777" /></a><p class="wp-caption-text">Comment on appelle l’adulation de quelque chose par une communauté en dépit de toute rationalité déjà ?</p></div>
<p>Mais dans l’histoire de JS, y a pas eu un moment qui ne méritait pas un bon article de ce genre. A croire que c’est volontaire.</p>
<p>En l’occurrence, j’ai eu envie d’écrire cet article à la suite de plusieurs évènements successifs:</p>
<ul>
<li>Je me suis mis à React, et ai du remettre à jour, encore une fois, tout mon env de dev JS.</li>
<li>J’ai discuté avec des clients qui ont voulu mettre ça en place et qui ont fait marche arrière, car impossible de choisir une stack.</li>
<li>J’ai fait des formations AngularJS 1 pour des grosses boites qui vont faire tout avec malgré le fait que le 2 arrivent et <a href="http://www.i-programmer.info/news/167-javascript/7932-angularjs-20-is-radically-different-.html">casse tout</a>.</li>
<li>Mozilla annonce <a href="https://news.ycombinator.com/item?id=10884893">la cloture de persona.org</a> (et merde&#8230;) et publie son code NodeJS en open source. Et c’est une très vieille version (0.4.5) ce qui fait qu’on lit des comments du genre : <q><em>it’s F/OSS, but I&#8217;d strongly suggest learning from Persona’s design rather than directly re-hosting the code</em></q></li>
<li>Je suis tombé sur <a href="https://medium.com/@wob/the-sad-state-of-web-development-1603a861d29f#.lwhulrh0i">un article déprimant sur l’état du front end</a> qui m’a semblé sortir directement de ma tête.</li>
<li>J’utilise <a href="https://noscript.net/">NoSript</a> depuis quelque temps et je constate un nombre incroyable de pages qui devraient être statiques ou quasi-statiques et qui sont inutilisables avec le JS désactivés.</li>
<li><a href="http://idlewords.com/talks/website_obesity.htm">Les pages Web deviennent de plus en plus obèses.</a></li>
</ul>
<div id="attachment_17778" style="width: 510px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2016/01/EBexR3B.gif" class="grouped_elements" rel="tc-fancybox-group17772"><img src="http://sametmax.com/wp-content/uploads/2016/01/EBexR3B.gif" alt="Homme se servant du whisky" width="500" height="281" class="size-full wp-image-17778" /></a><p class="wp-caption-text">Laissez-moi reprendre un peu de force pour la suite</p></div>
<p>Donc, reprenons.</p>
<p>NodeJS est toujours splitté entre <a href="https://github.com/nodejs/node-convergence-archive">3 versions</a> : Node, Io.JS et convergence.</p>
<p>Il y a plus de frameworks front end que jamais : Angular, React, Amber, Backbone, Polymer, ExtJS, Aurelia, Durandal, Knockout, Mithril, MarionetteJS, Vue.js, Meteor, etc. Et je ne liste que les plus connus, car <a href="http://todomvc.com/">la liste est interminable</a>.</p>
<p>Ils ont tous des versions différentes, des addons (qui ont des versions et des dépendances), des docs et tutos répartis un peu partout..</p>
<p>Par dessus ça, on rajoute les langages qui compilent vers du JS qui eux aussi se multiplient comme les gremlins mouillés: Coffeescript, Dart, GWT, Closure, Haxe, Elm, TypeScript, Brython, Skulpt, PyJS, etc. Vous voulez, un listing complet ? <a href="https://github.com/jashkenas/coffeescript/wiki/List-of-languages-that-compile-to-JS">Attention ça pique les yeux</a>.</p>
<p>En clair, la seule chose que les gens aiment autant que de pallier l’absence de library standard de JS est de pallier la syntaxe de JS.</p>
<div id="attachment_17781" style="width: 610px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2016/01/CXB8u6OWMAAJJlI.png" class="grouped_elements" rel="tc-fancybox-group17772"><img src="http://sametmax.com/wp-content/uploads/2016/01/CXB8u6OWMAAJJlI.png" alt="The 5 steps of software development" width="600" height="582" class="size-full wp-image-17781" /></a><p class="wp-caption-text">A cela s’ajoute le problème que visiblement les devs JS et le reste du monde n’en sont pas à la même phase. Ils en sont toujours au déni.</p></div>
<p>Mais on ne peut pas blâmer uniquement le langage. La communauté JS a pris la modularité tellement à l’extrême qu’aucune solution standard ne s’est démarquée pour rien : outils de build, libs de tests, solutions de routing, toolings fonctionnels, et même packages managers&#8230;</p>
<p>Même à l’intérieur d’un écosystème, c’est les poupées russes. Par exemple React peut être accompagné d’un pattern que Facebook appelle Flux. C’est du MVC monodirectionnel. Les modèles sont immutables. Le contrôleur est à base d’évènements. Les vues sont gérées par des widgets React. Rien de fou, mais ça faisait pas assez innovant alors ils ont inventé un nouveau nom.</p>
<p>Bref, ils ont leur propre implémentation, mais même la référence n’a pas gagné la guerre. Non, en JS, ça a déclenché immédiatement un concours de celui qui pisse le plus loin et vous pouvez (devez ?) choisir entre : Flux, redux, alt, reflux, flummox, fluxible, fluxxor, marty.js, fynx, MacFly, DeLorean.js, fluxify, fluxury, exim, fluxtore, Redx, fluxx. <a href="https://github.com/kriasoft/react-starter-kit/issues/22">Les noms ne sont pas une tentative d’humour de ma part</a>.</p>
<p>Ce qui donne les comments du genre :</p>
<blockquote><p>What a wonderful example of the paradox of choice!</p>
<p>No wonder that it’s easier to get started with Meteor + React, than with Flux + React.</p></blockquote>
<p>Pour rappel, Meteor est le truc le plus expérimental qui existe en termes de stack techno à l’heure actuelle.</p>
<p>Évidemment tous ces projets ont une documentation succincte, une durée de vie aléatoire, et on peut déjà lire des trucs comme :</p>
<blockquote><p>Flummox 4.0 will likely be the last major release. Use Redux instead.</p></blockquote>
<div id="attachment_17782" style="width: 455px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2016/01/vuF9Nuq.gif" class="grouped_elements" rel="tc-fancybox-group17772"><img src="http://sametmax.com/wp-content/uploads/2016/01/vuF9Nuq.gif" alt="The future starts now" width="445" height="196" class="size-full wp-image-17782" /></a><p class="wp-caption-text">Ton projet</p></div>
<p>Et ils ne sont pas compatibles entre eux. Et en fait ils ne font pas exactement la même chose :</p>
<blockquote><p>how does redux &#8220;replace&#8221; flummox, exactly? Seems like they have two very different approaches</p></blockquote>
<p>Je vous mets les comments car je sais que vous n’avez pas le temps d’aller lire, et encore moins d’étudier chacun de ses projets pour décider duquel utiliser, déjà qu’il faut apprendre React&#8230; A vous ne saviez pas ce qu’était React ? Mais vous êtes à la bourre dites donc !</p>
<p>Rassurez-vous, choisir ce genre de techno a seulement un impact sur tout le code front de votre projet. C’est tout.</p>
<p>Mais les outils s’améliorent, et JS est de plus en plus facile à coder. Pas vrai ? Pas vrai ?</p>
<div id="attachment_17780" style="width: 350px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2016/01/sEXYtO1.jpg" class="grouped_elements" rel="tc-fancybox-group17772"><img src="http://sametmax.com/wp-content/uploads/2016/01/sEXYtO1.jpg" alt="On a créé un robot qui adore jour du piano, et on lui a mis des moufles" width="340" height="355" class="size-full wp-image-17780" /></a><p class="wp-caption-text">L’avancée technique ne veut pas forcément dire que la vie est plus belle</p></div>
<p>Nope.</p>
<p>React fait ramer misérablement la console de debug de Firefox.</p>
<p>Les préprocesseurs ont tout envahi, et si vous choisissez 4 libs, l’un sera en ES6, l’autre en typescript et la troisième en Dart. Et il faut un setup de connard pour debug du code de préprocesseur confortablement : détecteur de changement, builder, injecteur de code, source mapper&#8230;</p>
<p>Les frameworks comme Angular ou React ont une gestion d’erreur bien à eux, qui affichent des messages chelous.</p>
<div id="attachment_17779" style="width: 510px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2016/01/hZgVIXH.gif" class="grouped_elements" rel="tc-fancybox-group17772"><img src="http://sametmax.com/wp-content/uploads/2016/01/hZgVIXH.gif" alt="Homme transpercé au torax par un tuyau" width="500" height="269" class="size-full wp-image-17779" /></a><p class="wp-caption-text">Pourquoi ça marche pas ? Ben&#8230;</p></div>
<p>L’installation est devenue un enfer. Entre les dépendances dépréciées, les libs incompatibles, les différents outils de build, et les options de config et les plugins, c’est une merde incommensurable. Plusieurs standards d’installeurs (et outils joints) se tirent la bourre : <a href="https://addyosmani.com/writing-modular-js/">AMD, CommonJS et Harmony</a>. Vous vous souvenez du temps ou on copiait juste jQuery dans le répertoire static ?</p>
<p>Attendez, avec Webassembly on pourra même plus faire &#8220;read source&#8221;.</p>
<p>Donc JS&#8230;</p>
<p>On peut faire plus de choses qu’avant. De manière plus propre (enfin propre, on parle de JS là&#8230;).</p>
<p>Mais l’écosystème, c’est le bordel général, l’anarchie totale, et ça continue d’avancer, en laissant tout le reste derrière.</p>
<p>Les projets JS s’accumulent, de freelances en SS2I qui se pointent, codent ou (surtout) recodent, et repartent en laissant un projet qu’il sera imbuvable à reprendre, déprécié avant même d’être terminé, non documenté, non testé. </p>
<p>Un projet jetable.</p>
<div id="attachment_17776" style="width: 510px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2016/01/gCXypHD.gif" class="grouped_elements" rel="tc-fancybox-group17772"><img src="http://sametmax.com/wp-content/uploads/2016/01/gCXypHD.gif" alt="Judge dread regarde bruler " width="500" height="211" class="size-full wp-image-17776" /></a><p class="wp-caption-text">Ca vallait le coup de quitter PHP</p></div>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/la-communaute-js-est-actuellement-une-machine-a-creer-de-la-dette-technique/feed/</wfw:commentRss>
		<slash:comments>106</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">17772</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2016/01/sZYI6tt.jpg" length="20894" type="image/jpg" />	</item>
		<item>
		<title>Aux couleurs du site</title>
		<link>http://sametmax.com/aux-couleurs-du-site/</link>
		<comments>http://sametmax.com/aux-couleurs-du-site/#comments</comments>
		<pubDate>Wed, 22 Jul 2015 10:41:26 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[multiboards]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=16645</guid>
		<description><![CDATA[On est en train de tweaker un peut <a href="http://multiboards.net/">multiboards.net</a> Max et moi, et il a voulu ajouter un feature rigolote : les flux sont affichés avec une palette de couleur proche de celle du site. ]]></description>
				<content:encoded><![CDATA[<p>On est en train de tweaker un peu <a href="http://multiboards.net/">multiboards.net</a> Max et moi, et il a voulu ajouter un feature rigolote : les flux sont affichés avec une palette de couleurs proche de celle du site.</p>
<p>Comme récupérer les couleurs d&#8217;un site est compliqué, on s&#8217;est rabattus sur les couleurs du favicon, qui en théorie doit résumer l&#8217;identité d&#8217;un site. Ce n&#8217;est pas parfait, mais c&#8217;est plus simple à implémenter.</p>
<p>Au début, on avait écrit une solution avec Pillow et numpy. Ça marchait très bien, mais des extensions compilées juste pour faire de la déco c&#8217;était un peu lourd, surtout si un jour on libère le code source (mais vu comme les sources sont dégueues et qu&#8217;on a pas de doc, pour le moment c&#8217;est pas gagné).</p>
<p>On a donc changé notre fusil d&#8217;épaule, et on a choisit une nouvelle technique : faire la moitié du taff côté client.</p>
<h2>Récupérer le favicon côté serveur</h2>
<p>On ne peut pas faire des requêtes cross domain en JS, donc on doit toujours récupérer l&#8217;image côté serveur. <code>get_favicon_url()</code> parse le site à coup de regex (c&#8217;est mal mais ça évite de rajouter BeautifulSoup en dépendance pour une balise) pour récupérer son URL sur la page donnée, ou à défaut, sur la page à la racine du site. On se donne plusieurs essais en cas d&#8217;erreurs de réseau :</p>
<pre lang="python">

import urllib
import urlparse 

def get_favicon_url(url, retry=3, try_home_page=True):
    """ Try to find a favicon url on the given page """

    parsed_url = urlparse.urlparse(url)
    url_root = "%s://%s" % (parsed_url.scheme, parsed_url.netloc)

    try:
        # try to get it using a regex on the current URL
        html = fetch_url(url, retry=retry)
        html = html.decode('ascii', errors='ignore')
        pattern = r"""
                               href=(?:"|')\s*
                               (?P<favicon>[^\s'"]*favicon.[a-zA-Z]{3,4})
                               \s*(?:"|')
                          """

        match = re.search(pattern, html, re.U|re.VERBOSE)
        favicon_url = match.groups()[0]

    except IOError:
        # this is a network error so eventually, let it crash
        if not try_home_page:
            raise
        # try with the home page, maybe this one is accessible
        favicon_url = get_favicon_url(url_root, retry=retry,
                                                       try_home_page=False)
    except (IndexError, AttributeError):
        # url is not on this page, try the home page
        if try_home_page:
            return get_favicon_url(url_root, retry=retry, try_home_page=False)

        # can't find the favicon url, default to standard url
        favicon_url = '/favicon.ico'

    # make sure to have the domain of the original website in the favicon url
    if url_root not in favicon_url:
        favicon_url = "%s/%s" % (url_root, favicon_url.lstrip('/'))

    return favicon_url


def fetch_favicon(url, retry=3):
    """ Returns the bytes of the favicon of this site """
    favicon_url = get_favicon_url(url, retry=retry)
    return fetch_url(favicon_url, retry=retry)
</pre>
<p><code>fetch_favicon()</code> télécharge l&#8217;image proprement dite et retourne les bits tels quels. Notez que tout ça est synchrone et bloquant, mais heureusement le traffic de multiboards est sans doute trop faible pour poser problème.</p>
<h2>Exposer le résultat au client</h2>
<p>Ensuite il faut faire le lien entre le client et le serveur. On fait donc un petit routing (c&#8217;est du bottle) qui va retourner tout ça en base64 afin qu&#8217;on puisse l&#8217;utiliser directement dans un objet <code>Image</code> JS :</p>
<pre lang="python">

import base64
from bottle import post, HTTPError

@post('/favicon')
def fetch_favicon_base64():
    """ Return the favicon URL from a website """
    try:
        url = request.POST['url']
    except KeyError:
        raise HTTPError(400, "You must pass a site URL")
    try:
        # return favicon as base64 url to be easily included in
        # a img tag
        favicon = fetch_favicon(url)
        return b'data:image/x-icon;base64,' + base64.b64encode(favicon)
    except (IOError):
        raise HTTPError(400, "Unable to find any favicon URL")</pre>
<h2>Récupérer la palette côté client</h2>
<p>Avec un peu d&#8217;AJAX sur notre vue, on récupère les bits de l&#8217;image, et on fout le tout dans un objet <code>Image</code> qu&#8217;on passe à la lib <a href="http://lokeshdhakar.com/projects/color-thief/">ColorThief</a>. Cette dernière nous renvoie un array avec la palette. On convertit tout ça en code hexadécimal, et on diminue la luminosité de certaines couleurs pour rendre le texte plus lisible.</p>
<pre lang="javascript">
 $.post('/favicon', {url: url}).done(function(data){

        // load an image with the base64 data of the favicon
        var image = new Image;
        image.src = data;
        image.onload = function() {

            // ask ColorThief for the main favicon colors
            var colorThief = new ColorThief();
            var bc = colorThief.getPalette(image);

            // some tools to convert the RGB array into
            // rgb hex string
            function componentToHex(c) {
                var hex = c.toString(16);
                return hex.length == 1 ? "0" + hex : hex;
            }

            function rgbToHex(array) {
                return componentToHex(array[0]) + componentToHex(array[1]) + componentToHex(array[2]);
            }

            // make the color brigther
            function increase_brightness(hex, percent){

                // convert 3 char codes --> 6, e.g. `E0F` --> `EE00FF`
                if(hex.length == 3){
                    hex = hex.replace(/(.)/g, '$1$1');
                }

                var r = parseInt(hex.substr(0, 2), 16),
                    g = parseInt(hex.substr(2, 2), 16),
                    b = parseInt(hex.substr(4, 2), 16);

                return '' +
                   ((0|(1<<8) + r + (256 - r) * percent / 100).toString(16)).substr(1) +
                   ((0|(1<<8) + g + (256 - g) * percent / 100).toString(16)).substr(1) +
                   ((0|(1<<8) + b + (256 - b) * percent / 100).toString(16)).substr(1);
            }

            /* Define board colors */
            var header =  '#' + rgbToHex(bc[0]);
            var odd = '#' + increase_brightness(rgbToHex(bc[1]), 90);
            var even = '#' + increase_brightness(rgbToHex(bc[2]), 90);

});</pre>
<p>Est-ce que la feature est utile ? Je ne sais pas, c'est un peu gadget, mais c'était marrant à faire, et c'est vrai qu'on identifie bien chaque site sur la page du coup. </p>
<p>L'idée ici est que le serveur et le client travaillent en équipe, et que grâce au navigateur on a une stack de traitement image/audio/video à portée de code. D'ailleurs on a viré le plugin flash des radios pour le remplacer par du chteumeuleu 5.</p>
<p>On peut imaginer la même chose avec tous les outils côtés en JS, ceci incluant les préprocesseurs et minifieurs JS ou CSS : pas besoin d'installer Node pour faire tourner tout ça, il suffit de déléguer le boulot à un tab du browser. Pour améliorer la stack, on pourrait par ailleurs utiliser du RPC avec WAMP et même prévenir le navigateur quand un fichier est prêt avec PUB/SUB afin qu'il le recharge. Vous avez vu comme j'arrive toujours à placer crossbar ?</p>
<p>J'ai un pote qui va venir dans quelques jours pour creuser cette idée qui permettrait d'avoir en pur Python une sorte de livereload sans extension, sans gros GUI, qui transpile tout et rafraichit tout avec un simple fichier de config. Peut être aurons nous le temps de faire un proto.</p>
<p>C'était l'inspiration du jour, passez une excellente canicule !</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/aux-couleurs-du-site/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">16645</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2015/07/LPYCHKx.jpg" length="86941" type="image/jpg" />	</item>
		<item>
		<title>La mort du tuto angular</title>
		<link>http://sametmax.com/la-mort-du-tuto-angular/</link>
		<comments>http://sametmax.com/la-mort-du-tuto-angular/#comments</comments>
		<pubDate>Sun, 14 Jun 2015 18:25:29 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Philo et culture]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[javascript]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=16389</guid>
		<description><![CDATA[<a href="http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/">J'avais demandé</a> si il y avait encore des gens intéressés par le <a href="http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-2/">tuto angularjs</a> que j'avais commencé. En effet les ressources sur Angular sont généralement de mauvaise qualité, et la réponse avait été un gros OUI.]]></description>
				<content:encoded><![CDATA[<p><a href="http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/">J&#8217;avais demandé</a> si il y avait encore des gens intéressés par le <a href="http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-2/">tuto angularjs</a> que j&#8217;avais commencé. En effet les ressources sur Angular sont généralement de mauvaise qualité, et la réponse avait été un gros OUI.</p>
<p>Je m&#8217;étais donc mis en tête de continuer. Malgré <a href="https://www.youtube.com/watch?v=KJ_xAwSeFR8">la mort annoncée du framework</a>. Malgré <a href="http://www.i-programmer.info/news/167-javascript/7932-angularjs-20-is-radically-different-.html">une V2 qui va tout casser</a>.</p>
<p>Voyez-vous, j&#8217;aime Angular. Bien que je pense que pour des grosses apps une approche comme ReactJS + BackboneJS est plus saine, pour une petit app rapide ou du prototypage c&#8217;est très productif et pratique.</p>
<p>En plus, je n&#8217;aime vraiment pas manquer à mes engagements, et en presque 3 ans de ce blog, je les ai tenu. J&#8217;ai toujours publié les articles promis. Toujours répondu aux mails. Parfois avec des mois de retard, certes, mais je n&#8217;ai signé aucun contrat moral sur les deadlines :)</p>
<p>Je vais néanmoins faire une exception ici et envoyer le tuto Angular au cimetière. Toute mes excuses à ceux qui l&#8217;attendaient.</p>
<p>Bien sûr il y a le fait que j&#8217;ai beaucoup de travail. Cependant si c&#8217;était la cause principale je n&#8217;écrirais plus ici car ça me demande des heures et des heures chaque semaine.</p>
<p>C&#8217;est surtout qu&#8217;il se trouve que j&#8217;avorte régulièrement des tentatives de retravailler dessus. C&#8217;est un signe de manque de motivation certain, et je viens d&#8217;en comprendre aujourd&#8217;hui la raison : c&#8217;est du Javascript.</p>
<p>Jusqu&#8217;ici le blog s&#8217;était autorisé régulièrement des sorties de la ligne éditoriale, mais un tel travail, un guide complet sur Angular, enterine le JS comme un sujet majeur du site.</p>
<p>Or ce n&#8217;est pas le cas.</p>
<p><a href="http://sametmax.com/un-gros-troll-de-plus-sur-javacscript/">Je n&#8217;aime pas Javascript.</a></p>
<p>Du coup non seulement me motiver à faire le dossier me demande une énorme énergie (qui pour le moment se transforme en procrastination coupable), mais en prime je me dis que c&#8217;est dépenser des ressources pour faire le taff d&#8217;une communauté qu&#8217;au final je ne supporte que par obligation professionnelle.</p>
<p>Le résultat est donc que bien que je vais continuer à parler de JS et à coder en JS (programmation Web oblige), je ne vais pas lui accorder autant de place sur S&#038;M ou dans mes heures de loisir.</p>
<p>Je remercie ceux qui prennent le temps de le faire, après tout je profite de leur travail. De mon côté, je vais me concentrer sur les domaines qui me sont plus chers, et parler d&#8217;autre chose uniquement de manière ponctuelle. L&#8217;investissement me parait plus judicieux.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/la-mort-du-tuto-angular/feed/</wfw:commentRss>
		<slash:comments>31</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">16389</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2015/06/you-trusted-me.gif" length="777074" type="image/jpg" />	</item>
		<item>
		<title>Je me te tâte à arrêter le tuto Angular</title>
		<link>http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/</link>
		<comments>http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/#comments</comments>
		<pubDate>Thu, 15 Jan 2015 04:25:58 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[angularjs]]></category>
		<category><![CDATA[guide]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[meta]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=15736</guid>
		<description><![CDATA[Malgré les <a href="https://medium.com/este-js-framework/what-i-would-recommend-instead-of-angular-js-62b057d8a9e">critiques</a>, j'aime beaucoup AngularJS. Mais à <a href="http://www.i-programmer.info/news/167-javascript/7932-angularjs-20-is-radically-different-.html">l'annonce</a> de la version 2 d'Angular complètement incompatible avec la version 1, seulement quelques années après sa sorties, des questions <a href="http://www.quirksmode.org/blog/archives/2015/01/the_problem_wit.html">se sont posées</a> sur l'avenir du framework.]]></description>
				<content:encoded><![CDATA[<p>Malgré les <a href="https://medium.com/este-js-framework/what-i-would-recommend-instead-of-angular-js-62b057d8a9e">critiques</a>, j&#8217;aime beaucoup AngularJS. Mais à <a href="http://www.i-programmer.info/news/167-javascript/7932-angularjs-20-is-radically-different-.html">l&#8217;annonce</a> de la version 2 d&#8217;Angular complètement incompatible avec la version 1, seulement quelques années après sa sortie, des questions <a href="http://www.quirksmode.org/blog/archives/2015/01/the_problem_wit.html">se sont posées</a> sur l&#8217;avenir du framework.</p>
<p>J&#8217;utilise AngularJS pour certains de mes projets, je suis payé pour former sur AngularJS et j&#8217;ai commencé à écrire <a href="http://sametmax.com/angularjs-pour-les-utilisateurs-de-jquery-partie-1/">un guide</a> sur le sujet.</p>
<p>Mais je me demande franchement si ça vaut le coup de s&#8217;investir plus.</p>
<p>Je vais continuer à l&#8217;utiliser pour mes projets actuels, tout en regardant du côté de la concurrence <a href="http://facebook.github.io/flux/">ici</a> et <a href="http://facebook.github.io/react/">là</a>.</p>
<p>Si j&#8217;écris l&#8217;article, ce n&#8217;est pas pour vous alarmer. Ni même pour vous dire &#8220;arrêtez d&#8217;utiliser Angular&#8221;. Je pense que la V1 va être maintenue par la communauté pendant des années.</p>
<p>Non, je me demande simplement si ça vaut le coup que je me casse le cul à finir le guide.</p>
<p>J&#8217;ai du travail à la pelle, le<a href="http://sametmax.com/un-gros-guide-bien-gras-sur-les-tests-unitaires-en-python-partie-1/"> guide sur les tests en Python</a>, <a href="https://github.com/sametmax/Django--an-app-at-a-time/tree/fran%C3%A7ais">Django une app à la fois</a>, 0bin à porter en Python 3&#8230;</p>
<p>Bref, est-ce que vous êtes toujours aussi intéressés par ce guide ?</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/je-me-te-tate-a-arreter-le-tuto-angular/feed/</wfw:commentRss>
		<slash:comments>37</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">15736</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2015/01/bbiydaX.gif" length="265415" type="image/jpg" />	</item>
		<item>
		<title>Qu&#8217;est-ce que les websockets et à quoi ça sert ?</title>
		<link>http://sametmax.com/quest-ce-que-les-websockets-et-a-quoi-ca-sert/</link>
		<comments>http://sametmax.com/quest-ce-que-les-websockets-et-a-quoi-ca-sert/#comments</comments>
		<pubDate>Tue, 30 Dec 2014 04:51:57 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[http]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[protocol]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[web]]></category>
		<category><![CDATA[websocket]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=15615</guid>
		<description><![CDATA[<blockquote>Le protocole WebSocket vise à développer un canal de communication full-duplex sur un socket TCP.</blockquote>

LOL. C'est clair non ?

Vous inquiétez pas, tonton Sam est là.]]></description>
				<content:encoded><![CDATA[<blockquote><p>Le protocole WebSocket vise à développer un canal de communication full-duplex sur un socket TCP.</p></blockquote>
<p>LOL. C&#8217;est clair non ?</p>
<p>Vous inquiétez pas, tonton Sam est là.</p>
<p>Le Web a évolué. On est passé de Gopher a HTTP 1 puis 1.1. Et on a eu AJAX pour rafraîchir la page sans tout recharger.</p>
<p>Et maintenant on a des apps complètes qui font des centaines de requêtes au serveur alors même que l&#8217;utilisateur ne change pas de page. D&#8217;ailleurs, je parie que plein de gens ne savent même plus ce qu&#8217;est une page&#8230;</p>
<p>Le problème c&#8217;est qu&#8217;AJAX, c&#8217;est toujours HTTP, et HTTP est sans état (stateless) : il ne garde aucune information en mémoire d&#8217;une requête à l&#8217;autre. Ça a des avantages, mais cela implique qu&#8217;à chaque requête, il faut ouvrir une connexion et la refermer. Ce qui bouffe quelques ms à chaque fois, et d&#8217;autant plus si on utilise SSL.</p>
<p>Une autre limite, c&#8217;est que le serveur ne peut pas envoyer de données au client (ici le navigateur) si le client ne fait pas une requête au préalable. Du coup, pour savoir si il y a quelque chose de nouveau, le navigateur doit régulièrement faire des requêtes au serveur ou utiliser des gros hacks comme le long polling.</p>
<p>Les websockets (c&#8217;est un abus de langage, on devrait parler du protocole Websocket) ont été créés pour répondre à ces besoins : elles permettent d&#8217;ouvrir une connexion permanente entre le navigateur et le serveur. Ainsi, chaque requête est plus rapide, et plus légère. En prime, le serveur peut envoyer des requêtes au navigateur pour le prévenir qu&#8217;il y a du nouveau.</p>
<p>Ceci permet de faire tout ce que permettait de faire AJAX mais en plus rapide, et en plus léger. Et également d&#8217;envoyer des notifications (ce contenu a changé, un message est arrivé, l&#8217;autre joueur a fait cette action&#8230;) au navigateur au moment où l&#8217;événement se produit.</p>
<p>En gros, de faire des apps Web quasi temps réel.</p>
<p>Il existe d&#8217;autre technos pour faire cela : applets Java, flash, comet, server sent events&#8230;</p>
<p>Mais aucune n&#8217;ont décollé. Websocket est donc aujourd&#8217;hui la solution de facto.</p>
<h2>Caractéristiques</h2>
<p>Le protocole Websocket utilise l&#8217;abréviation <code>ws</code> et <code>wss</code> si SSL, les URLs vers des endpoints websocket ressemblent donc à : <code>ws://domaine.tld/chemin/vers/truc/</code>.</p>
<p>Intelligemment, il utilise un handshake compatible avec celui de HTTP, permettant à un serveur de gérer les deux sur les mêmes ports. Donc on peut faire du Websocket sur le port 80 et 443. Néanmoins, certains proxy se gourent quand ils voient du websocket non chiffré et gauffrent votre connexion en la traitant comme du HTTP. Donc si vous voulez une app solide, investissez dans un certif SSL.</p>
<p>Tout ça fonctionne à partir de IE10. Notez comme IE est devenu le standard de ce qui ce fait de moins bien à tel point que je n&#8217;ai même pas besoin de vous parler des autres, vous savez que ça marche. Il existe en plus des <a href="https://github.com/gimite/web-socket-js">plugins flash</a> pour simuler des websockets sur les navigateurs anciens, c&#8217;est à dire les encore plus vieux IE.</p>
<p>Par défaut, les websockets permettent de faire de requêtes crossdomain, contrairement à AJAX. Avec les nouvelles apps qui utilisent NodeJS en local (comme <a href="http://getpopcornti.me/">popcorntime</a>) on peut imaginer une nouvelle type d&#8217;attaque : une page web qui se connecte à un serveur websocket local de votre machine. Comme les websockets sont souvent utilisées pour du RPC, il y a du potentiel.</p>
<h2>Bon, ta gueule, et montre le code</h2>

<!-- iframe plugin v.4.3 wordpress.org/plugins/iframe/ -->
<iframe width="100%" height="300" src="http://jsfiddle.net/rpecs5f1/embedded/result,js" allowfullscreen="allowfullscreen" frameborder="0" scrolling="yes" class="iframe-class"></iframe>

<p>Vous noterez que ce qui prend du temps dans l&#8217;exemple c&#8217;est la connexion, qu&#8217;on ne fait qu&#8217;une fois. Ensuite l&#8217;échange de données est super rapide.</p>
<p>Ceci est un exemple Javascript, mais un client websocket n&#8217;est pas forcément un navigateur. En fait, c&#8217;est très précisément le cas avec <a href="http://sametmax.com/presentation-de-wamp-round-2/">WAMP</a>, dont les clients peuvent être des programmes Python, Objective C, Java, C++, etc. L&#8217;avantage de WAMP, c&#8217;est qu&#8217;il automatise toute la machinerie pour découper la logique de son programme en divers fonctions et services, plutôt que d&#8217;avoir à tout faire à la main avec <code>send()</code> et <code>onmessage()</code>.</p>
<p>Dans tous les cas, il vous faudra un serveur qui supporte les Websockets pour l&#8217;utiliser. En Python, c&#8217;est Tornado ou Twisted (sur lequel est basé le serveur WAMP crossbar). En Javascript, c&#8217;est NodeJS. Quoi qu&#8217;il en soit, il vous faut un logiciel qui gère l&#8217;IO de manière <a href="http://sametmax.com/quelle-est-la-difference-entre-bloquer-et-en-cours-dexecution/">non bloquante</a>, car il y a de nombreuses connexions ouvertes en simultanées, si on veut que ça soit performant.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/quest-ce-que-les-websockets-et-a-quoi-ca-sert/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">15615</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2014/12/ybWpMif.jpg" length="81034" type="image/jpg" />	</item>
	</channel>
</rss>
