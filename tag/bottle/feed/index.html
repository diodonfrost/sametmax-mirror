<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" >

<channel>
	<title>bottle &#8211; Sam &amp; Max</title>
	<atom:link href="http://sametmax.com/tag/bottle/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Thu, 05 Sep 2019 08:22:03 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.9.7</generator>
<site xmlns="com-wordpress:feed-additions:1">32490438</site>	<item>
		<title>Code source du jeu</title>
		<link>http://sametmax.com/code-source-du-jeu/</link>
		<comments>http://sametmax.com/code-source-du-jeu/#comments</comments>
		<pubDate>Thu, 25 Jul 2013 12:09:05 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bottle]]></category>
		<category><![CDATA[meta]]></category>
		<category><![CDATA[path.py]]></category>
		<category><![CDATA[peewee]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=6788</guid>
		<description><![CDATA[En général on documente un peu le truc, on met un README, des commentaires, etc. Mais là je vais invoquer le fait que je veux vous montrer ce que ça donne un code à la vite pour justifier ma grosse flemme.  Ce code source est intéressant car il montre plusieurs choses...]]></description>
				<content:encoded><![CDATA[<p>Mraaaah vient d&#8217;avoir un compte sur le blog, et peut être aura-t-il le temps de publier les sources de ses solutions. En attendant, <a href="https://github.com/sametmax/crack_the_safe">voici le code source du jeu</a>.</p>
<p>En général on documente un peu le truc, on met un README, des commentaires, etc. Mais là je vais invoquer le fait que je veux vous montrer ce que ça donne un code à la vite pour justifier ma grosse flemme.  Ce code source est intéressant car il montre plusieurs choses :</p>
<ul>
<li>On peut coder en très peu de lignes un truc comme ça en Python. </li>
<li>Nous aussi on fait du code à l&#8217;arrache : ici un truc pondu en une après-midi, non commenté, écrit d&#8217;une traite.</li>
<li>Les <a href="http://sametmax.com/sept-petites-libs-qui-changent-la-vie-dun-dev-python/">petites libs</a> comme path.py ou bottle, ça aide bien.</li>
<li>Quand on fait les trucs trop vites, il y a des coquilles : dans notre cas on a une lib qui sert à rien, le check du mot de passe final sur la mauvaise fonction, etc. Et c&#8217;est pas scalable pour deux ronds.</li>
<li>Même quand on code mal en Python, ça reste assez lisible.</li>
<li>Python, c&#8217;est pas si lent : malgré un code d&#8217;init lourd et un serveur en pur Python (cherrypy) qui s&#8217;est pris vos essais de bourrins, ça démarre vite et ça a bien tourné.</li>
</ul>
<p>Vous trouverez dans le répertoire <em>scripts</em> les soluces des énigmes que j&#8217;ai utilisé pour vérifier que ça marchait. Vous verrez que là aussi, c&#8217;est du vite fait, avec parfois des trucs qui plantent tout simplement par fainéantise.</p>
<p>Pour démarrer le jeu : <code>python site.py</code> avec du 2.7.</p>
<hr />
<p>Mraaaah a publié <a href="http://sametmax.com/ouverture-du-coffre-la-methode-simple-bourine-mais-efficace/">ses solutions</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/code-source-du-jeu/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">6788</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2013/07/baRxsfL.jpg" length="87425" type="image/jpg" />	</item>
		<item>
		<title>Qu&#8217;est-ce que WSGI et à quoi ça sert ?</title>
		<link>http://sametmax.com/quest-ce-que-wsgi-et-a-quoi-ca-sert/</link>
		<comments>http://sametmax.com/quest-ce-que-wsgi-et-a-quoi-ca-sert/#comments</comments>
		<pubDate>Wed, 03 Jul 2013 10:36:16 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bottle]]></category>
		<category><![CDATA[cherrypy]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[nginx]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[server]]></category>
		<category><![CDATA[wsgi]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=6544</guid>
		<description><![CDATA[On va dire que je me répète, mais <a href="https://en.wikipedia.org/wiki/Wsgi">WSGI</a> est typiquement le cas d'une notion simple et super mal expliquée sur le Web.]]></description>
				<content:encoded><![CDATA[<p>On va dire que je me répète, mais <a href="https://en.wikipedia.org/wiki/Wsgi">WSGI</a> est typiquement le cas d&#8217;une notion simple et super mal expliquée sur le Web.</p>
<p>C&#8217;est terrible ça, une vrai maladie. Ça me donne envie de faire des vidéos comme le joueur du Grenier pour râler à voix haute.</p>
<p>Bref.</p>
<p>Donc WSGI a le même but que FastCGI, SCGI, or AJP : c&#8217;est une norme qui sert à définir comment un serveur Python et son application peuvent discuter. Ça été pondu pour que tous les serveurs et toutes les applications Python qui respectent la norme soient garantis de pouvoir s&#8217;interfacer.</p>
<p>Ça, c&#8217;est la définition que vous voyez partout. Super, mais concrètement ça veut dire quoi ?</p>
<h2>WSGI, c&#8217;est juste une convention de discussion</h2>
<p>Un bon dessin vaut mieux&#8230;</p>
<div id="attachment_6545" style="width: 465px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2013/07/wsgi.png" class="grouped_elements" rel="tc-fancybox-group6544"><img class=" wp-image-6545  " title="C'est compliqué de faire un schéma comme ça sérieux ? Ah ça pond une norme de 30 pages mais ça peut pas faire 3 ronds dans paint." src="http://sametmax.com/wp-content/uploads/2013/07/wsgi.png" alt="Schéma du fonctionnement de WSGI" width="455" height="644" /></a><p class="wp-caption-text">C&#39;est compliqué de faire un schéma comme ça sérieux ? Ah ça pond une norme de 30 pages mais ça peut pas faire 3 ronds dans paint.</p></div>
<p>D&#8217;un côté vous avez des serveurs comme ceux de cherrypy, de paste, de werkzeug ou comme la commande runserver de Django, ou tels que les serveurs gunicorn, Apache (avec mod_wsgi). Ces logiciels ont pour boulot d’accueillir une requête HTTP et de renvoyer la réponse. Ils ont des problématiques comme : gérer les sockets, gérer plusieurs processus en parallèle, éviter qu&#8217;un pirate se balade sur votre serveur, etc.</p>
<p>De l&#8217;autre côté vous avez votre application. 9 fois sur 10, votre site Web, donc votre code. Sa problématique c&#8217;est de recevoir une requête, la comprendre, et générer une réponse en tapant dans la base de données, et en faisant sa popotte HTML.</p>
<p>Il faut donc que votre serveur dialogue avec votre app, qu&#8217;il lui passe la requête, que votre app la gère, retourne la réponse, et file la réponse au serveur. Alors le serveur envoie la réponse au navigateur.</p>
<p>C&#8217;est la chose la plus mal expliquée : il y a deux parties à WSGI. Une pour le serveur, et une pour l&#8217;application.</p>
<p>Un serveur est dit &#8220;compatible WSGI&#8221; quand il est capable de transmettre une requête HTTP normale à votre application via le protocole WSGI, et qu&#8217;il est capable de récupérer une réponse HTTP depuis votre application via le protocole WSGI pour en faire une requête HTTP normale.</p>
<p>Une application est dite &#8220;compatible WSGI&#8221; quand elle est capable de recevoir une requête HTTP <strong>transformée en un objet Python</strong> selon la norme WSGI, et qu&#8217;elle retourne une réponse HTTP <strong>sous la forme d&#8217;un objet Python</strong> selon la norme WSGI.</p>
<h2>J&#8217;avais demandé concrètement, show me the fucking code !</h2>
<p>Côté serveur WSGI, on doit lui passer le point d&#8217;entrée de votre app.</p>
<p>Le point d&#8217;entrée est un module Python qui contient une variable nommé <code>application</code>.</p>
<p>C&#8217;est tout.</p>
<p>La variable application doit contenir votre application compatible WSGI.</p>
<p>Une application compatible WSGI a un certain nombre de méthodes pour accepter en paramètres un objet requête HTTP, et retourner un objet réponse HTTP, mais la bonne nouvelle, c&#8217;est que <strong>vous n&#8217;avez absolument pas besoin de savoir comment ça marche</strong>.</p>
<p>En effet, tous les frameworks compatibles WSGI (bottle, django, cherrypy, etc) ont une fonction qui retourne cette application toute faite.</p>
<p>Par exemple, avec bottle, mon fichier wsgi va contenir :</p>
<pre lang="python">from site import app

application = app</pre>
<p>C&#8217;est tout. <code>app</code>, le décorateur qui permet de faire <code>@app.route('/')</code> dans le code du site bottle, est déjà une application WSGI.</p>
<p>Pour Django, ça va donner un truc comme :</p>
<pre lang="python">import os
# ont dit quel est le module de settings Django
os.environ["DJANGO_SETTINGS_MODULE"] = "project.settings"

# et on fabrique l'application WSGI avec une fonction
# que Django nous donne
from django.core.wsgi import get_wsgi_application

application = get_wsgi_application()
</pre>
<p>Le simple fait qu&#8217;il y ait une variable nommée <code>application</code> fait que le serveur va se débrouiller. Tout ce qu&#8217;il y a à faire, c&#8217;est passer en paramètre ce module au serveur, et comment le faire dépend du serveur.</p>
<p>Par exemple pour gunicorn, c&#8217;est le premier paramètre de la commande qu&#8217;on utilise pour lancer le serveur :</p>
<pre lang="bash">
gunicorn nom_du_module</pre>
<p>Il faut que le module soit importable (on peut passer l&#8217;option <code>--pythonpath</code> pour s&#8217;en assurer.)</p>
<p>Pour Apache et mod_wsgi, ça se fait dans le fichier de config <em>apache.conf</em>:</p>
<pre lang="xml">WSGIScriptAlias / /chemin/version/module.wsgi</pre>
<p>Bref, faire dialoguer un serveur et une application WSGI, c&#8217;est con comme la lune :</p>
<ol>
<li>Faire un module qui contient une variable nommée <code>application</code> contenant l&#8217;app WSGI.</li>
<li>Dire au serveur où se trouve le fichier</li>
</ol>
<h2>Avantages et inconvénients de WSGI</h2>
<p>Parmi les avantages, on retrouve :</p>
<ul>
<li>Pas de parsing de la requête au niveau de l&#8217;application.</li>
<li>Entrée de toutes les apps WSGI normalisées.</li>
<li>Tous les logiciels WSGI sont compatibles entre eux.</li>
<li>Le module WSGI reste chargé en mémoire une bonne fois pour toute, pas besoin de le recréer à chaque requête.</li>
<li>WSGI se suffit à lui même pour écrire une application. Dans la théorie, on n&#8217;a même pas besoin de framework.</li>
</ul>
<p>Quant aux inconvénients :</p>
<ul>
<li>En pratique il y a très peu de code partagé entre les applications WSGI. La communication sur WSGI s&#8217;est très mal passée et cela reste quelque chose de mystérieux pour la plupart des développeurs.</li>
<li>WSGI ne gère pas les websockets, et la norme est en train d&#8217;être mise à jour pour cela. Mais cela prend du temps et les websockets sont déjà là, du coup les gens se tournent vers des solutions non WSGI (tornado, twisted, etc).</li>
<li>Certains serveurs ne gèrent pas WSGI (comme nginx ou lighttpd), du coup on ne peut pas communiquer directement entre l&#8217;app et eux. Il faut un intermédiaire. C&#8217;est pour cela qu&#8217;on voit très souvent des setups comme nginx <=> gunicorn <=> django, avec un serveur WSGI qui sert d&#8217;intermédiaire. Il y a tout de même le bénéfice de pouvoir gérer parfaitement indépendamment le processus WSGI du serveur HTTP, ce qui est très pratique pour le debug, l&#8217;administration système, le déploiement, etc.</li>
<li>WSGI, c&#8217;est du Python. Qui dit Python, dit import, qui dit import, dit PYTHON PATH. 90% des erreurs de mise en prod sont des erreurs d&#8217;import, et pour cette raison <code>sys.path</code> est presque toujours manipulé dans un fichier qui contient une application WSGI.</li>
</ul>
<h2>Pour la culture</h2>
<p>Voici à quoi ressemble un hello world en WSGI :</p>
<pre lang="python">def application(environ, start_response):
    start_response('200 OK', [('Content-Type', 'text/plain')])
    yield 'Hello World\n'</pre>
<p>Et oui, c&#8217;est très simple, et il n&#8217;y a rien à importer. La norme WSGI est une convention : il doit y avoir une variable nommée <code>application</code> (ici la variable c&#8217;est le nom de la fonction), et cette variable doit contenir une application WSGI.</p>
<p>Mais une application WSGI, c&#8217;est juste un callable (ici une fonction) qui accepte en paramètres <code>environ</code> (la requête), <code>start_response</code> (une fonction qui écrit l&#8217;en-tête de la réponse) et qui retourne un générateur de string. C&#8217;est tout.</p>
<p>Il n&#8217;y a rien de magique. C&#8217;est une simple interface sur laquelle tout le monde s&#8217;est mis d&#8217;accord.</p>
<p>Quand on fait en Django:</p>
<pre lang="python">application = get_wsgi_application()</pre>
<p>En fait Django ne fait que fabriquer une fonction comme on vient de voir, qui derrière appelle votre application Django.</p>
<p>En revanche, comme on utilise souvent Django derrière nginx, le setup ressemble très souvent à ça :</p>
<div id="attachment_6546" style="width: 465px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2013/07/wsgi_with_nginx.png" class="grouped_elements" rel="tc-fancybox-group6544"><img class="size-full wp-image-6546" title="Quand on voit &quot;socket&quot;, ça fait peur, mais c'est juste une ligne de config qui point généralement vers localhost:8000." src="http://sametmax.com/wp-content/uploads/2013/07/wsgi_with_nginx.png" alt="Schém d'utilistation de WSGI avec Nginx" width="455" height="644" /></a><p class="wp-caption-text">Quand on voit &quot;socket&quot;, ça fait peur, mais c&#39;est juste une ligne de config qui point généralement vers localhost:8000.</p></div>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/quest-ce-que-wsgi-et-a-quoi-ca-sert/feed/</wfw:commentRss>
		<slash:comments>30</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">6544</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2013/07/v2TyF.jpg" length="31544" type="image/jpg" />	</item>
		<item>
		<title>Utiliser Cherrypy (serveur web léger) avec Bottle (Framework léger)</title>
		<link>http://sametmax.com/utiliser-cherrypy-serveur-web-leger-avec-bottle-framework-leger/</link>
		<comments>http://sametmax.com/utiliser-cherrypy-serveur-web-leger-avec-bottle-framework-leger/#comments</comments>
		<pubDate>Thu, 15 Nov 2012 16:01:38 +0000</pubDate>
		<dc:creator><![CDATA[Max]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[Web]]></category>
		<category><![CDATA[bottle]]></category>
		<category><![CDATA[cherrypy]]></category>
		<category><![CDATA[light]]></category>
		<category><![CDATA[serveur]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=3081</guid>
		<description><![CDATA[Pour les sites/app qu'on developpe en une journée, Bottle et Cherrypy sont deux larons en foire qui s'accouplent parfaitement...]]></description>
				<content:encoded><![CDATA[<p>Pour les sites/app qu&#8217;on developpe en une journée, <a href="http://bottlepy.org/docs/dev/">Bottle</a> et <a href="http://www.cherrypy.org/">Cherrypy</a> sont deux larons en foire qui s&#8217;accouplent parfaitement&#8230;</p>
<p><strong>Rappel:</strong></p>
<p style="padding-left: 30px;"><strong></strong><strong>Bottle:</strong> Framework python light, allez voir <a title="Créer un site avec bottle en 5 minutes" href="http://sametmax.com/creer-un-site-avec-bottle-en-5-minutes-parceque-7-cest-impossible-voyons/">&#8220;Créer un site avec bottle en 5 minutes&#8221;</a><br />
<strong>Cherrypy:</strong> Framework python light + serveur web</p>
<p><strong><br />
Une bonne <a href="http://sametmax.com/votre-python-aime-les-pip/">Pip</a> pour commencer:</strong></p>
<pre lang="python">monsieur@fion:~# pip install cherrypy</pre>
<p><strong>Dans votre fichier start.py:</strong></p>
<pre lang="python">run(host='0.0.0.0', port=80, server='cherrypy')</pre>
<p><strong>Note:</strong> le 0.0.0.0 permet d&#8217;acceder à votre site depuis l&#8217;extérieur.</p>
<p>Pour lancer en daemon vous pouvez utiliser <a href="http://supervisord.org/">supervisord</a> <strong>ou</strong> faire un script dans le répertoire où se trouve <em>start.py</em> de votre projet et y coller:</p>
<pre lang="python">
#! /bin/sh

### Run server in daemon mode
nohup python start.py &
</pre>
<p><strong>Plusieurs serveurs web sur la même machine:</strong><br />
Si vous avez un autre serveur web qui tourne sur votre machine et qui vous empêche de lancer cherrypy sur le port 80 vous pouvez utiliser <a href="http://nginx.org/">nginx</a> en <a href="http://wiki.nginx.org/HttpProxyModule">proxy</a>. Pour ce faire modifiez le port de cherrypy dans votre fichier <em>start.py</em> (voir plus haut) et réglez-le sur 7777 par exemple avec un host 127.0.0.1.<br />
Ouvrez un fichier de conf nginx et copiez ceci:</p>
<pre lang="python">
upstream monsite_cherrypy {
    server 127.0.0.1:7777;
}

server {
        listen       80;
        server_name monsite.com www.monsite.com ;

        location /favicon.ico {
            root  /home/monsite/static/img;
        }

        location / {
            proxy_pass http://monsite_cherrypy; 
        }

}
</pre>
<p>Relancez Nginx (service nginx restart). Et votre site est en place. C&#8217;est ce qu&#8217;on utilise pour <a href="http://multiboards.net/">multiboards</a> par exemple.</p>
<p>C&#8217;est rapide et simple et ça peut tenir pas mal de visiteurs. ça évite d&#8217;installer des trucs lourds avec 3 tonnes de config.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/utiliser-cherrypy-serveur-web-leger-avec-bottle-framework-leger/feed/</wfw:commentRss>
		<slash:comments>21</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">3081</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2012/11/cherry.jpeg" length="433436" type="image/jpg" />	</item>
		<item>
		<title>Récupérer l&#8217;IP client avec Nginx en proxy sous CherryPy/Django/Bottle &#8211; proxy_set_header</title>
		<link>http://sametmax.com/recuperer-lip-client-avec-nginx-en-proxy-sous-cherrypy-proxy_set_header/</link>
		<pubDate>Thu, 06 Sep 2012 02:11:26 +0000</pubDate>
		<dc:creator><![CDATA[Max]]></dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[bottle]]></category>
		<category><![CDATA[cherrypy]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[ip]]></category>
		<category><![CDATA[nginx]]></category>
		<category><![CDATA[proxy]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=2041</guid>
		<description><![CDATA[Si vous utilisez Nginx en proxy, vous allez vous heurter à son IP lorsque votre script tentera de récupérer l'IP du client soit 127.0.0.1. Voici comment récupérer la bonne IP.]]></description>
				<content:encoded><![CDATA[<p>Si vous utilisez Nginx en proxy, vous allez vous heurter à son IP lorsque votre script tentera de récupérer l&#8217;IP du client soit 127.0.0.1.</p>
<p>En rajoutant ces quelques lignes à votre config <a href="http://wiki.nginx.org/HttpProxyModule#proxy_set_header">Nginx</a>:</p>
<pre lang="bash">location / { 
 # ici un proxy pass quelconque
 proxy_pass http://cherrypy;

 # et ici la magie opère
 proxy_set_header Host $host;
 proxy_set_header X-Real-IP $remote_addr;
 proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
}</pre>
<p><strong>Dans votre script python (ici Bottle), vous pouvez du coup la récupérer:<br />
</strong></p>
<pre lang="bash">#get user IP
user_ip = request.remote_addr</pre>
]]></content:encoded>
		<post-id xmlns="com-wordpress:feed-additions:1">2041</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2012/09/Proxy-Sheen-Cloud.jpeg" length="15043" type="image/jpg" />	</item>
		<item>
		<title>Le meilleur de l&#8217;actu IT fr, le temps d&#8217;un café: le multiboards</title>
		<link>http://sametmax.com/le-meilleur-de-lactu-it-le-temps-dun-cafe-le-multiboards/</link>
		<comments>http://sametmax.com/le-meilleur-de-lactu-it-le-temps-dun-cafe-le-multiboards/#comments</comments>
		<pubDate>Tue, 14 Aug 2012 19:49:10 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Web]]></category>
		<category><![CDATA[bottle]]></category>
		<category><![CDATA[jquery]]></category>
		<category><![CDATA[multiboards]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=1697</guid>
		<description><![CDATA[Max vous disais qu'il avait concocté un exemple de ce qu'on peut faire rapidement avec cette lib...]]></description>
				<content:encoded><![CDATA[<p>Dans son tuto sur <a href="http://sametmax.com/creer-un-site-avec-bottle-en-5-minutes-parceque-7-cest-impossible-voyons/">bottle</a>, Max vous disait qu&#8217;il avait concocté un exemple de ce qu&#8217;on peut faire rapidement avec cette lib.</p>
<p>Ainsi est né <a href="http://multiboards.net/">multiboards.net</a>.</p>
<p>C&#8217;est très simple: il déteste les flux RSS, et veut juste rapidement avoir toutes les infos intéressantes sur l&#8217;actu informatique en buvant son kawa le matin, sans se fouler.</p>
<p>Le multiboards répond simplissimement à ce besoin en offrant sur une page qui s&#8217;auto refresh :</p>
<ul>
<li>les actus des meilleurs blogs (sélectionnés par le dictateur Max) IT;</li>
<li>les actus des meilleurs sites généralistes IT;</li>
<li>les offres d&#8217;emplois IT en France, principalement Python;</li>
<li>des actus plus générales de Google news;</li>
<li>tout ça enrobé de conneries pour le lulz venant de imgur, bashfr et vdm;</li>
<li>et une radio intégrée dans le menu en haut qui vous diffuse de la zik si vous êtes d&#8217;humeur à cliquer dessus.</li>
</ul>
<div id="attachment_1698" style="width: 472px" class="wp-caption aligncenter"><a href="http://sametmax.com/wp-content/uploads/2012/08/Multiboards-les-infos-fraîches-de-vos-sites-préférés-2012-08-14-15-54-00.png" class="grouped_elements" rel="tc-fancybox-group1697"><img class=" wp-image-1698  " title="Des articles, des news, de bêtises, en un coup d'oeil" src="http://sametmax.com/wp-content/uploads/2012/08/Multiboards-les-infos-fraîches-de-vos-sites-préférés-2012-08-14-15-54-00.png" alt="Capture d'écran du multiboards" width="462" height="241" /></a><p class="wp-caption-text">Des articles, des news, de bêtises, en un coup d&#39;oeil</p></div>
<p>C&#8217;est du bottle, donc du Python, et massivement du jQuery, avec un petit peut de Redis mais alors vraiment pour la couleur. Car en fait, quasiment tout se passe côté client et ne tape quasiment pas notre serveur. Très KISS.</p>
<p>Il n&#8217;y aura pas de version qu&#8217;on peut customiser par user, qui demande une registration ou quoique ce soit. Le multiboard, c&#8217;est ça, et juste ça.</p>
<p>Maintenant chers amis, il va falloir tous spammer de commentaires ce post pour motiver l&#8217;auteur afin qu&#8217;il mette le code source sous licence libre. Parceque c&#8217;est une feignasse, le Max, je vous le rappelle, et que ça voudrait dire qu&#8217;il devrait écrire une doc et nettoyer le <code>random.randint()</code> qu&#8217;il a mis pour le compteur de visiteurs.</p>
<p><strong>Ah oui, on a rajouté le lien dans le menu.</strong></p>
<p>&nbsp;</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/le-meilleur-de-lactu-it-le-temps-dun-cafe-le-multiboards/feed/</wfw:commentRss>
		<slash:comments>25</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">1697</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2012/08/coffee2.png" length="85865" type="image/jpg" />	</item>
		<item>
		<title>Créer un site avec bottle en 5 minutes (parceque 7 c&#8217;est impossible voyons !)</title>
		<link>http://sametmax.com/creer-un-site-avec-bottle-en-5-minutes-parceque-7-cest-impossible-voyons/</link>
		<comments>http://sametmax.com/creer-un-site-avec-bottle-en-5-minutes-parceque-7-cest-impossible-voyons/#comments</comments>
		<pubDate>Mon, 13 Aug 2012 03:55:28 +0000</pubDate>
		<dc:creator><![CDATA[Max]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bottle]]></category>
		<category><![CDATA[bottlepy]]></category>
		<category><![CDATA[framework]]></category>
		<category><![CDATA[micro-framework]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=1660</guid>
		<description><![CDATA[On a tous plein d'idées, et souvent des idées de petits sites qu'on aimerait réaliser dans la nuit, sans se faire chier, et si possible que quand on revient dans 3 mois on sache s'y retrouver. Bottle est là pour vous, vos prières ont été exhaussées, Amen...]]></description>
				<content:encoded><![CDATA[<p>Aller bande de feignasses c&#8217;est Lundi on oublie la murge du week-end et on se secoue les neuronnes !</p>
<p><a href="http://bottlepy.org/">Bottle</a> est un micro-framework python sur lequel Sam m&#8217;a obligé de bosser après Django, (il me force à évoluer c&#8217;est une horreur). Je dois dire que je le regrette pas car c&#8217;est diablement efficace, mignon et tout et tout.</p>
<p>En début de semaine je me suis dit qu&#8217;il fallait que j&#8217;en parle, je vais donc vous montrer comment on peut développer un &#8220;site&#8221; simple en 5 minutes structuré et sans se prendre le choux. Sam viendra compléter mes oublis.</p>
<p>Je ne vais pas aborder la base de données mais il y a plein de <a href="http://bottlepy.org/docs/dev/plugins/index.html">plugins bottle ici</a> dont un ORM pour sqlite qu&#8217;on détaillera dans un article le jour où on s&#8217;en servira ;)</p>
<p>Avant de commencer: Pourquoi je l&#8217;aime ?</p>
<ul>
<li>Simple à comprendre</li>
<li>bien structuré (des vues des templates, un routing clair)</li>
<li>gestion des urls fastoches</li>
<li>un petit serveur web intégré, on démarre son site en 10 secondes et on debug avec <a href="http://sametmax.com/debugger-en-python-les-bases-de-pdb/" >ipdb</a></li>
<li>une <a href="http://bottlepy.org/docs/dev/tutorial.html#quickstart-hello-world">doc</a> formidabuleuse avec des exemples concrets</li>
<li>il cracke les watts</li>
</ul>
<p><b>En route simone !</b></p>
<p>On prend la bite rude de créer un environnement virtuel et on fait un <code><a href="http://sametmax.com/votre-python-aime-les-pip/">pip</a> install bottl</code>e. Pour ceux qui veulent tout saloper faites juste un <code>pip install bottle,</code> pour ceux qui savent pas ce qu&#8217;est &#8220;pip&#8221; faites un &#8220;wget http://bottlepy.org/bottle.py&#8221; dans le dossier de votre projet.</p>
<p><b>je veux que ça marche tout de suite !</b></p>
<p>Editez un fichier python start.py à la racine de votre projet et collez ça dedans:</p>
<pre lang="python">
from bottle import Bottle, run

app = Bottle()

@app.route('/')
def hello():
    return "Max est le plus beau!"

run(app, host='localhost', port=8080)
</pre>
<p>maintenant dans le shell tapez dans le dossier de votre projet où se trouve start.py:</p>
<pre lang="bash">
python start.py 
Bottle server starting up (using WSGIRefServer())...
Listening on http://localhost:8080/
Hit Ctrl-C to quit.

localhost - - [12/Aug/2012 23:12:15] "GET / HTTP/1.1" 200 21
localhost - - [12/Aug/2012 23:12:16] "GET /favicon.ico HTTP/1.1" 404 742
</pre>
<p>Ouvrez le navigateur Internet explorer bourré de toolbars à l&#8217;adresse <a href="http://127.0.0.1:8080">127.0.0.1:8080</a></p>
<p>C&#8217;est bon ça marche, c&#8217;est fini, vous êtes un pro du pot. Quand on voit ça on se dit que franchement ça sert à rien de se faire chier plus que ça&#8230; :)</p>
<p>Moi quand je vois ça ça me fait chialer à chaque fois tellement c&#8217;est simple, je me dis que je vais révolutionner le monde, conquérir la planète, me taper les plus belles meufs&#8230;</p>
<p>Avant d&#8217;aller plus loin je reprends le code et je note ce qu&#8217;il faut retenir</p>
<p><b>1. le routing</b></p>
<pre lang="python">
@app.route('/')
</pre>
<p>@app.route(&#8216;/&#8217;) prend tout ce qui arrive à la racine de l&#8217;url et le traite dans la vue hello qui est une fonction de base toute simple. si j&#8217;avais voulu faire une url du genre 127.0.0.1:8080/samapoil j&#8217;aurais mis @app.route(&#8216;/samapoil&#8217;)</p>
<p><b>2. les vues</b></p>
<pre lang="python">
def hello():
    return "Max est le plus beau!"
</pre>
<p>la vue est une fonction que l&#8217;ont défini et qui peut prendre n&#8217;importe quel nom, dedans on traite l&#8217;information qui arrivera de l&#8217;url routée par le <a href="http://sametmax.com/comprendre-les-decorateurs-python-pas-a-pas-partie-1/">décorateur</a> &#8220;@app.route(&#8216;/&#8217;)&#8221;. Cette vue peut recevoir des infos d&#8217;un formulaire ou des variables passées dans l&#8217;url (qu&#8217;on va voir plus bas)</p>
<p>Voilà votre premier site bottle marche, c&#8217;est rigolo. Maintenant on va aller un peu plus loin et utiliser les templates.</p>
<p><b>Les templates c&#8217;est quoi ?</b><br />
Les templates c&#8217;est juste du code HTML avec dedans des &#8220;variables&#8221; que l&#8217;on va peupler dans notre vue. ça sert à ne pas trop mélanger code python et html et c&#8217;est plutôt une bonne idée.</p>
<p><b>Création d&#8217;un template:</b><br />
éditez un fichier template.tpl et mettez dedans</p>
<pre lang="bash">
<div align="center">{{ title }}</div>
</pre>
<p><b>Maintenant on va assembler le template et la vue comme un légo:</b><br />
Ouvrez le fichier start.py et collez</p>
<pre lang="python">
from bottle import Bottle, run, view

app = Bottle()

@app.route('/')
@view('template.tpl')
def hello():
    context = {'title': "Max est le plus beau"}
    return (context)

run(app, host='localhost', port=8080)
</pre>
<p>Relancez le serveur (python start.py) et allez sur à l&#8217;adresse <a href="http://127.0.0.1:8080/127.0.0.1:8080">127.0.0.1:8080</a></p>
<p>Et voilà notre template utilisé par notre vue auquel on a passé un title. Ceci ce fait grace au décorateur &#8220;@view&#8221; auquel on donne le chemin du template. Les templates offrent pas mal de <a href="http://bottlepy.org/docs/dev/tutorial.html#templates">possibilitées</a></p>
<p>Les bases sont posées ce n&#8217;est vraiment pas sorcier, je rajoute quelques exemples pratiques mais tout ceci figure dans la <a href="http://bottlepy.org/docs/dev/tutorial.html#quickstart-hello-world">doc</a></p>
<p><b>Mettre un id dans l&#8217;url:</b></p>
<pre lang="python">
#!/usr/bin/env python
# -*- coding: utf-8 -*-
from bottle import Bottle, run, view
app = Bottle()

@app.route('/:mon_id')
@view('template.tpl')
def hello(mon_id):
    """
        Récupre la variable mon_id passée dans l'url sous la forme 127.0.0.1:8080/1 et la transmet au template via le context
    """
    context = {'title': "Max est le plus beau %s" % mon_id}
    return (context)

run(app, host='localhost', port=8080)
</pre>
<p><b>Récupérer une variable dans l&#8217;url:</b></p>
<pre lang="python">
#!/usr/bin/env python
# -*- coding: utf-8 -*-

from bottle import Bottle, run, view, request

app = Bottle()

@app.route('/jemesure')
@view('template.tpl')
def hello():
    """
        Récupère la variable taille à l'aide de l'objet request pour l'url 
        http://127.0.0.1:8080/jemesure?taille=133
    """
    context = {'title': "Je mesure %s cm" % request.params.taille}
    return (context)

run(app, host='localhost', port=8080, reloader=True)
</pre>
<p>Notez le &#8220;reloader=True&#8221; qui permet au serveur de redémarrer à chaque modif du code, hyper pratique.</p>
<p><b>Edit:</b></p>
<p><b>Servir les images, js, css (appelé contenu statique):</b></p>
<pre lang="python">
#!/usr/bin/env python
# -*- coding: utf-8 -*-

from bottle import Bottle, run, static_file
app = Bottle()

@app.route('/static/<filename:path>')
def server_static(filename):
    """
        Sert les fichiers statiques tel que .js, .css, .jpeg, etc...
    """
    return static_file(filename, root='.')

run(app, host='localhost', port=8080, reloader=True)
</pre>
<p>Grace à static_file vous pourrez servir vos images, faire télécharger des fichiers, etc, simplement. Dans l&#8217;exemple ci-dessus si vous allez sur l&#8217;url <a href="http://127.0.0.1:8080/static/template.tpl">http://127.0.0.1:8080/static/template.tpl</a> vous allez télécharger le template template.tpl, si c&#8217;est une image, votre navigateur affichera une image, etc&#8230;</p>
<p>Je vous conseille d&#8217;aller voir la doc histoire de vous mettre l&#8217;eau à la bouche. JE déteste les docs en général mais là je la trouve presque parfaite.</p>
<p>Sam vous fera un article bientôt sur comment mettre tout ça en prod car le petit serveur web compris dans bottle ne peut bien sur pas assurer une charge en prod.<br />
Mais comme dit ma grand-mère ça se goupille comme un doigt au cul.</p>
<p>Bottle est vraiment pour moi l&#8217;outil parfait pour concrétiser rapidement une idée, un site qui ne demande pas une grosse structure, bref un projet qui doit se torcher rapidement ;)</p>
<p>Et pour illustrer ce que j&#8217;ai pu faire en quelques jours de taf avec bottle et un peu de Jquery je vous mettrai en ligne dans la semaine un petit site fort symphatique je pense&#8230;</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/creer-un-site-avec-bottle-en-5-minutes-parceque-7-cest-impossible-voyons/feed/</wfw:commentRss>
		<slash:comments>20</slash:comments>
	<post-id xmlns="com-wordpress:feed-additions:1">1660</post-id><enclosure url="http://sametmax.com/wp-content/uploads/2012/08/sancerre-comte-lafond-grande.jpeg" length="8312" type="image/jpg" />	</item>
	</channel>
</rss>
